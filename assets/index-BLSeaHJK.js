(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function a(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(s){if(s.ep)return;s.ep=!0;const n=a(s);fetch(s.href,n)}})();const oe="input-ui/5.5.1-stable-hotfix",ne="https://your-make-webhook-url.com/your-unique-path",U="marnthara.input.v4",ae=500,C={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"https://i.imgur.com/l7y85nI.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},se=1.19599,Y={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},c={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",setCount:"#setCount",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",set:"[data-set]",setsContainer:"[data-sets]",decorationsContainer:"[data-decorations]",decoItem:"[data-deco-item]",wallpapersContainer:"[data-wallpapers]",wallpaperItem:"[data-wallpaper-item]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",sheerCodeWrap:"[data-sheer-code-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn",allDetailsCards:'.card[id="customerDetailsCard"], .room-card'},_=e=>{typeof e=="string"&&(e=e.replace(/,/g,""));const r=parseFloat(e);return Number.isFinite(r)?r:0},P=(e,r=2,a=!1)=>Number.isFinite(e)?e.toLocaleString("en-US",{minimumFractionDigits:a?2:r,maximumFractionDigits:a?2:r}):"0",T=(e,r=0)=>Number.isFinite(e)?e.toLocaleString("th-TH",{minimumFractionDigits:r,maximumFractionDigits:r}):"0",le=(e,r=150)=>{let a;return(...t)=>{clearTimeout(a),a=setTimeout(()=>e(...t),r)}},ce=(e,r=700)=>{let a=!1;return(...t)=>{if(!a){a=!0;try{return e(...t)}finally{setTimeout(()=>{a=!1},r)}}}};function ie(e){if(e=Number(e),isNaN(e))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";const r=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤","‡∏™‡∏¥‡∏ö"],a=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];if(e===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const[t,s]=e.toFixed(2).split("."),n=parseInt(s,10);function o(i){if(i==null)return"";let u="";const d=String(i);for(let m=0;m<d.length;m++){const f=parseInt(d[m],10);if(f!==0){if((d.length-m-1)%6===0&&m!==d.length-1)return o(d.substring(0,m+1))+"‡∏•‡πâ‡∏≤‡∏ô"+o(d.substring(m+1));u+=r[f]+a[d.length-m-1]}}return u}let l=o(t).replace(/‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏™‡∏¥‡∏ö$/,"‡∏™‡∏¥‡∏ö").replace(/‡∏™‡∏≠‡∏á‡∏™‡∏¥‡∏ö/g,"‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö").replace(/‡∏™‡∏¥‡∏ö‡∏´‡∏ô‡∏∂‡πà‡∏á$/,"‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î")+"‡∏ö‡∏≤‡∏ó";return n>0?l+=o(n).replace(/‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏™‡∏¥‡∏ö$/,"‡∏™‡∏¥‡∏ö").replace(/‡∏™‡∏≠‡∏á‡∏™‡∏¥‡∏ö/g,"‡∏¢‡∏µ‡πà‡∏™‡∏¥‡∏ö").replace(/‡∏™‡∏¥‡∏ö‡∏´‡∏ô‡∏∂‡πà‡∏á$/,"‡∏™‡∏¥‡∏ö‡πÄ‡∏≠‡πá‡∏î")+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":l+="‡∏ñ‡πâ‡∏ß‡∏ô",l}function R(){var r,a,t;const e={app_version:oe,customer_name:((r=document.querySelector('[name="customer_name"]'))==null?void 0:r.value)||"",customer_phone:((a=document.querySelector('[name="customer_phone"]'))==null?void 0:a.value)||"",customer_address:((t=document.querySelector('[name="customer_address"]'))==null?void 0:t.value)||"",rooms:[]};return document.querySelectorAll(c.room).forEach(s=>{var o;const n={id:s.id,room_name:((o=s.querySelector(c.roomNameInput))==null?void 0:o.value)||"",is_suspended:s.classList.contains("is-suspended"),sets:[],decorations:[],wallpapers:[]};s.querySelectorAll(c.set).forEach(l=>{var i,u,d,m,f,y,g,x,w,p,v;n.sets.push({width_m:_((i=l.querySelector('input[name="width_m"]'))==null?void 0:i.value),height_m:_((u=l.querySelector('input[name="height_m"]'))==null?void 0:u.value),style:((d=l.querySelector('select[name="set_style"]'))==null?void 0:d.value)||"",fabric_variant:((m=l.querySelector('select[name="fabric_variant"]'))==null?void 0:m.value)||"",price_per_m_raw:_((f=l.querySelector('select[name="set_price_per_m"]'))==null?void 0:f.value),sheer_price_per_m:_((y=l.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:y.value),fabric_code:((g=l.querySelector('input[name="fabric_code"]'))==null?void 0:g.value)||"",sheer_fabric_code:((x=l.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:x.value)||"",opening_style:((w=l.querySelector('select[name="opening_style"]'))==null?void 0:w.value)||"",track_color:((p=l.querySelector('select[name="track_color"]'))==null?void 0:p.value)||"",notes:((v=l.querySelector('input[name="notes"]'))==null?void 0:v.value)||"",is_suspended:l.classList.contains("is-suspended")})}),s.querySelectorAll(c.decoItem).forEach(l=>{var i,u,d,m,f,y;n.decorations.push({type:((i=l.querySelector('[name="deco_type"]'))==null?void 0:i.value)||"",width_m:_((u=l.querySelector('[name="deco_width_m"]'))==null?void 0:u.value),height_m:_((d=l.querySelector('[name="deco_height_m"]'))==null?void 0:d.value),price_sqyd:_((m=l.querySelector('[name="deco_price_sqyd"]'))==null?void 0:m.value),deco_code:((f=l.querySelector('[name="deco_code"]'))==null?void 0:f.value)||"",notes:((y=l.querySelector('[name="deco_notes"]'))==null?void 0:y.value)||"",is_suspended:l.classList.contains("is-suspended")})}),s.querySelectorAll(c.wallpaperItem).forEach(l=>{var i,u,d,m,f;n.wallpapers.push({height_m:_((i=l.querySelector('[name="wallpaper_height_m"]'))==null?void 0:i.value),wallpaper_code:((u=l.querySelector('[name="wallpaper_code"]'))==null?void 0:u.value)||"",price_per_roll:_((d=l.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:d.value),install_cost_per_roll:_((m=l.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:m.value),notes:((f=l.querySelector('[name="wallpaper_notes"]'))==null?void 0:f.value)||"",widths:Array.from(l.querySelectorAll('[name="wall_width_m"]')).map(y=>_(y.value)),is_suspended:l.classList.contains("is-suspended")})}),e.rooms.push(n)}),e}function B(){localStorage.setItem(U,JSON.stringify(R()))}const b={stylePlus:e=>Y.style_surcharge[e]??0,heightPlus:e=>{const r=[...Y.height].sort((a,t)=>t.threshold-a.threshold);for(const a of r)if(e>a.threshold)return a.add_per_m;return 0},fabricYardage:(e,r)=>{const a=_(r);return a<=0||!e?0:e==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||e==="‡∏à‡∏µ‡∏ö"?(a*2+.6)/.9:e==="‡∏•‡∏≠‡∏ô"?(a*2.6+.6)/.9:0},wallpaperRolls:(e,r)=>{const a=_(e),t=_(r);if(a<=0||t<=0)return 0;const s=t>2.5?Math.floor(10/t):3;if(s<=0)return 0;const n=Math.ceil(a/.53);return Math.ceil(n/s)},calculateSetPrice:function(e){var o,l;if(!e||e.is_suspended||_(e.width_m)<=0)return{total:0,opaque:0,sheer:0};const r=this.stylePlus(e.style),a=this.heightPlus(_(e.height_m)),t=_(e.width_m),s=(o=e.fabric_variant)!=null&&o.includes("‡∏ó‡∏∂‡∏ö")&&_(e.price_per_m_raw)>0?(_(e.price_per_m_raw)+r+a)*t:0,n=(l=e.fabric_variant)!=null&&l.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&_(e.sheer_price_per_m)>0?(_(e.sheer_price_per_m)+r+a)*t:0;return{total:Math.round(s+n),opaque:Math.round(s),sheer:Math.round(n)}},calculateDecoPrice:function(e){if(!e||e.is_suspended||_(e.width_m)<=0)return{total:0,sqm:0,sqyd:0};const r=_(e.width_m)*_(e.height_m),a=r*se,t=a*_(e.price_sqyd);return{total:Math.round(t),sqm:r,sqyd:a}},calculateWallpaperPrice:function(e){var o;if(!e||e.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const r=((o=e.widths)==null?void 0:o.reduce((l,i)=>l+_(i),0))||0;if(r<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const a=_(e.height_m),t=this.wallpaperRolls(r,a),s=t*_(e.price_per_roll),n=t*(_(e.install_cost_per_roll)||0);return{total:Math.round(s+n),material:Math.round(s),install:Math.round(n),rolls:t,sqm:r*a}}};function ue(e){return e.rooms.reduce((r,a)=>{if(a.is_suspended)return r;const t=a.sets.reduce((o,l)=>o+b.calculateSetPrice(l).total,0),s=a.decorations.reduce((o,l)=>o+b.calculateDecoPrice(l).total,0),n=a.wallpapers.reduce((o,l)=>o+b.calculateWallpaperPrice(l).total,0);return r+t+s+n},0)}function de(e,r){const a=ue(e);let t=`‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"numeric",year:"numeric"})})
`;if(t+=`‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${e.customer_name||"-"}
`,(r==="customer"||r==="owner")&&(t+=`‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${e.customer_phone||"-"}
`,t+=`‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${e.customer_address||"-"}
`),t+=`------------------------------
`,r==="customer")return t+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
`,e.rooms.forEach(s=>{if(s.is_suspended||[...s.sets,...s.decorations,...s.wallpapers].filter(l=>l.is_suspended?!1:l.widths?l.widths.reduce((i,u)=>i+u,0)>0:l.width_m>0).length===0)return;t+=`
*‡∏´‡πâ‡∏≠‡∏á: ${s.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let o=0;s.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(o++,t+=` ${o}) ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} (${l.fabric_variant})
`)}),s.decorations.forEach(l=>{l.is_suspended||l.width_m<=0||(o++,t+=` ${o}) ${l.type||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}
`)}),s.wallpapers.forEach(l=>{l.is_suspended||l.widths.reduce((i,u)=>i+u,0)<=0||(o++,t+=` ${o}) ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå
`)})}),t+=`------------------------------
`,t+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(a)} ‡∏ö‡∏≤‡∏ó
`,t+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
${C.name}
‡πÇ‡∏ó‡∏£: ${C.phone}`,t;if(r==="purchase_order"||r==="owner"){const s={opaqueFabrics:[],sheerFabrics:[],decorations:[],wallpapers:[],allSets:[]};if(e.rooms.forEach(n=>{n.is_suspended||(n.sets.forEach(o=>{o.is_suspended||o.width_m<=0||(s.allSets.push(o),o.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&s.opaqueFabrics.push({code:o.fabric_code||"??",yards:b.fabricYardage(o.style,o.width_m)}),o.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&s.sheerFabrics.push({code:o.sheer_fabric_code||"??",yards:b.fabricYardage(o.style,o.width_m)}))}),n.decorations.forEach(o=>{o.is_suspended||!o.type||o.width_m<=0||s.decorations.push({type:o.type,code:o.deco_code||"xxx",width:o.width_m,height:o.height_m})}),n.wallpapers.forEach(o=>{if(o.is_suspended)return;const l=o.widths.reduce((i,u)=>i+u,0);if(l>0){const i=b.wallpaperRolls(l,o.height_m);i>0&&s.wallpapers.push({code:o.wallpaper_code||"xxx",rolls:i})}}))}),t+=`üìã *‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤*
`,t+=`------------------------------
`,s.opaqueFabrics.length>0&&s.opaqueFabrics.forEach(n=>{t+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain Fabric)
`,t+=`‡∏£‡∏´‡∏±‡∏™: #${n.code||"??"}
`,t+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${n.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),s.sheerFabrics.length>0&&s.sheerFabrics.forEach(n=>{t+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer Fabric)
`,t+=`‡∏£‡∏´‡∏±‡∏™: #${n.code||"??"}
`,t+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${n.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),t+=`------------------------------
`,t+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á*
`,t+=`------------------------------

`,s.allSets.length>0){let n=1;s.allSets.forEach(o=>{t+=`(${n++}) ‡∏£‡∏≤‡∏á‡∏°‡πà‡∏≤‡∏ô: ${o.style}, ‡∏™‡∏µ: ${o.track_color}
`,o.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(t+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${o.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),o.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(t+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${o.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),o.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"&&(t+=`  (‚ùóÔ∏è‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô)
`),t+=`
`})}if(t+=`------------------------------
`,t+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Blind*
`,t+=`------------------------------

`,s.decorations.length>0){const n={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"Wooden Blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"Roller Blind",‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"Vertical Blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"Partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"Pleated Insect Screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"Aluminium Blind"};s.decorations.forEach(o=>{const l=n[o.type]?` (${n[o.type]})`:"";t+=`- ${o.type}${l}
`,t+=`‡∏£‡∏´‡∏±‡∏™: #${o.code||"xxx"}
`,t+=`‡∏Ç‡∏ô‡∏≤‡∏î: ${o.width.toFixed(2)} x ${o.height.toFixed(2)} m.
`,t+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: 1 ‡∏ä‡∏∏‡∏î

`})}if(t+=`------------------------------
`,t+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Wallpaper*
`,t+=`------------------------------

`,s.wallpapers.length>0&&s.wallpapers.forEach(n=>{t+=`- ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå -
`,t+=`‡∏£‡∏´‡∏±‡∏™: #${n.code||"xxx"}
`,t+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${n.rolls} ‡∏°‡πâ‡∏ß‡∏ô

`}),t+=`------------------------------
`,r==="purchase_order")return t}return(r==="seamstress"||r==="owner")&&(t+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á*
`,e.rooms.forEach(s=>{if(s.is_suspended||s.sets.filter(l=>!l.is_suspended&&l.width_m>0).length===0)return;t+=`
*‡∏´‡πâ‡∏≠‡∏á: ${s.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let o=1;s.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(t+=`${o++}) *‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} ${l.fabric_variant}*
`,t+=`  ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${l.width_m} x ‡∏™‡∏π‡∏á ${l.height_m} ‡∏°.
`,t+=`  ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${l.opening_style}
`,l.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(t+=`  ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: ‡∏£‡∏´‡∏±‡∏™ ${l.fabric_code||"-"}
`),l.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(t+=`  ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: ‡∏£‡∏´‡∏±‡∏™ ${l.sheer_fabric_code||"-"}
`))})}),t+=`------------------------------
`,r==="seamstress")||r==="owner"&&(t+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(a)} ‡∏ö‡∏≤‡∏ó*
`),t}function me(e){if(!e.rooms||e.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';const r={};let a=0,t="";if(e.rooms.forEach(o=>{if(o.is_suspended)return;const l={};o.sets.forEach(u=>{if(b.calculateSetPrice(u).total>0){const d="‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô";l[d]=(l[d]||0)+1,r[d]=(r[d]||0)+1}}),o.decorations.forEach(u=>{if(u.type&&b.calculateDecoPrice(u).total>0){const d=u.type;l[d]=(l[d]||0)+1,r[d]=(r[d]||0)+1}}),o.wallpapers.forEach(u=>{if(b.calculateWallpaperPrice(u).total>0){const d="‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå";l[d]=(l[d]||0)+1,r[d]=(r[d]||0)+1}});const i=Object.entries(l);i.length>0&&(t+=`<tr class="room-header-row"><td colspan="3">${o.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</td></tr>`,i.forEach(([u,d])=>{t+=`<tr><td></td><td class="item-type-cell">${u}</td><td class="pdf-text-center">${d}</td></tr>`,a+=d}))}),a===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let n=`<div id="detailed-material-summary">
        <h4><i class="ph ph-stack"></i> ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
        <ul><li class="summary-note">${Object.entries(r).map(([o,l])=>`${o}: ${l}`).join(" , ")}</li></ul>
    </div>`;return n+=`<table>
        <thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th class="pdf-text-center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th></tr></thead>
        <tbody>${t}</tbody>
    </table>`,n}function pe(e,r){const{vatRate:a}=r,t=[];e.rooms.forEach(q=>{if(q.is_suspended)return;const L=[];q.sets.forEach(S=>{const k=b.calculateSetPrice(S).total;if(k>0){let N=`‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${S.style} (${S.fabric_variant}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${S.width_m.toFixed(2)} x ${S.height_m.toFixed(2)} ‡∏°.${S.notes?` - ${S.notes}`:""}</small>`;L.push({description:N,total:k,units:N.includes("<br>")?1.5:1})}}),q.decorations.forEach(S=>{const k=b.calculateDecoPrice(S).total;if(k>0){let N=`${S.type||"‡∏á‡∏≤‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"} <br><small>‡∏£‡∏´‡∏±‡∏™: ${S.deco_code||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${S.width_m.toFixed(2)} x ${S.height_m.toFixed(2)} ‡∏°.</small>`;L.push({description:N,total:k,units:N.includes("<br>")?1.5:1})}}),q.wallpapers.forEach(S=>{const k=b.calculateWallpaperPrice(S).total;if(k>0){const N=S.widths.reduce((j,z)=>j+z,0),X=b.wallpaperRolls(N,S.height_m);let F=`‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå <br><small>‡∏£‡∏´‡∏±‡∏™: ${S.wallpaper_code||"-"}, ‡∏™‡∏π‡∏á ${S.height_m.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${X} ‡∏°‡πâ‡∏ß‡∏ô)</small>`;L.push({description:F,total:k,units:F.includes("<br>")?1.5:1})}}),L.length>0&&(t.push({isRoomHeader:!0,roomName:q.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),t.push(...L))});const s=t.reduce((q,L)=>q+(L.total||0),0);if(s===0)return null;const n=s*a,o=s+n,l=17,i=23,u=[];let d=[],m=0;t.forEach(q=>{const L=u.length===0?l:i;m+q.units>L&&d.length>0&&(u.push(d),d=[],m=0),d.push(q),m+=q.units}),d.length>0&&u.push(d);const f=new Date,y=f.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),g=`QT-${f.getFullYear()}${(f.getMonth()+1).toString().padStart(2,"0")}${f.getDate().toString().padStart(2,"0")}`;let x="",w=0,p=1;u.forEach((q,L)=>{const S=L===0,k=L===u.length-1,N=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${C.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong>${C.name}</strong><br>
                            ${C.address.replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${C.phone} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${C.taxId}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${u.length>1?S?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${g}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${y}</td></tr>
                        </table>
                    </div>
                </div>
                ${S?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${e.customer_name||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${e.customer_address.replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${e.customer_phone||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${C.pdf.paymentTerms}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${C.pdf.priceValidity}
                    </div>
                </section>`:""}
            </div>`,X=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span>${C.name} | ‡πÇ‡∏ó‡∏£: ${C.phone}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${L+1} / ${u.length}</span>
                </div>
            </div>`;let F="";S||(F+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${P(w,2,!0)}</td></tr>`),q.forEach(I=>{I.isRoomHeader?F+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${I.roomName}</td></tr>`:(F+=`<tr><td class="pdf-text-center">${p++}</td><td>${I.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${P(I.total,2,!0)}</td><td class="pdf-text-right">${P(I.total,2,!0)}</td></tr>`,w+=I.total)});let j="";k||(j=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${P(w,2,!0)}</td></tr></tfoot>`);const z=k?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                        <ul>${C.pdf.notes.map(I=>`<li>${I}</li>`).join("")}</ul>
                        <div class="pdf-amount-text">( ${ie(o)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td colspan="2" class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${P(s,2,!0)}</td></tr>
                            ${a>0?`<tr><td colspan="2" class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(a*100).toFixed(0)}%</td><td class="pdf-amount">${P(n,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td colspan="2" class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${P(o,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(${C.name})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${y}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";x+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${N}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${F}</tbody>
                            ${j}
                        </table>
                        ${z}
                    </div>
                    ${X}
                </div>
            </div>`});const h=(e.customer_name||"quote").trim().replace(/\s+/g,"-");return{html:`<div id="quotation-template">${x}</div>`,fileName:`${g}_${h}`}}let H=0,E=!1;function $(e,r="default"){const a=document.querySelector(c.toastContainer);if(!a)return;const t={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},s=document.createElement("div");s.className=`toast toast-${r}`,s.innerHTML=`<i class="${t[r]||t.default}"></i> ${e}`,a.appendChild(s),setTimeout(()=>s.classList.add("show"),10),setTimeout(()=>{s.classList.remove("show"),s.addEventListener("transitionend",()=>s.remove())},3e3)}function G(e,r){return new Promise(a=>{const t=document.querySelector(e);if(!t){a(null);return}t.classList.add("visible");const s=t.querySelector('[id$="Confirm"]'),n=t.querySelector('[id$="Cancel"]'),o=i=>{t.classList.remove("visible"),s&&(s.onclick=null),n&&(n.onclick=null),document.removeEventListener("keydown",l),!i&&r&&r(),a(i)},l=i=>{i.key==="Escape"&&o(!1)};s&&(s.onclick=()=>o(!0)),n&&(n.onclick=()=>o(!1)),document.addEventListener("keydown",l)})}async function V(e,r){const a=document.querySelector(c.modal);if(!a)return!0;const t=a.querySelector(c.modalTitle),s=a.querySelector(c.modalBody);return t&&(t.textContent=e),s&&(s.textContent=r),await G(c.modal)}async function he(){const e=document.querySelector(c.exportOptionsModal);if(!e||!await G(c.exportOptionsModal))return null;const a=e.querySelector('input[name="vat_option"]:checked'),t=e.querySelector("#exportMethod");return{vatOption:a?a.value:"include",exportMethod:t?t.value:"direct"}}function O(e,r){e&&(e.classList.add("item-removing"),e.addEventListener("animationend",()=>{e.remove(),r&&$(r),K(),J(),M(),B()},{once:!0}))}function J(){document.querySelectorAll(c.room).forEach(e=>{const r=e.querySelectorAll(".item-card"),a=r.length;r.forEach((t,s)=>{const n=t.querySelector("[data-item-title]");n&&(n.textContent=`${s+1}/${a}`)})})}function ee(){const e=document.querySelector(c.orderForm),r=document.querySelector(c.lockBtn);if(!e||!r)return;const a=e.querySelectorAll("input, select, textarea, button");e.classList.toggle("is-locked",E),r.classList.toggle("is-locked",E);const t=r.querySelector("i");t&&(t.className=E?"ph-bold ph-lock-key":"ph-bold ph-lock-key-open"),a.forEach(s=>{s.closest(".summary-footer")||s.closest(".main-header")||s.closest(".modal-wrapper")||(s.disabled=E)}),$(E?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",E?"warning":"success")}function A(){const e=document.querySelectorAll(c.allDetailsCards);if(e.length===0)return;const r=[...e].every(t=>t.open),a=document.querySelector(c.toggleAllRoomsBtn);if(a){const t=a.querySelector("i"),s=a.querySelector("span");t&&(t.className=r?"ph ph-rows-slash":"ph ph-rows"),s&&(s.textContent=r?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}}function fe(){const e=document.querySelectorAll(c.allDetailsCards),r=[...e].every(a=>a.open);e.forEach(a=>{a.open=!r}),setTimeout(A,50)}function K(){const e=document.querySelector(c.quickNavRoomList);if(!e)return;e.innerHTML="",document.querySelectorAll(c.room).forEach(a=>{const t=a.querySelector(c.roomNameInput),s=t?t.value:"‡∏´‡πâ‡∏≠‡∏á",n=document.createElement("a");n.href=`#${a.id}`,n.dataset.jumpTo=a.id,n.innerHTML=`<i class="ph ph-door"></i> ${s||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)"}`,e.appendChild(n)})}function W(e,r,a=!0){const t=document.querySelector(e);if(!t||!r)return null;const s=t.content.cloneNode(!0),n=s.firstElementChild;return r.appendChild(s),a&&n&&(n.classList.add("item-created"),n.scrollIntoView({behavior:"smooth",block:"center"})),J(),M(),B(),n}function Q(){const e=document.querySelector(c.roomsContainer);if(!e)return;H++;const r=W("#roomTpl",e,!0);if(r){r.id=`room-${Date.now()}`;const a=r.querySelector(c.roomNameInput);a&&(a.value=`‡∏´‡πâ‡∏≠‡∏á ${H}`),r.open=!0}K(),A()}function _e(e){if(!e)return;const r=e.querySelector(c.setsContainer);r&&W("#setTpl",r)}function ye(e){if(!e)return;const r=e.querySelector(c.decorationsContainer);r&&W("#decoTpl",r)}function ve(e){if(!e)return;const r=e.querySelector(c.wallpapersContainer);if(r){const a=W("#wallpaperTpl",r);a&&te(a.querySelector('[data-act="add-wall"]'))}}function te(e){var a;const r=(a=e==null?void 0:e.closest(".walls-section"))==null?void 0:a.querySelector(c.wallsContainer);r&&(W("#wallTpl",r,!1),D(e))}function re(e){var t,s,n;if(!e)return;const r=(t=e.querySelector('select[name="fabric_variant"]'))==null?void 0:t.value,a=r&&r.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");(s=e.querySelector(c.sheerWrap))==null||s.classList.toggle("hidden",!a),(n=e.querySelector(c.sheerCodeWrap))==null||n.classList.toggle("hidden",!a)}const Se=le(e=>{D(e),B()});function ge(e){if(E){$("‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ","warning"),e.preventDefault();return}Se(e.target)}function we(e){if(E)return;const r=e.target;if(r.matches('select[name="fabric_variant"]')&&re(r.closest(c.set)),r.matches('select[name="deco_type"]')){const a=r.closest(c.decoItem),t=a==null?void 0:a.querySelector(".deco-type-display");t&&(t.textContent=r.value||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á")}r.matches(c.roomNameInput)&&K(),D(r),B()}function qe(e){const r=e.target,a=r.matches('[name="deco_price_sqyd"], [name="wallpaper_price_roll"], [name="wallpaper_install_cost"]'),t=r.matches('input[name="width_m"], input[name="height_m"], input[name="deco_width_m"], input[name="deco_height_m"], input[name="wallpaper_height_m"], input[name="wall_width_m"]');if(a){const s=_(r.value);s>0?r.value=T(s):r.value=""}else if(t){const s=_(r.value);s>0?r.value=s.toFixed(2):r.value=""}}function D(e){var s,n,o,l,i,u,d,m,f,y,g,x;if(!e)return;const r=e.closest(c.set);if(r){const w=r.querySelector("[data-set-summary]");if(w){const p={width_m:(s=r.querySelector('input[name="width_m"]'))==null?void 0:s.value,height_m:(n=r.querySelector('input[name="height_m"]'))==null?void 0:n.value,style:(o=r.querySelector('select[name="set_style"]'))==null?void 0:o.value,fabric_variant:(l=r.querySelector('select[name="fabric_variant"]'))==null?void 0:l.value,price_per_m_raw:(i=r.querySelector('select[name="set_price_per_m"]'))==null?void 0:i.value,sheer_price_per_m:(u=r.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:u.value},v=b.calculateSetPrice(p);let h=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(v.total)}</b> ‡∏ö.`;v.opaque>0&&v.sheer>0&&(h+=` <small>(‡∏ó‡∏∂‡∏ö: ${T(v.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${T(v.sheer)})</small>`),w.innerHTML=h}}const a=e.closest(c.decoItem);if(a){const w=a.querySelector("[data-deco-summary]");if(w){const p={width_m:(d=a.querySelector('input[name="deco_width_m"]'))==null?void 0:d.value,height_m:(m=a.querySelector('input[name="deco_height_m"]'))==null?void 0:m.value,price_sqyd:(f=a.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:f.value},v=b.calculateDecoPrice(p);w.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(v.total)}</b> ‡∏ö. &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${P(v.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`}}const t=e.closest(c.wallpaperItem);if(t){const w=t.querySelector("[data-wallpaper-summary]");if(w){const p={height_m:(y=t.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:y.value,price_per_roll:(g=t.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:g.value,install_cost_per_roll:(x=t.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:x.value,widths:Array.from(t.querySelectorAll('input[name="wall_width_m"]')).map(q=>q.value)},v=b.calculateWallpaperPrice(p);let h=`‡∏£‡∏ß‡∏°: <b>${T(v.total)}</b> ‡∏ö. `;(v.material>0||v.install>0)&&(h+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${T(v.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${T(v.install)})</small>`),h+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${P(v.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${v.rolls} ‡∏°‡πâ‡∏ß‡∏ô`,w.innerHTML=h}}M()}function M(){let e=0,r=0;document.querySelectorAll(c.room).forEach(s=>{let n=0,o=0;const l=s.classList.contains("is-suspended");s.querySelectorAll(c.set).forEach(u=>{var m,f,y,g,x,w;const d=b.calculateSetPrice({is_suspended:l||u.classList.contains("is-suspended"),width_m:(m=u.querySelector('input[name="width_m"]'))==null?void 0:m.value,height_m:(f=u.querySelector('input[name="height_m"]'))==null?void 0:f.value,style:(y=u.querySelector('select[name="set_style"]'))==null?void 0:y.value,fabric_variant:(g=u.querySelector('select[name="fabric_variant"]'))==null?void 0:g.value,price_per_m_raw:(x=u.querySelector('select[name="set_price_per_m"]'))==null?void 0:x.value,sheer_price_per_m:(w=u.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:w.value}).total;n+=d,d>0&&(r++,o++)}),s.querySelectorAll(c.decoItem).forEach(u=>{var m,f,y;const d=b.calculateDecoPrice({is_suspended:l||u.classList.contains("is-suspended"),width_m:(m=u.querySelector('input[name="deco_width_m"]'))==null?void 0:m.value,height_m:(f=u.querySelector('input[name="deco_height_m"]'))==null?void 0:f.value,price_sqyd:(y=u.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:y.value}).total;n+=d,d>0&&(r++,o++)}),s.querySelectorAll(c.wallpaperItem).forEach(u=>{var m,f,y;const d=b.calculateWallpaperPrice({is_suspended:l||u.classList.contains("is-suspended"),height_m:(m=u.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:m.value,price_per_roll:(f=u.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:f.value,install_cost_per_roll:(y=u.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:y.value,widths:Array.from(u.querySelectorAll('input[name="wall_width_m"]')).map(g=>g.value)}).total;n+=d,d>0&&(r++,o++)});const i=s.querySelector("[data-room-brief]");i&&(l?i.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":o>0?i.innerHTML=`<span>${o}</span> &bull; ${T(n)} ‡∏ö‡∏≤‡∏ó`:i.textContent=""),e+=l?0:n});const a=document.querySelector(c.grandTotal),t=document.querySelector(c.setCount);a&&(a.textContent=T(e)),t&&(t.textContent=r)}function Z(e){if(!e||!e.rooms)return;const r=document.querySelector(c.roomsContainer);if(!r)return;r.innerHTML="",H=0;const a=document.querySelector("#customer_name"),t=document.querySelector("#customer_phone"),s=document.querySelector("#customer_address");a&&(a.value=e.customer_name||""),t&&(t.value=e.customer_phone||""),s&&(s.value=e.customer_address||""),e.rooms.forEach(n=>{H++;const o=document.querySelector("#roomTpl");if(!o)return;const l=o.content.cloneNode(!0),i=l.querySelector(c.room);if(!i)return;i.id=n.id||`room-${Date.now()}`,n.is_suspended&&i.classList.add("is-suspended");const u=i.querySelector(c.roomNameInput);u&&(u.value=n.room_name||`‡∏´‡πâ‡∏≠‡∏á ${H}`);const d=i.querySelector(c.setsContainer),m=i.querySelector(c.decorationsContainer),f=i.querySelector(c.wallpapersContainer),y=document.querySelector("#setTpl"),g=document.querySelector("#decoTpl"),x=document.querySelector("#wallpaperTpl"),w=document.querySelector("#wallTpl");d&&y&&n.sets&&n.sets.forEach(p=>{const v=y.content.cloneNode(!0),h=v.querySelector(c.set);p.is_suspended&&h.classList.add("is-suspended"),h.querySelector('input[name="width_m"]').value=p.width_m||"",h.querySelector('input[name="height_m"]').value=p.height_m||"",h.querySelector('select[name="set_style"]').value=p.style||"‡∏•‡∏≠‡∏ô",h.querySelector('select[name="fabric_variant"]').value=p.fabric_variant||"‡∏ó‡∏∂‡∏ö",h.querySelector('select[name="set_price_per_m"]').value=p.price_per_m_raw||"",h.querySelector('select[name="sheer_price_per_m"]').value=p.sheer_price_per_m||"",h.querySelector('select[name="opening_style"]').value=p.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á",h.querySelector('select[name="track_color"]').value=p.track_color||"‡∏Ç‡∏≤‡∏ß",h.querySelector('input[name="fabric_code"]').value=p.fabric_code||"",h.querySelector('input[name="sheer_fabric_code"]').value=p.sheer_fabric_code||"",h.querySelector('input[name="notes"]').value=p.notes||"",re(h),d.appendChild(v)}),m&&g&&n.decorations&&n.decorations.forEach(p=>{const v=g.content.cloneNode(!0),h=v.querySelector(c.decoItem);p.is_suspended&&h.classList.add("is-suspended");const q=h.querySelector('select[name="deco_type"]');q.value=p.type||"",h.querySelector(".deco-type-display").textContent=p.type||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",h.querySelector('input[name="deco_width_m"]').value=p.width_m||"",h.querySelector('input[name="deco_height_m"]').value=p.height_m||"",h.querySelector('input[name="deco_price_sqyd"]').value=T(p.price_sqyd)||"",h.querySelector('input[name="deco_code"]').value=p.deco_code||"",h.querySelector('input[name="deco_notes"]').value=p.notes||"",m.appendChild(v)}),f&&x&&n.wallpapers&&n.wallpapers.forEach(p=>{const v=x.content.cloneNode(!0),h=v.querySelector(c.wallpaperItem);p.is_suspended&&h.classList.add("is-suspended"),h.querySelector('input[name="wallpaper_height_m"]').value=p.height_m||"",h.querySelector('input[name="wallpaper_code"]').value=p.wallpaper_code||"",h.querySelector('input[name="wallpaper_price_roll"]').value=T(p.price_per_roll)||"",h.querySelector('input[name="wallpaper_install_cost"]').value=T(p.install_cost_per_roll)||"300",h.querySelector('input[name="wallpaper_notes"]').value=p.notes||"";const q=h.querySelector(c.wallsContainer);q&&w&&p.widths&&p.widths.forEach(L=>{const S=w.content.cloneNode(!0);S.querySelector('input[name="wall_width_m"]').value=L||"",q.appendChild(S)}),f.appendChild(v)}),r.appendChild(l)}),document.querySelectorAll(".item-card").forEach(n=>{D(n)}),J(),M(),K(),A(),$("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}function be(e,r){const a=document.querySelector(c.printableContent);!a||!e||!e.html||(a.innerHTML=e.html,setTimeout(()=>{if(r==="direct"){const t=document.getElementById("quotation-template");t&&html2pdf().from(t).set({margin:[15,12,10,12],filename:`${e.fileName}.pdf`,pagebreak:{mode:["css","legacy"]},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save().then(()=>{a.innerHTML=""})}else r==="print"&&(window.print(),a.innerHTML="")},ae))}function $e(e){if(!e||!e.html)return;const r=new Blob([e.html],{type:"text/html;charset=utf-8"}),a=URL.createObjectURL(r),t=document.createElement("a");t.href=a,t.download=`${e.fileName}.html`,t.click(),URL.revokeObjectURL(a),$("Export ‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}const Le=e=>{const r=e.target.closest("[data-act]");if(!r||E&&!r.closest(".unlockable"))return;const a=r.dataset.act,t=r.closest(c.room),s=(o,{confirm:l=!1,isRemoval:i=!1,title:u="",body:d="",actionFn:m,toastMsg:f=""})=>{if(!o)return;const y=()=>{var g;m(o,f),i||(f&&$(f),D(o),B()),(g=r.closest(".room-options-menu"))==null||g.classList.remove("show"),o.classList.remove("overflow-visible")};l?V(u,d).then(g=>g&&y()):y()},n={"add-room":Q,"add-set":()=>_e(t),"add-deco":()=>ye(t),"add-wallpaper":()=>ve(t),"add-wall":()=>te(r),"toggle-room-menu":()=>{e.preventDefault();const o=r.nextElementSibling;if(!o||!t)return;const l=!o.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(i=>i.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(i=>i.classList.remove("overflow-visible")),l&&(o.classList.add("show"),t.classList.add("overflow-visible"))},"toggle-suspend-room":()=>{var o;e.preventDefault(),t==null||t.classList.toggle("is-suspended"),M(),B(),(o=r.closest(".room-options-menu"))==null||o.classList.remove("show"),t==null||t.classList.remove("overflow-visible")},"toggle-suspend":()=>{var o;e.preventDefault(),(o=r.closest(".item-card"))==null||o.classList.toggle("is-suspended"),D(r),B()},"clear-room":()=>s(t,{confirm:!0,title:"‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",actionFn:o=>{o.querySelector(c.setsContainer).innerHTML="",o.querySelector(c.decorationsContainer).innerHTML="",o.querySelector(c.wallpapersContainer).innerHTML=""},toastMsg:"‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"}),"del-room":()=>s(t,{confirm:!0,isRemoval:!0,title:"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",actionFn:O,toastMsg:"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"}),"del-set":()=>s(r.closest(c.set),{confirm:!0,isRemoval:!0,title:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô?",actionFn:O,toastMsg:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß"}),"del-deco":()=>s(r.closest(c.decoItem),{confirm:!0,isRemoval:!0,title:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á?",actionFn:O,toastMsg:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß"}),"del-wallpaper":()=>s(r.closest(c.wallpaperItem),{confirm:!0,isRemoval:!0,title:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå?",actionFn:O,toastMsg:"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß"}),"del-wall":()=>s(r.closest(".wall-input-row"),{confirm:!0,isRemoval:!0,title:"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á",body:"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",actionFn:O,toastMsg:"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß"})};n[a]&&(n[a](),J())};function Te(){E=!E,ee()}function xe(){const e=document.querySelector(c.setTpl);if(!e)return;const r=e.content.querySelector('select[name="set_price_per_m"]'),a=e.content.querySelector('select[name="sheer_price_per_m"]'),t=s=>{let n='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return s.forEach(o=>{n+=`<option value="${o}">${o.toLocaleString("th-TH")}</option>`}),n};r&&(r.innerHTML=t(Y.fabric)),a&&(a.innerHTML=t(Y.sheer))}function Ce(){xe();const e=document.querySelector(c.orderForm),r=document.querySelector(c.fileImporter),a=document.querySelector(c.menuDropdown),t=document.querySelector(c.quickNavDropdown);e.addEventListener("input",ge),e.addEventListener("change",we),e.addEventListener("click",Le),e.addEventListener("blur",qe,!0),document.body.addEventListener("click",n=>{n.target.closest("summary")&&setTimeout(A,50)}),document.querySelector(c.lockBtn).addEventListener("click",Te),document.querySelector(c.toggleAllRoomsBtn).addEventListener("click",fe),document.querySelector(c.quickNavBtn).addEventListener("click",n=>{n.stopPropagation(),a.classList.remove("show"),t.classList.toggle("show")}),document.querySelector(c.quickNavRoomList).addEventListener("click",n=>{const o=n.target.closest("a[data-jump-to]");if(o){n.preventDefault();const l=o.dataset.jumpTo,i=document.getElementById(l);i&&(document.body.classList.add("disable-animations"),i.open=!0,i.scrollIntoView({behavior:"auto",block:"start"}),i.classList.add("scrolling-jump"),setTimeout(()=>{i.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),A()},1e3)),t.classList.remove("show")}});const s=document.querySelector("#addRoomQuickNavBtn");if(s){const n=ce(Q,700);s.addEventListener("click",o=>{o.stopPropagation(),n(),t.classList.remove("show")})}document.querySelector(c.menuBtn).addEventListener("click",n=>{n.stopPropagation(),t.classList.remove("show"),a.classList.toggle("show")}),document.querySelector("#overviewBtn").addEventListener("click",async n=>{n.preventDefault(),a.classList.remove("show");const o=R(),l=me(o),i=document.querySelector("#overviewModalBody");i&&(i.innerHTML=l,G("#overviewModal",()=>{}))}),document.querySelector(c.exportPdfBtn).addEventListener("click",async n=>{n.preventDefault(),a.classList.remove("show");const o=await he();if(!o)return;const l=R(),i=o.vatOption==="include"?C.baseVatRate:0,u=pe(l,{vatRate:i});if(!u){$("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}o.exportMethod==="html"?$e(u):be(u,o.exportMethod)}),document.querySelector(c.importBtn).addEventListener("click",n=>{n.preventDefault(),a.classList.remove("show"),r.click()}),r.addEventListener("change",n=>{var i;const o=(i=n.target.files)==null?void 0:i[0];if(!o)return;const l=new FileReader;l.onload=u=>{try{const d=JSON.parse(u.target.result);Z(d)}catch{$("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error")}},l.readAsText(o),n.target.value=null}),document.querySelector(c.exportBtn).addEventListener("click",n=>{n.preventDefault(),a.classList.remove("show");try{const o=R(),l=JSON.stringify(o,null,4),i=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(i),d=document.createElement("a"),m=new Date,f=`${m.getFullYear()}${(m.getMonth()+1).toString().padStart(2,"0")}${m.getDate().toString().padStart(2,"0")}`,y=(o.customer_name||"data").trim().replace(/\s+/g,"-");d.href=u,d.download=`marnthara-backup-${y}-${f}.json`,d.click(),URL.revokeObjectURL(u),$("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{$("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(c.submitBtn).addEventListener("click",async n=>{if(n.preventDefault(),a.classList.remove("show"),await V("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const o=R();if(!o.customer_name&&!o.customer_phone){$("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}$("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const l=await fetch(ne,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});l.ok?$("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):$(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${l.status}`,"error")}catch{$("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(c.copyTextBtn).addEventListener("click",async n=>{n.preventDefault(),a.classList.remove("show");const o=document.querySelector(c.copyOptionsModal);if(o.querySelector('input[name="copy_option"][value="customer"]').checked=!0,await G(c.copyOptionsModal)){const l=o.querySelector('input[name="copy_option"]:checked').value,i=de(R(),l);try{await navigator.clipboard.writeText(i),$("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{$("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(c.clearItemsBtn).addEventListener("click",async n=>{n.preventDefault(),a.classList.remove("show"),await V("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")&&(document.querySelectorAll(c.room).forEach(o=>{o.querySelector(c.setsContainer).innerHTML="",o.querySelector(c.decorationsContainer).innerHTML="",o.querySelector(c.wallpapersContainer).innerHTML=""}),M(),B(),$("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))}),document.querySelector(c.clearAllBtn).addEventListener("click",async n=>{n.preventDefault(),a.classList.remove("show"),await V("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ")&&(localStorage.removeItem(U),window.location.reload())}),window.addEventListener("click",n=>{n.target.closest(".menu-container")||(a.classList.remove("show"),t.classList.remove("show")),n.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(o=>o.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(o=>o.classList.remove("overflow-visible")))});try{const n=localStorage.getItem(U);if(n)Z(JSON.parse(n));else{Q();const o=document.querySelector("#customerDetailsCard");o&&(o.open=!0)}}catch{localStorage.removeItem(U),Q()}M(),ee(),A()}document.addEventListener("DOMContentLoaded",Ce);
