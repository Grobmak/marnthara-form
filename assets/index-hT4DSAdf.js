(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const ut="input-ui/5.7.0",dt="https://your-make-webhook-url.com/your-unique-path",ve="marnthara.input.v5",mt=500,F={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"./assets/logo.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},pt=1.19599,xe={ROLL_WIDTH_M:.53,ROLL_LENGTH_M:10,STRIPS_PER_ROLL_UNDER_2_5M:3},be={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},g={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",wallTpl:"#wallTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",allItemsContainer:"[data-all-items]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",sheerCodeWrap:"[data-sheer-code-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn"},v=e=>{typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return Number.isFinite(t)?t:0},Z=e=>{const t=v(e);return t>0?t.toFixed(2):""},D=(e,t=2,n=!1)=>Number.isFinite(e)?e.toLocaleString("en-US",{minimumFractionDigits:n?2:t,maximumFractionDigits:n?2:t}):"0",T=(e,t=0)=>Number.isFinite(e)?e.toLocaleString("th-TH",{minimumFractionDigits:t,maximumFractionDigits:t}):"0",ft=(e,t=150)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e(...r),t)}},ht=(e,t=700)=>{let n=!1;return(...r)=>{if(!n){n=!0;try{return e(...r)}finally{setTimeout(()=>{n=!1},t)}}}},k=e=>typeof e!="string"?"":e.replace(/[&<>"']/g,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}}),et=e=>typeof e!="string"?"":e.replace(/[\\/?%*:|"<>\x00-\x1f]/g,"").trim()||"file";function yt(e){let t=v(e);if(isNaN(t))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";if(t===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const n=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"],r=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];let s=Math.floor(t),o=Math.round((t-s)*100);const a=c=>{if(c===0)return"";let i="";const d=String(c);for(let u=0;u<d.length;u++){const h=d[u];d.length-1;const _=d.length-u-1;h!=="0"&&(_===1&&h==="1"?i+=r[_]:_===1&&h==="2"?i+="‡∏¢‡∏µ‡πà"+r[_]:_===0&&h==="1"&&d.length>1?i+="‡πÄ‡∏≠‡πá‡∏î":i+=n[parseInt(h)]+r[_])}return i};let l="";if(s>0){const c=Math.floor(s/1e6),i=s%1e6;c>0&&(l+=a(c)+"‡∏•‡πâ‡∏≤‡∏ô"),l+=a(i),l+="‡∏ö‡∏≤‡∏ó"}let m="";return o>0?m=a(o)+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":l+="‡∏ñ‡πâ‡∏ß‡∏ô",(l+m).trim()}const Pe="marnthara.favorites.v4",_e={fabric:[],sheer:[],wallpaper:[],wooden_blind:[],roller_blind:[],vertical_blind:[],partition:[],pleated_screen:[],aluminum_blind:[]};function X(){try{const e=localStorage.getItem(Pe);return e?{..._e,...JSON.parse(e)}:_e}catch(e){return console.error("Failed to parse favorites from localStorage",e),_e}}function we(e){try{localStorage.setItem(Pe,JSON.stringify(e))}catch(t){console.error("Failed to save favorites to localStorage",t)}}function Ye(e){if(!e||typeof e!="object")return console.error("Invalid favorites data for import."),!1;const t={..._e,...e};return we(t),!0}function tt(e){if(!e||typeof e!="object")return console.error("Invalid favorites data for merge."),0;const t=X();let n=0;for(const r in e)Object.hasOwnProperty.call(e,r)&&Array.isArray(e[r])&&(t[r]||(t[r]=[]),e[r].forEach(s=>{!t[r].some(a=>a.code===s.code)&&s.code&&(t[r].push(s),n++)}),t[r].sort((s,o)=>s.code.localeCompare(o.code)));return n>0&&we(t),n}function vt(e,t,n){const r=X();r[e]||(r[e]=[]);const s=r[e],o=s.find(a=>a.code===t);return o?o.price=n:s.push({code:t,price:n}),s.sort((a,l)=>a.code.localeCompare(l.code)),we(r),!0}function Ce(e,t){const n=X();if(!n[e])return!1;const r=n[e].findIndex(s=>s.code===t);return r>-1?(n[e].splice(r,1),we(n),!0):!1}function Fe(e,t){if(!e||!t)return;const n=X(),r=t.trim();return(n[e]||[]).find(o=>o.code===r)}function _t(e,t){return!!Fe(e,t)}function ke(e,t,n){const r=Fe(e,t);return r&&r.price===n?(Ce(e,t),!1):(vt(e,t,n),!0)}function gt(){localStorage.removeItem(Pe),console.log("All favorites have been cleared.")}function j(){var n,r,s,o,a,l;const e=X(),t={app_version:ut,customer_name:((n=document.querySelector('[name="customer_name"]'))==null?void 0:n.value)||"",customer_phone:((r=document.querySelector('[name="customer_phone"]'))==null?void 0:r.value)||"",customer_address:((s=document.querySelector('[name="customer_address"]'))==null?void 0:s.value)||"",customer_card_open:(o=document.querySelector("#customerDetailsCard"))==null?void 0:o.open,discount:{type:((a=document.querySelector("#discount_type"))==null?void 0:a.value)||"amount",value:v((l=document.querySelector("#discount_value"))==null?void 0:l.value)},rooms:[],favorites:e};return document.querySelectorAll(g.room).forEach(m=>{var i,d;const c={id:m.id,room_name:((i=m.querySelector(g.roomNameInput))==null?void 0:i.value)||"",is_suspended:m.classList.contains("is-suspended"),is_open:m.open,items:[]};(d=m.querySelector(g.allItemsContainer))==null||d.childNodes.forEach(u=>{var f,p,y,b,q,x,S,w,M,B,A,L,I,E,R,N,O,Y,re,W,fe,We,De,Ue,Ve,Ge;if(u.nodeType!==1||!u.matches(".item-card"))return;const h=u.dataset.type;if(!h)return;let _={type:h,is_suspended:u.classList.contains("is-suspended")};h==="set"?Object.assign(_,{width_m:v((f=u.querySelector('input[name="width_m"]'))==null?void 0:f.value),height_m:v((p=u.querySelector('input[name="height_m"]'))==null?void 0:p.value),style:((y=u.querySelector('select[name="set_style"]'))==null?void 0:y.value)||"",fabric_variant:((b=u.querySelector('select[name="fabric_variant"]'))==null?void 0:b.value)||"",price_per_m_raw:v((q=u.querySelector('select[name="set_price_per_m"]'))==null?void 0:q.value),sheer_price_per_m:v((x=u.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:x.value),fabric_code:((S=u.querySelector('input[name="fabric_code"]'))==null?void 0:S.value)||"",sheer_fabric_code:((w=u.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:w.value)||"",opening_style:((M=u.querySelector('select[name="opening_style"]'))==null?void 0:M.value)||"",track_color:((B=u.querySelector('input[name="track_color"]'))==null?void 0:B.value)||"‡∏Ç‡∏≤‡∏ß",bracket_color:((A=u.querySelector('input[name="bracket_color"]'))==null?void 0:A.value)||"‡∏Ç‡∏≤‡∏ß",finial_color:((L=u.querySelector('input[name="finial_color"]'))==null?void 0:L.value)||"‡∏Ç‡∏≤‡∏ß",grommet_color:((I=u.querySelector('input[name="grommet_color"]'))==null?void 0:I.value)||"‡πÄ‡∏á‡∏¥‡∏ô",notes:((E=u.querySelector('input[name="notes"]'))==null?void 0:E.value)||""}):h==="wallpaper"?Object.assign(_,{height_m:v((R=u.querySelector('[name="wallpaper_height_m"]'))==null?void 0:R.value),wallpaper_code:((N=u.querySelector('[name="wallpaper_code"]'))==null?void 0:N.value)||"",price_per_roll:v((O=u.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:O.value),install_cost_per_roll:v((Y=u.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:Y.value),notes:((re=u.querySelector('[name="wallpaper_notes"]'))==null?void 0:re.value)||"",widths:Array.from(u.querySelectorAll('[name="wall_width_m"]')).map(it=>v(it.value))}):u.matches(".area-based-item")&&(Object.assign(_,{width_m:v((W=u.querySelector('[name="area_width_m"]'))==null?void 0:W.value),height_m:v((fe=u.querySelector('[name="area_height_m"]'))==null?void 0:fe.value),price_sqyd:v((We=u.querySelector('[name="area_price_sqyd"]'))==null?void 0:We.value),code:((De=u.querySelector('[name="area_code"]'))==null?void 0:De.value)||"",notes:((Ue=u.querySelector('[name="area_notes"]'))==null?void 0:Ue.value)||""}),(h==="partition"||h==="pleated_screen")&&(_.opening_style=((Ve=u.querySelector('select[name="opening_style"]'))==null?void 0:Ve.value)||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"),["wooden_blind","roller_blind","vertical_blind","aluminum_blind"].includes(h)&&(_.adjustment_side=((Ge=u.querySelector('select[name="adjustment_side"]'))==null?void 0:Ge.value)||"‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤")),c.items.push(_)}),t.rooms.push(c)}),t}function P(){try{localStorage.setItem(ve,JSON.stringify(j()))}catch(e){console.error("Failed to save data to localStorage:",e)}}const C={stylePlus:e=>be.style_surcharge[e]??0,heightPlus:e=>{const t=[...be.height].sort((n,r)=>r.threshold-n.threshold);for(const n of t)if(e>n.threshold)return n.add_per_m;return 0},fabricYardage:(e,t)=>{const n=v(t);return n<=0||!e?0:e==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||e==="‡∏à‡∏µ‡∏ö"?(n*2+.6)/.9:e==="‡∏•‡∏≠‡∏ô"?(n*2.6+.6)/.9:0},calculateGrommets:function(e){if(!e||e.style!=="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||v(e.width_m)<=0)return 0;const t=v(e.width_m),n=2,r=.05,s=.16;let o;e.opening_style==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?o=t/2:o=t;const a=o*n+2*r;let l=Math.round(a/s);return l%2!==0&&(l+=1),l<4&&(l=4),e.opening_style==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?l*2:l},wallpaperRolls:(e,t)=>{const n=v(e),r=v(t);if(n<=0||r<=0)return 0;const s=r>2.5?Math.floor(xe.ROLL_LENGTH_M/r):xe.STRIPS_PER_ROLL_UNDER_2_5M;if(s<=0)return 0;const o=Math.ceil(n/xe.ROLL_WIDTH_M);return Math.ceil(o/s)},calculateSetPrice:function(e){var a,l;if(!e||e.is_suspended||v(e.width_m)<=0)return{total:0,opaque:0,sheer:0};const t=this.stylePlus(e.style),n=this.heightPlus(v(e.height_m)),r=v(e.width_m),s=(a=e.fabric_variant)!=null&&a.includes("‡∏ó‡∏∂‡∏ö")&&v(e.price_per_m_raw)>0?(v(e.price_per_m_raw)+t+n)*r:0,o=(l=e.fabric_variant)!=null&&l.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&v(e.sheer_price_per_m)>0?(v(e.sheer_price_per_m)+t+n)*r:0;return{total:Math.round(s+o),opaque:Math.round(s),sheer:Math.round(o)}},calculateDecoPrice:function(e){if(!e||e.is_suspended||v(e.width_m)<=0||v(e.height_m)<=0)return{total:0,sqm:0,sqyd:0};const t=v(e.width_m)*v(e.height_m),n=t*pt,r=n*v(e.price_sqyd);return{total:Math.round(r),sqm:t,sqyd:n}},calculateWallpaperPrice:function(e){var a;if(!e||e.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const t=((a=e.widths)==null?void 0:a.reduce((l,m)=>l+v(m),0))||0;if(t<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const n=v(e.height_m),r=this.wallpaperRolls(t,n),s=r*v(e.price_per_roll),o=r*v(e.install_cost_per_roll??300);return{total:Math.round(s+o),material:Math.round(s),install:Math.round(o),rolls:r,sqm:t*n}}},ee={set:"‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô",wallpaper:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå",wooden_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ",roller_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô",vertical_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á",partition:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á",pleated_screen:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö",aluminum_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°"};function ae(e){const{width:t=0,height:n=0}=e,r=15,s=100-r*2,o=100-r*2,a=t>0&&n>0?Math.min(s/t,o/n):1,l=t*a,m=n*a,c=(100-l)/2,i=(100-m)/2,d=`
        <line x1="${c}" y1="${i+m+5}" x2="${c+l}" y2="${i+m+5}" class="dimension-line" />
        <line x1="${c}" y1="${i+m+3}" x2="${c}" y2="${i+m+7}" class="dimension-tick" />
        <line x1="${c+l}" y1="${i+m+3}" x2="${c+l}" y2="${i+m+7}" class="dimension-tick" />
        <text x="50" y="${i+m+14}" class="dimension-text">${t.toFixed(2)} ‡∏°.</text>

        <line x1="${c-5}" y1="${i}" x2="${c-5}" y2="${i+m}" class="dimension-line" />
        <line x1="${c-7}" y1="${i}" x2="${c-3}" y2="${i}" class="dimension-tick" />
        <line x1="${c-7}" y1="${i+m}" x2="${c-3}" y2="${i+m}" class="dimension-tick" />
        <text x="${c-9}" y="50" class="dimension-text" transform="rotate(-90, ${c-9}, 50)">${n.toFixed(2)} ‡∏°.</text>
    `;return{x:c,y:i,svgWidth:l,svgHeight:m,lines:d}}function rt(e,{y:t,svgHeight:n}){if(!e.opening_style)return"";const r=e.opening_style==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?"< >":"‚Üí";return`
        <rect x="40" y="${t+n/2-8}" width="20" height="16" rx="3" class="opening-text-bg" />
        <text x="50" y="${t+n/2+1}" class="opening-text">${r}</text>
    `}function Re(e,{x:t,y:n,svgWidth:r}){if(!e.adjustment_side)return"";const o=e.adjustment_side==="‡∏õ‡∏£‡∏±‡∏ö‡∏ã‡πâ‡∏≤‡∏¢"?t+8:t+r-8;return`
        <g class="adjustment-cord">
            <circle cx="${o}" cy="${n+3}" r="2"/>
            <line x1="${o}" y1="${n+5}" x2="${o}" y2="${n+15}"/>
        </g>
    `}function bt(e){const t=v(e.width_m),n=v(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:r,y:s,svgWidth:o,svgHeight:a,lines:l}=ae({width:t,height:n});let m="";const c=e.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á"),i=e.fabric_variant.includes("‡∏ó‡∏∂‡∏ö"),d=(_,f)=>(e.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á")==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?`
                <rect x="${r}" y="${s+f}" width="${o/2-1}" height="${a}" class="${_}" />
                <rect x="${r+o/2+1}" y="${s+f}" width="${o/2-1}" height="${a}" class="${_}" />
            `:`<rect x="${r}" y="${s+f}" width="${o}" height="${a}" class="${_}" />`;c&&(m+=d("curtain-panel-sheer",0)),i&&(m+=d("curtain-panel-opaque",c?-2:0));let u="";if(e.style==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"){const _=Math.max(8,Math.floor(o/8));for(let f=0;f<_;f++){const p=r+o/(_-1)*f;u+=`<circle cx="${p}" cy="${s}" r="2" class="style-grommet" />`}}else if(e.style==="‡∏•‡∏≠‡∏ô"){const _=Math.max(4,Math.floor(o/10));let f=`M ${r},${s}`;for(let p=0;p<_;p++)f+=" q 5,-4 10,0";u=`<path d="${f}" class="style-ripplefold-path" />`}else e.style==="‡∏à‡∏µ‡∏ö"&&(u=`<text x="${r+2}" y="${s+5}" class="style-pleat-text">||| ||| ||| ||| |||</text>`);const h=rt(e,{y:s,svgHeight:a});return`<svg viewBox="0 0 100 100">${m}${u}${h}${l}</svg>`}function Je(e,t=!1){const n=v(e.width_m),r=v(e.height_m);if(n<=0||r<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:s,y:o,svgWidth:a,svgHeight:l,lines:m}=ae({width:n,height:r});let c=`<rect x="${s}" y="${o}" width="${a}" height="${l}" class="blind-frame" />`;if(t){const d=Math.max(4,Math.floor(a/8)),u=a/d;for(let h=0;h<d;h++)c+=`<rect x="${s+h*u+1}" y="${o}" width="${u-2}" height="${l}" class="blind-slat" />`}else{const d=Math.max(3,Math.floor(l/10)),u=l/d;for(let h=0;h<d;h++)c+=`<rect x="${s}" y="${o+h*u+.5}" width="${a}" height="${u-1}" class="blind-slat" />`}const i=Re(e,{x:s,y:o,svgWidth:a});return`<svg viewBox="0 0 100 100">${c}${m}${i}</svg>`}function St(e){const t=v(e.width_m),n=v(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:r,y:s,svgWidth:o,svgHeight:a,lines:l}=ae({width:t,height:n});let m=`<rect x="${r}" y="${s}" width="${o}" height="${a}" class="blind-frame" />`;const c=Math.max(3,Math.floor(a/8)),i=a/c;for(let p=0;p<c;p++)m+=`<rect x="${r+1}" y="${s+p*i}" width="${o-2}" height="${i-1.5}" rx="0.5" class="wooden-blind-slat" />`;const d=Math.max(2,o*.05),u=r+o*.25-d/2,h=r+o*.75-d/2,_=`
        <rect x="${u}" y="${s}" width="${d}" height="${a}" class="wooden-blind-strip" />
        <rect x="${h}" y="${s}" width="${d}" height="${a}" class="wooden-blind-strip" />
    `,f=Re(e,{x:r,y:s,svgWidth:o});return`<svg viewBox="0 0 100 100">${m}${_}${l}${f}</svg>`}function wt(e){const t=v(e.width_m),n=v(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:r,y:s,svgWidth:o,svgHeight:a,lines:l}=ae({width:t,height:n}),m=`
        <rect x="${r}" y="${s}" width="${o}" height="${a}" class="roller-fabric" />
        <rect x="${r-1}" y="${s-4}" width="${o+2}" height="5" rx="2" class="roller-roll" />
        <line x1="${r}" y1="${s+a}" x2="${r+o}" y2="${s+a}" class="roller-bar" />
    `,c=Re(e,{x:r,y:s-2,svgWidth:o});return`<svg viewBox="0 0 100 100">${m}${l}${c}</svg>`}function Ke(e,t=!1){const n=v(e.width_m),r=v(e.height_m);if(n<=0||r<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:s,y:o,svgWidth:a,svgHeight:l,lines:m}=ae({width:n,height:r});let c="";if(t)c=`
            <defs>
                <pattern id="pleated-mesh" width="6" height="6" patternUnits="userSpaceOnUse">
                    <path d="M -1 1 L 1 -1 M 0 6 L 6 0" class="pleated-screen-mesh" />
                </pattern>
            </defs>
            <rect x="${s}" y="${o}" width="${a}" height="${l}" class="blind-frame" />
            <rect x="${s}" y="${o}" width="${a}" height="${l}" fill="url(#pleated-mesh)" />
        `;else{const u=a/4;for(let h=0;h<4;h++)c+=`<rect x="${s+h*u}" y="${o}" width="${u}" height="${l}" class="partition-panel" />`,h>0&&(c+=`<line x1="${s+h*u}" y1="${o}" x2="${s+h*u}" y2="${o+l}" class="partition-hinge" />`)}const i=rt(e,{y:o,svgHeight:l});return`<svg viewBox="0 0 100 100">${c}${i}${m}</svg>`}function qt(e){const t=(e.widths||[]).reduce((u,h)=>u+v(h),0),n=v(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:r,y:s,svgWidth:o,svgHeight:a,lines:l}=ae({width:t,height:n});let m="";const c=Math.floor(o/10),i=Math.floor(a/10);for(let u=0;u<i;u++)for(let h=0;h<c;h++)m+=`<circle cx="${r+h*10+5}" cy="${s+u*10+5}" r="1.5" class="wallpaper-pattern" />`;return`<svg viewBox="0 0 100 100">${`<rect x="${r}" y="${s}" width="${o}" height="${a}" class="blind-frame" /> ${m}`}${l}</svg>`}function $t(e){switch(e.type){case"set":return bt(e);case"wooden_blind":return St(e);case"aluminum_blind":return Je(e,!1);case"vertical_blind":return Je(e,!0);case"roller_blind":return wt(e);case"partition":return Ke(e,!1);case"pleated_screen":return Ke(e,!0);case"wallpaper":return qt(e);default:const t=ee[e.type]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";return`<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">${k(t)}</text></svg>`}}function Qe(e){let t=`
üìÉ *‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤*
`,n=!1;return e.rooms.forEach(r=>{if(r.is_suspended||!r.items)return;const s=r.items.filter(a=>a.is_suspended?!1:a.type==="wallpaper"?(a.widths||[]).reduce((l,m)=>l+v(m),0)>0:v(a.width_m)>0);if(s.length===0)return;n=!0,t+=`
*üö™ ‡∏´‡πâ‡∏≠‡∏á: ${r.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let o=0;s.forEach(a=>{o++;const l=ee[a.type]||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";a.type==="set"?t+=` ${o}) ${l} ${a.style} (${a.fabric_variant})
`:t+=` ${o}) ${l}
`})}),n?t+`------------------------------
`:""}function ot(e){return e.rooms.reduce((t,n)=>{var s;if(n.is_suspended)return t;const r=((s=n.items)==null?void 0:s.reduce((o,a)=>{if(a.is_suspended)return o;switch(a.type){case"set":return o+C.calculateSetPrice(a).total;case"wallpaper":return o+C.calculateWallpaperPrice(a).total;default:return o+C.calculateDecoPrice(a).total}},0))||0;return t+r},0)}function xt(e,t){const n=ot(e);let r=0,s="";e.discount&&e.discount.value>0&&(e.discount.type==="percent"?(r=n*(e.discount.value/100),s=`üè∑Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (${e.discount.value}%): -${T(r)} ‡∏ö‡∏≤‡∏ó
`):(r=e.discount.value,s=`üè∑Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: -${T(r)} ‡∏ö‡∏≤‡∏ó
`));const o=n-r;let a=`üóìÔ∏è ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})})
`;if(a+=`üë§ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${e.customer_name||"-"}
`,(t==="customer"||t==="owner")&&(a+=`üìû ‡πÇ‡∏ó‡∏£: ${e.customer_phone||"-"}
`,a+=`üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${e.customer_address||"-"}
`),a+=`------------------------------
`,t==="customer")return a+=Qe(e),r>0&&(a+=`
‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(n)} ‡∏ö‡∏≤‡∏ó
`,a+=s),a+=`
üí∞ *‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${T(o)} ‡∏ö‡∏≤‡∏ó*
`,a+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏∞
${F.name}
‡πÇ‡∏ó‡∏£: ${F.phone}`,a;if(t==="purchase_order"||t==="owner"){t==="owner"&&(a+=Qe(e));const l={opaqueFabrics:[],sheerFabrics:[],decorations:{},wallpapers:[],allSets:[]};e.rooms.forEach(p=>{p.is_suspended||!p.items||p.items.forEach(y=>{const b=y.type==="set"||y.type.includes("_blind")||y.type==="partition"||y.type==="pleated_screen";if(!(y.is_suspended||b&&v(y.width_m)<=0))switch(y.type){case"set":l.allSets.push(y),y.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&l.opaqueFabrics.push({code:y.fabric_code||"??",yards:C.fabricYardage(y.style,y.width_m)}),y.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&l.sheerFabrics.push({code:y.sheer_fabric_code||"??",yards:C.fabricYardage(y.style,y.width_m)});break;case"wallpaper":const q=(y.widths||[]).reduce((S,w)=>S+v(w),0);if(q>0){const S=C.wallpaperRolls(q,y.height_m);S>0&&l.wallpapers.push({code:y.wallpaper_code||"xxx",rolls:S})}break;default:const x=ee[y.type]||y.type;l.decorations[x]||(l.decorations[x]=[]),l.decorations[x].push({code:y.code||"xxx",width:y.width_m,height:y.height_m,opening_style:y.opening_style,adjustment_side:y.adjustment_side});break}})});const m={};if([...l.opaqueFabrics,...l.sheerFabrics].forEach(p=>{m[p.code]=(m[p.code]||0)+p.yards}),Object.keys(m).length>0){a+=`‚úÇÔ∏è *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ú‡πâ‡∏≤)*
`,a+=`------------------------------
`,l.opaqueFabrics.length>0&&l.opaqueFabrics.forEach(p=>{a+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain)
`,a+=`  ‡∏£‡∏´‡∏±‡∏™: #${p.code||"??"}
`,a+=`  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${p.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),l.sheerFabrics.length>0&&l.sheerFabrics.forEach(p=>{a+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer)
`,a+=`  ‡∏£‡∏´‡∏±‡∏™: #${p.code||"??"}
`,a+=`  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${p.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),a+=`------------------------------
`,a+=`üìä *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ú‡πâ‡∏≤ (‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™)*
`,a+=`------------------------------
`;for(const[p,y]of Object.entries(m))a+=`  - ‡∏£‡∏´‡∏±‡∏™ #${p}: ${y.toFixed(2)} ‡∏´‡∏•‡∏≤
`;a+=`
`}const c=l.allSets.filter(p=>p.style==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"),i=l.allSets.filter(p=>p.style!=="‡∏ï‡∏≤‡πÑ‡∏Å‡πà");if(i.length>0){a+=`------------------------------
`,a+=`üìè *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á (‡∏•‡∏≠‡∏ô/‡∏à‡∏µ‡∏ö)*
`,a+=`------------------------------

`;let p=1;i.forEach(y=>{a+=`(${p++}) ‡∏£‡∏≤‡∏á ${y.style}, ‡∏™‡∏µ: ${y.track_color}
`,y.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(a+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${Number(y.width_m).toFixed(2)} ‡∏°.
`),y.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(a+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${Number(y.width_m).toFixed(2)} ‡∏°.
`),y.notes&&t==="owner"&&(a+=`  üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${y.notes}
`),a+=`
`})}if(c.length>0){a+=`------------------------------
`,a+=`üìè *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á (‡∏ï‡∏≤‡πÑ‡∏Å‡πà)*
`,a+=`------------------------------

`;let p=1;c.forEach(w=>{a+=`(${p++}) ‡∏£‡∏≤‡∏á ${w.style}, ‡∏™‡∏µ: ${w.track_color}
`,w.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(a+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${Number(w.width_m).toFixed(2)} ‡∏°.
`),w.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(a+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${Number(w.width_m).toFixed(2)} ‡∏°.
`),w.notes&&t==="owner"&&(a+=`  üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${w.notes}
`),a+=`
`}),a+=`--- ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡πÑ‡∏Å‡πà ---
`;const y=[];c.forEach(w=>{w.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&y.push(Number(w.width_m)),w.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&y.push(Number(w.width_m))});const b=6;y.sort((w,M)=>M-w);const q=[];for(const w of y){let M=!1;for(let B=0;B<q.length;B++)if(q[B]>=w-.001){q[B]-=w,M=!0;break}M||q.push(b-w)}a+=`‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏° (6 ‡∏°.) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: *${q.length} ‡πÄ‡∏™‡πâ‡∏ô*

`;const x=y.reduce((w,M)=>{const B=M.toFixed(2);return w[B]=(w[B]||0)+1,w},{}),S=Object.entries(x).sort((w,M)=>parseFloat(M[0])-parseFloat(w[0]));if(S.length>0){a+=`*‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î:*
`;for(const[w,M]of S)a+=`  - ‡∏Ç‡∏ô‡∏≤‡∏î ${w} ‡∏°. = ${M} ‡πÄ‡∏™‡πâ‡∏ô
`;a+=`
`}}const d={};l.allSets.forEach(p=>{const y=p.track_color||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",b=p.style,q=p.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á",x=v(p.width_m)>=1.6?3:2;if(d[y]||(d[y]={brackets:{},finials:0,grommets:{}}),d[y].brackets[b]||(d[y].brackets[b]={single:0,double:0}),q?d[y].brackets[b].double+=x:d[y].brackets[b].single+=x,b==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"){const S=q?4:2;d[y].finials+=S}if(b==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"){const S=p.grommet_color||"‡πÄ‡∏á‡∏¥‡∏ô",w=C.calculateGrommets(p);d[y].grommets[S]||(d[y].grommets[S]=0),d[y].grommets[S]+=w}});const u=l.allSets.length*2;if(Object.keys(d).length>0||u>0){a+=`------------------------------
`,a+=`üî© *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Hardware)*
`,a+=`------------------------------

`;for(const[p,y]of Object.entries(d)){let b=!1,q=`**‡∏™‡∏µ${p}**
`;const x=Object.keys(y.brackets);x.length>0&&x.forEach(w=>{const M=y.brackets[w];(M.single>0||M.double>0)&&(b=!0,q+=`  - ‡∏Ç‡∏≤‡∏à‡∏±‡∏ö (${w}):
`,M.single>0&&(q+=`    - ‡∏Ç‡∏≤‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß: ${M.single} ‡∏ï‡∏±‡∏ß
`),M.double>0&&(q+=`    - ‡∏Ç‡∏≤2‡∏ä‡∏±‡πâ‡∏ô: ${M.double} ‡∏ï‡∏±‡∏ß
`))}),y.finials>0&&(b=!0,q+=`  - ‡∏´‡∏±‡∏ß‡∏£‡∏≤‡∏á (‡∏ï‡∏≤‡πÑ‡∏Å‡πà): ${y.finials} ‡∏ï‡∏±‡∏ß
`);const S=Object.keys(y.grommets);S.length>0&&S.forEach(w=>{const M=y.grommets[w];M>0&&(b=!0,q+=`  - ‡∏ï‡∏≤‡πÑ‡∏Å‡πà (‡∏™‡∏µ${w}): ${M} ‡∏ï‡∏±‡∏ß
`)}),b&&(a+=q+`
`)}u>0&&(a+=`**‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏£‡∏ß‡∏°**
`,a+=`  - ‡∏ï‡∏∞‡∏Ç‡∏≠‡∏£‡∏ß‡∏ö‡∏°‡πà‡∏≤‡∏ô: ${u} ‡∏ï‡∏±‡∏ß

`)}const _=l.decorations;Object.keys(_).length>0&&Object.entries(_).forEach(([p,y])=>{a+=`------------------------------
`,a+=`üì¶ *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ${p}*
`,a+=`------------------------------

`,y.forEach(b=>{a+=`- ‡∏£‡∏´‡∏±‡∏™: #${b.code||"xxx"}
  ‡∏Ç‡∏ô‡∏≤‡∏î: ${b.width.toFixed(2)} x ${b.height.toFixed(2)} m.
`,b.opening_style&&(a+=`  ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${b.opening_style}
`),b.adjustment_side&&(a+=`  ‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏±‡∏ö: ${b.adjustment_side}
`),a+=`
`})});const f={};if(l.wallpapers.forEach(p=>{f[p.code]=(f[p.code]||0)+p.rolls}),Object.keys(f).length>0){a+=`------------------------------
`,a+=`üé® *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Wallpaper)*
`,a+=`------------------------------

`;for(const[p,y]of Object.entries(f))a+=`  - ‡∏£‡∏´‡∏±‡∏™ #${p}: ${y} ‡∏°‡πâ‡∏ß‡∏ô
`;a+=`
`}if(t==="purchase_order")return a+=`------------------------------
`,a}if(t==="seamstress"||t==="owner"){a+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏¢‡πá‡∏ö‡∏ú‡πâ‡∏≤*
`;let l=0;if(e.rooms.forEach(m=>{if(m.is_suspended||!m.items)return;const c=m.items.filter(i=>i.type==="set"&&!i.is_suspended&&v(i.width_m)>0);c.length!==0&&(l>0&&(a+=`==============================
`),a+=`
*üö™ ‡∏´‡πâ‡∏≠‡∏á: ${m.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*

`,c.forEach((i,d)=>{d>0&&(a+=`--------------------
`),a+=`*‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà ${d+1}/${c.length}: ${i.style} ${i.fabric_variant}*
`,a+=`  - ‡∏Ç‡∏ô‡∏≤‡∏î: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${Number(i.width_m).toFixed(2)} x ‡∏™‡∏π‡∏á ${Number(i.height_m).toFixed(2)} ‡∏°.
`,a+=`  - ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${i.opening_style}
`,i.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(a+=`  - ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: #${i.fabric_code||"-"}
`),i.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(a+=`  - ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: #${i.sheer_fabric_code||"-"}
`)}),a+=`
`,l++)}),l>0?a+=`==============================
`:a+=`‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á
------------------------------
`,t==="seamstress")return a}return t==="owner"&&(a+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(o)} ‡∏ö‡∏≤‡∏ó*
`),a}function kt(e){if(!e.rooms||e.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let t="";const n={};e.rooms.forEach(a=>{a.is_suspended||!a.items||a.items.forEach(l=>{if(l.is_suspended)return;let m=null,c=0;switch(l.type){case"set":c=C.calculateSetPrice(l).total,c>0&&(m=l.type);break;case"wallpaper":c=C.calculateWallpaperPrice(l).total,c>0&&(m=l.type);break;default:c=C.calculateDecoPrice(l).total,c>0&&(m=l.type);break}m&&(n[m]=(n[m]||0)+1)})});const r=Object.entries(n).map(([a,l])=>{const m=ee[a]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";return`
            <span class="summary-tag" data-filter-type="${k(a)}" title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ">
                ${k(m)} <strong>${l}</strong>
            </span>`}).join("");r&&(t+=`
            <div class="overview-summary-group">
                <h4><i class="ph ph-stack"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h4>
                <div class="summary-tags-container">
                    ${r}
                </div>
            </div>`);let s="",o=0;return e.rooms.forEach(a=>{if(a.is_suspended||!a.items)return;const l={};let m=0;if(a.items.forEach(c=>{if(c.is_suspended)return;let i=null,d=0;switch(c.type){case"set":d=C.calculateSetPrice(c).total,d>0&&(i=c.type);break;case"wallpaper":d=C.calculateWallpaperPrice(c).total,d>0&&(i=c.type);break;default:d=C.calculateDecoPrice(c).total,d>0&&(i=c.type);break}i&&(l[i]=(l[i]||0)+1,m++)}),m>0){o+=m;const c=Object.entries(l).map(([i,d])=>`
                    <div class="overview-item">
                        <span>${k(ee[i]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á")}</span>
                        <span>${d}</span>
                    </div>`).join("");s+=`
                <details class="overview-room-card">
                    <summary class="overview-room-summary">
                        <span class="room-name">${k(a.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</span>
                        <div class="summary-tags">
                            <span class="room-item-count">${m} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                            <i class="ph ph-caret-down expand-icon"></i>
                        </div>
                    </summary>
                    <div class="overview-room-items">${c}</div>
                </details>`}}),s&&(t+=`
            <div class="overview-breakdown-group">
                <h4><i class="ph ph-map-pin-line"></i> ‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</h4>
                ${s}
            </div>`),o===0?'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>':t}function Lt(e,t){const{vatRate:n,pageBreakBuffer:r=3}=t,s=[];e.rooms.forEach(B=>{if(B.is_suspended||!B.items)return;const A=[];B.items.forEach(L=>{if(L.is_suspended)return;let I,E,R,N;const O=ee[L.type]||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";switch(L.type){case"set":E=C.calculateSetPrice(L).total,E>0&&(R=v(L.width_m),N=v(L.height_m),I=`${O} ${k(L.style)} (${k(L.fabric_variant)}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${R.toFixed(2)} x ${N.toFixed(2)} ‡∏°.${L.notes?` - ${k(L.notes)}`:""}</small>`,A.push({description:I,total:E,units:I.includes("<br>")?1.5:1}));break;case"wallpaper":if(E=C.calculateWallpaperPrice(L).total,E>0){const Y=(L.widths||[]).reduce((W,fe)=>W+v(fe),0),re=C.wallpaperRolls(Y,L.height_m);N=v(L.height_m),I=`${O} <br><small>‡∏£‡∏´‡∏±‡∏™: ${k(L.wallpaper_code)||"-"}, ‡∏™‡∏π‡∏á ${N.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${re} ‡∏°‡πâ‡∏ß‡∏ô)</small>`,A.push({description:I,total:E,units:I.includes("<br>")?1.5:1})}break;default:E=C.calculateDecoPrice(L).total,E>0&&(R=v(L.width_m),N=v(L.height_m),I=`${O} <br><small>‡∏£‡∏´‡∏±‡∏™: ${k(L.code)||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${R.toFixed(2)} x ${N.toFixed(2)} ‡∏°.</small>`,A.push({description:I,total:E,units:I.includes("<br>")?1.5:1}));break}}),A.length>0&&(s.push({isRoomHeader:!0,roomName:k(B.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),s.push(...A))});const o=s.reduce((B,A)=>B+(A.total||0),0);if(o===0)return null;let a=0,l="",m=o;e.discount&&e.discount.value>0&&(e.discount.type==="percent"?(a=o*(e.discount.value/100),l=`<tr><td class="pdf-label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (${e.discount.value}%)</td><td class="pdf-amount">-${D(a,2,!0)}</td></tr>`):(a=e.discount.value,l=`<tr><td class="pdf-label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td><td class="pdf-amount">-${D(a,2,!0)}</td></tr>`),m=o-a,l+=`<tr><td class="pdf-label">‡∏¢‡∏≠‡∏î‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td><td class="pdf-amount">${D(m,2,!0)}</td></tr>`);const c=m*n,i=m+c,d=17,u=23,h=[];let _=[],f=0;s.forEach((B,A)=>{const L=h.length===0?d:u,I=f+B.units>L;let E=!1;if(!I&&A<s.length-1){const R=L-(f+B.units);R>0&&R<r&&(E=!0)}(I||E)&&_.length>0&&(h.push(_),_=[],f=0),_.push(B),f+=B.units}),_.length>0&&h.push(_);const p=new Date,y=p.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),b=`QT-${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`;let q="",x=0,S=1;h.forEach((B,A)=>{const L=A===0,I=A===h.length-1,E=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${F.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong><i class="ph ph-github-logo"></i> ${k(F.name)}</strong><br>
                            ${k(F.address).replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${k(F.phone)} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${k(F.taxId)}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${h.length>1?L?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${b}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${y}</td></tr>
                        </table>
                    </div>
                </div>
                ${L?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${k(e.customer_name)||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${k(e.customer_address).replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${k(e.customer_phone)||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${k(F.pdf.paymentTerms)}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${k(F.pdf.priceValidity)}
                    </div>
                </section>`:""}
            </div>`,R=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span><i class="ph ph-github-logo"></i> ${k(F.name)} | ‡πÇ‡∏ó‡∏£: ${k(F.phone)}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${A+1} / ${h.length}</span>
                </div>
            </div>`;let N="";L||(N+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${D(x,2,!0)}</td></tr>`),B.forEach(W=>{W.isRoomHeader?N+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${W.roomName}</td></tr>`:(N+=`<tr><td class="pdf-text-center">${S++}</td><td>${W.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${D(W.total,2,!0)}</td><td class="pdf-text-right">${D(W.total,2,!0)}</td></tr>`,x+=W.total)});let O="";I||(O=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${D(x,2,!0)}</td></tr></tfoot>`);let Y="";F.pdf.notes&&F.pdf.notes.length>0&&(Y=`
                <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                <ul>${F.pdf.notes.map(W=>`<li>${k(W)}</li>`).join("")}</ul>
            `);const re=I?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        ${Y}
                        <div class="pdf-amount-text">( ${yt(i)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${D(o,2,!0)}</td></tr>
                            ${l}
                            ${n>0?`<tr><td class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(n*100).toFixed(0)}%</td><td class="pdf-amount">${D(c,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${D(i,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(<i class="ph ph-github-logo"></i> ${k(F.name)})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${y}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";q+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${E}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${N}</tbody>
                            ${O}
                        </table>
                        ${re}
                    </div>
                    ${R}
                </div>
            </div>`});const w=e.customer_name||"quote",M=et(w);return{html:`<div id="quotation-template">${q}</div>`,fileName:`${b}_${M}`}}function Tt(e){var l;const t=ot(e);let n=0;((l=e.discount)==null?void 0:l.value)>0&&(n=e.discount.type==="percent"?t*(e.discount.value/100):e.discount.value);const r=t-n;let s=!1,o=e.rooms.map(m=>{if(m.is_suspended)return"";const c=m.items.filter(d=>!d.is_suspended&&(v(d.width_m)>0||d.type==="wallpaper"&&(d.widths||[]).reduce((u,h)=>u+v(h),0)>0));if(c.length===0)return"";const i=c.map(d=>{let u="",h="";if(d.type!=="set"){const _=ee[d.type]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";h=`<h5 class="lookbook-item-title">${k(_)}</h5>`}switch(d.type){case"set":u=`
                        <tr><td>‡πÅ‡∏ö‡∏ö</td><td>${k(d.style)} (${k(d.fabric_variant)})</td></tr>
                        ${d.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")?`<tr><td>‡∏ó‡∏∂‡∏ö</td><td>#${k(d.fabric_code)||"-"}</td></tr>`:""}
                        ${d.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")?`<tr><td>‡πÇ‡∏õ‡∏£‡πà‡∏á</td><td>#${k(d.sheer_fabric_code)||"-"}</td></tr>`:""}
                        <tr><td>‡∏Ç‡∏ô‡∏≤‡∏î</td><td>${v(d.width_m).toFixed(2)} x ${v(d.height_m).toFixed(2)} 
                    `;break;case"wallpaper":const _=(d.widths||[]).reduce((p,y)=>p+v(y),0),f=C.wallpaperRolls(_,d.height_m);u=`
                        <tr><td>‡∏£‡∏´‡∏±‡∏™</td><td>#${k(d.wallpaper_code)||"-"}</td></tr>
                        <tr><td>‡πÉ‡∏ä‡πâ</td><td>${f} ‡∏°‡πâ‡∏ß‡∏ô</td></tr>
                        <tr><td>‡∏£‡∏ß‡∏°</td><td>${_.toFixed(2)} ‡∏°.</td></tr>
                        <tr><td>‡∏™‡∏π‡∏á</td><td>${v(d.height_m).toFixed(2)} ‡∏°.</td></tr>
                    `;break;default:u=`
                        <tr><td>‡∏£‡∏´‡∏±‡∏™</td><td>#${k(d.code)||"-"}</td></tr>
                        <tr><td>‡∏Ç‡∏ô‡∏≤‡∏î</td><td>${v(d.width_m).toFixed(2)} x ${v(d.height_m).toFixed(2)} 
                    `,d.opening_style&&(u+=`<tr><td>‡πÄ‡∏õ‡∏¥‡∏î</td><td>${k(d.opening_style)}</td></tr>`),d.adjustment_side&&(u+=`<tr><td>‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å</td><td>${k(d.adjustment_side)}</td></tr>`);break}return u&&(s=!0),`
                 <div class="lookbook-details">
                    <div class="visual-placeholder">
                        ${$t(d)}
                    </div>
                    <div class="spec-table-wrapper">
                        ${h}
                        <table class="spec-table">
                            ${u}
                        </table>
                    </div>
                </div>
            `}).join('<hr class="lookbook-hr">');return i.trim()?`
            <div class="lookbook-room">
                <h4><i class="ph ph-map-pin"></i> ${k(m.room_name)}</h4>
                ${i}
            </div>
        `:""}).join("");return s?`
        <div class="lookbook-summary">
            <div class="lookbook-customer-info">
                <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${k(e.customer_name)||"-"}<br/>
                <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${k(e.customer_address)||"-"}
            </div>
            <div class="lookbook-totals">
                <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î): ${T(t)} ‡∏ö‡∏≤‡∏ó</span>
                ${n>0?`<span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: -${T(n)} ‡∏ö‡∏≤‡∏ó</span>`:""}
                <span class="grand-total">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${T(r)} ‡∏ö‡∏≤‡∏ó</span>
            </div>
        </div>
    `+o:'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>'}const ce=[],Mt=10;function te(e){ce.push(e),ce.length>Mt&&ce.shift()}function Bt(){return ce.pop()}function Ct(){return ce.length>0}let J=!1,Se=null,H=null,he=null,ie=!1,U=null,Le=null,Te=!1,ne=null;const Xe=document.querySelector("#undoBtn"),ye={};function It(e){if(ye[e])return ye[e];const t=new Promise((n,r)=>{const s=document.createElement("script");s.src=e,s.onload=()=>{console.log(`${e} loaded successfully.`),n()},s.onerror=()=>{console.error(`Script load error for ${e}`),delete ye[e],r(new Error(`Script load error for ${e}`))},document.head.appendChild(s)});return ye[e]=t,t}const de={set:{templateId:"#setTpl",name:"‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô"},wallpaper:{templateId:"#wallpaperTpl",name:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå"},wooden_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ"},roller_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô"},vertical_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á"},partition:{templateId:"#areaBasedTpl",name:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á"},pleated_screen:{templateId:"#areaBasedTpl",name:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö"},aluminum_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°"}},Et={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"wooden_blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"roller_blind",‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"vertical_blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"pleated_screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"aluminum_blind"},Ie="marnthara.theme";function nt(){const e=localStorage.getItem(Ie),t=document.querySelector("#themeToggleBtn");if(!t)return;const n=t.querySelector("i"),r=t.querySelector("span");switch(document.body.classList.remove("dark-theme","neutral-theme"),e){case"dark":document.body.classList.add("dark-theme"),n&&(n.className="ph-fill ph-sun"),r&&(r.textContent=" ‡∏™‡∏ß‡πà‡∏≤‡∏á");break;case"neutral":document.body.classList.add("neutral-theme"),n&&(n.className="ph-fill ph-moon"),r&&(r.textContent=" ‡∏°‡∏∑‡∏î");break;default:n&&(n.className="ph-fill ph-palette"),r&&(r.textContent=" ‡∏Å‡∏•‡∏≤‡∏á");break}}function At(){const e=localStorage.getItem(Ie);let t;!e||e==="light"?t="neutral":e==="neutral"?t="dark":t="light",localStorage.setItem(Ie,t),nt()}function Q(){Xe&&(Xe.disabled=!Ct())}function Nt(){const e=Bt();e&&(Ne(e,!1),$("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß","success")),Q()}function Me(){ne="suspended";const e=document.getElementById("filterStatusBar");let t=0;if(document.querySelectorAll(".room-card").forEach(n=>{let r=!1;n.querySelectorAll(".item-card").forEach(s=>{const o=s.classList.contains("is-suspended")||n.classList.contains("is-suspended");s.classList.toggle("item-hidden",!o),o&&(r=!0,t++)}),n.classList.toggle("item-hidden",!r)}),t===0){st(),$("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß","success");return}e&&(e.innerHTML=`
            <span><i class="ph ph-warning"></i> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö (${t} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</span>
            <button type="button" class="btn-chip" data-act="clear-filter" title="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
                <i class="ph ph-x"></i>&nbsp;‡∏õ‡∏¥‡∏î
            </button>
        `,e.classList.add("is-visible"),e.dataset.filterType="suspended"),z(),K(),$e()}function Pt(e,t){if(!e)return;ne=e;const n=document.getElementById("filterStatusBar");let r=0;document.querySelectorAll(g.room).forEach(s=>{let o=0;s.querySelectorAll(".item-card").forEach(a=>{const l=a.dataset.type===e;a.classList.toggle("item-hidden",!l),l&&o++}),s.classList.toggle("item-hidden",o===0),r+=o}),n&&(n.innerHTML=`
            <span>‡πÄ‡∏â‡∏û‡∏≤‡∏∞: <strong>${k(t)}</strong> (${r} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</span>
            <button type="button" class="btn-chip" data-act="clear-filter" title="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
                <i class="ph ph-x"></i>&nbsp;‡∏õ‡∏¥‡∏î
            </button>
        `,n.classList.add("is-visible"),n.dataset.filterType=e),z(),K(),$e()}function st(){ne=null;const e=document.getElementById("filterStatusBar");e&&(e.classList.remove("is-visible"),e.innerHTML="",e.removeAttribute("data-filter-type")),document.querySelectorAll(".item-hidden").forEach(t=>t.classList.remove("item-hidden")),z(),K(),$e()}function Ft(e){const t=e.target.closest(".item-card");document.querySelectorAll(".item-details-more.show").forEach(n=>{const r=n.closest(".item-card");r!==t&&Oe(r,!1)})}function Ee(e){if(!e)return;const t=document.querySelector(".main-header"),n=document.querySelector(".summary-footer"),r=t?t.offsetHeight+16:80,s=n?n.offsetHeight+16:100,o=e.getBoundingClientRect();if(!(o.top>=r&&o.bottom<=window.innerHeight-s)){const l=window.innerHeight-r-s,m=o.height>l?"start":"center";e.scrollIntoView({behavior:"smooth",block:m})}}function qe(){document.querySelectorAll(".favorite-chips-container.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll(".item-card.overflow-visible").forEach(e=>{e.classList.remove("overflow-visible")})}function at(e){var m;const t=e.dataset.favoriteType,n=(m=e.closest(".form-group-with-favorites"))==null?void 0:m.querySelector(".favorite-chips-container");if(!t||!n)return;qe();const r=e.closest(".item-card"),o=X()[t]||[];let l=Array.from(o.reduce((c,i)=>{const d=i.code.trim();return d&&!c.has(d.toLowerCase())&&c.set(d.toLowerCase(),i),c},new Map).values()).map(c=>`<button type="button" class="btn-chip" data-code="${k(c.code)}" data-price="${c.price}">${k(c.code)}</button>`).join("");l+=`<button type="button" class="btn-manage-favorites" data-act="manage-favorites" data-type="${t}"><i class="ph ph-pencil-simple"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î</button>`,n.innerHTML=l,n.classList.add("show"),r&&r.classList.add("overflow-visible")}function Rt(e){const t=e.closest(".form-group-with-favorites"),n=e.closest(".item-card");if(!t||!n)return;const r=e.dataset.code,s=v(e.dataset.price),o=t.querySelector("input[data-favorite-type]");o&&(o.value=r,o.classList.add("input-highlight"),setTimeout(()=>o.classList.remove("input-highlight"),1200));const a=o.dataset.favoriteType;let l;a==="fabric"?l="set_price_per_m":a==="sheer"?l="sheer_price_per_m":a==="wallpaper"?l="wallpaper_price_roll":l="area_price_sqyd";const m=n.querySelector(`[name="${l}"]`);m&&s>0&&(m.tagName==="SELECT"?m.value=s:m.value=T(s),m.classList.add("input-highlight"),setTimeout(()=>m.classList.remove("input-highlight"),1200)),oe(o),se(n),P(),qe()}function ge(e){const t=document.querySelector("#favManagerBody"),n=document.querySelector("#favManagerItemTpl"),s=X()[e]||[];!t||!n||(s.length===0?t.innerHTML='<p class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</p>':t.innerHTML=s.map(o=>n.innerHTML.replace(/{CODE}/g,k(o.code)).replace(/{PRICE}/g,T(o.price)).replace(/{RAW_PRICE}/g,o.price)).join(""),Ae(null))}function Ae(e){const t=document.querySelector('[data-act="edit-selected-fav"]'),n=document.querySelector('[data-act="del-selected-fav"]');!t||!n||(e?(t.disabled=!1,n.disabled=!1,U={code:e.dataset.code,price:v(e.dataset.price)}):(t.disabled=!0,n.disabled=!0,U=null))}async function Ot(e){const t=document.querySelector("#favManagerModal");if(!t||!e)return;const n={fabric:"‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö",sheer:"‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á",wallpaper:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå",wooden_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ",roller_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô",vertical_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á",partition:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á",pleated_screen:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö",aluminum_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°",deco:"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"};t.dataset.currentType=e,ie=!1,U=null,document.querySelector("#favManagerTitle").textContent=`‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ '${n[e]||e}'`,ge(e),await V("#favManagerModal",()=>{ie&&Se&&at(Se)})}function $(e,t="default"){const n=document.querySelector(g.toastContainer);if(!n)return;const r={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},s=document.createElement("div");s.className=`toast toast-${t}`,s.innerHTML=`<i class="${r[t]||r.default}"></i> ${e}`,n.appendChild(s),setTimeout(()=>s.classList.add("show"),10),setTimeout(()=>{s.classList.remove("show"),s.addEventListener("transitionend",()=>s.remove())},3e3)}function V(e,t){return new Promise(n=>{const r=document.querySelector(e);if(!r){n(null);return}const s=document.querySelector(".modal-wrapper.visible");s&&s.classList.add("is-underlay"),r.classList.add("visible");const o=r.querySelector('[id$="Confirm"]'),a=r.querySelector('[id$="Cancel"], [data-act="close-modal"]'),l=Array.from(r.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(u=>!u.disabled&&u.offsetParent!==null),m=l[0],c=l[l.length-1];setTimeout(()=>m==null?void 0:m.focus(),50);const i=u=>{if(u.key==="Escape"&&!r.classList.contains("is-underlay")){d({cancelled:!0});return}if(u.key==="Tab"){if(l.length<=1){u.preventDefault();return}u.shiftKey?document.activeElement===m&&(c.focus(),u.preventDefault()):document.activeElement===c&&(m.focus(),u.preventDefault())}},d=u=>{r.classList.remove("visible"),document.removeEventListener("keydown",i),o&&(o.onclick=null),a&&(a.onclick=null),s&&s.classList.remove("is-underlay"),typeof u=="object"&&u.cancelled&&t&&t(),n(u)};o&&(o.onclick=()=>d(!0)),a&&(a.onclick=()=>{r.classList.contains("is-underlay")||d({cancelled:!0})}),document.addEventListener("keydown",i)})}async function ue(e,t){const n=document.querySelector(g.modal);return n?(n.querySelector(g.modalTitle).textContent=e,n.querySelector(g.modalBody).textContent=t,await V(g.modal)===!0):!0}async function Ht(){var n,r,s;const e=document.querySelector(g.exportOptionsModal);if(!e)return null;const t=await V(g.exportOptionsModal);return!t||t.cancelled?null:{vatOption:((n=e.querySelector('input[name="vat_option"]:checked'))==null?void 0:n.value)||"include",exportMethod:((r=e.querySelector("#exportMethod"))==null?void 0:r.value)||"direct",pageBreakBuffer:parseInt((s=e.querySelector("#pageBreakBuffer"))==null?void 0:s.value,10)||3}}async function jt(){const e=document.querySelector("#discountModal");if(!e)return;const t=e.querySelector("#discountSubtotal"),n=e.querySelector("#discountPercent"),r=e.querySelector("#discountAmount"),s=e.querySelector("#discountFinalTotal"),o=document.querySelector("#discount_type"),a=document.querySelector("#discount_value"),l=v(document.querySelector("#originalTotal").dataset.rawTotal||document.querySelector("#grandTotal").textContent);t.textContent=T(l);const m=u=>{if(Te)return;Te=!0;let h=0;if(u==="percent"){const _=v(n.value);h=l*((_>=0?_:0)/100),r.value=h>0?T(Math.round(h)):""}else h=v(r.value);if(h=h>=0?Math.min(h,l):0,u!=="percent"){const _=l>0?h/l*100:0;n.value=_>0&&isFinite(_)?D(_,2):""}s.textContent=T(l-h),setTimeout(()=>{Te=!1},20)};n.addEventListener("input",()=>m("percent")),r.addEventListener("input",()=>m("amount")),r.addEventListener("focus",u=>{v(u.target.value)>0&&(u.target.value=v(u.target.value))}),r.addEventListener("blur",u=>{v(u.target.value)>0&&(u.target.value=T(v(u.target.value))),m("amount")});const c=o.value,i=v(a.value);n.value="",r.value="",i>0?c==="percent"?(n.value=i,m("percent")):(r.value=T(i),m("amount")):m();const d=await V("#discountModal");if(d&&!d.cancelled){const u=v(n.value),h=v(r.value);document.activeElement===n&&u>0?(o.value="percent",a.value=u):h>0?(o.value="amount",a.value=h):(o.value="amount",a.value=0),G(),P()}}async function Wt(){var r,s,o,a,l;if(!H)return;const e=document.querySelector("#hardwareModal"),t=((r=H.querySelector('[name="set_style"]'))==null?void 0:r.value)==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà";e.querySelector('[name="modal_track_color"]').value=((s=H.querySelector('[name="track_color"]'))==null?void 0:s.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_bracket_color"]').value=((o=H.querySelector('[name="bracket_color"]'))==null?void 0:o.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_finial_color"]').value=((a=H.querySelector('[name="finial_color"]'))==null?void 0:a.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_grommet_color"]').value=((l=H.querySelector('[name="grommet_color"]'))==null?void 0:l.value)||"‡πÄ‡∏á‡∏¥‡∏ô",e.querySelector("#grommetColorGroup").style.display=t?"":"none";const n=await V("#hardwareModal");n&&!n.cancelled&&(H.querySelector('[name="track_color"]').value=e.querySelector('[name="modal_track_color"]').value,H.querySelector('[name="bracket_color"]').value=e.querySelector('[name="modal_bracket_color"]').value,H.querySelector('[name="finial_color"]').value=e.querySelector('[name="modal_finial_color"]').value,t&&(H.querySelector('[name="grommet_color"]').value=e.querySelector('[name="modal_grommet_color"]').value),P(),$("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß","success")),H=null}function Be(e,t,n){e&&(te(j()),Q(),e.classList.add("item-removing"),e.addEventListener("animationend",()=>{e.remove(),t&&$(t),n&&n(),me(),z(),G(),P(),pe()},{once:!0}))}function z(){document.querySelectorAll(g.room).forEach(e=>{const t=e.querySelectorAll(".item-card:not(.is-suspended):not(.item-hidden)"),n=t.length;t.forEach((s,o)=>{const a=s.querySelector("[data-item-title]");a&&(a.textContent=`${o+1}/${n}`)}),e.querySelectorAll(".item-card.is-suspended, .item-card.item-hidden").forEach(s=>{const o=s.querySelector("[data-item-title]");o&&(o.textContent="-")})})}function lt(){const e=document.querySelector(g.orderForm),t=document.querySelector(g.lockBtn);!e||!t||(e.classList.toggle("is-locked",J),t.classList.toggle("is-locked",J),t.querySelector("i").className=J?"ph-bold ph-lock-key":"ph ph-paw-print",e.querySelectorAll("input, select, textarea, button").forEach(n=>{n.closest(".summary-footer")||n.closest(".main-header")||n.closest(".modal-wrapper")||n.dataset.act==="toggle-more-details"||n.dataset.act==="collapse-room"||(n.disabled=J)}),$(J?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",J?"warning":"success"))}function K(){const e=document.querySelectorAll(g.room);if(e.length===0)return;const t=[...e].some(r=>r.open),n=document.querySelector(g.toggleAllRoomsBtn);n&&(n.querySelector("i").className="ph ph-rows",n.querySelector("span").textContent=t?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}function Dt(){var r;const e=document.querySelectorAll(g.room),t=[...e].some(s=>s.open);e.forEach(s=>{s.open=!t});const n=document.querySelector(g.quickNavDropdown);n&&n.classList.contains("show")&&(n.classList.remove("show"),(r=document.querySelector(g.quickNavBtn))==null||r.setAttribute("aria-expanded","false")),setTimeout(()=>{K(),P()},50)}function me(){const e=document.querySelector(g.quickNavRoomList);e&&(e.innerHTML="",document.querySelectorAll(g.room).forEach(t=>{var s;const n=((s=t.querySelector(g.roomNameInput))==null?void 0:s.value)||"‡∏´‡πâ‡∏≠‡∏á",r=document.createElement("a");r.href=`#${t.id}`,r.dataset.jumpTo=t.id,r.innerHTML=`<i class="ph ph-share-fat"></i> ${n}`,e.appendChild(r)}))}function ct(e){var n;const t=document.getElementById("quickNavBtnText");t&&(e?t.textContent=((n=e.querySelector('input[name="room_name"]'))==null?void 0:n.value)||"...":t.textContent="‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á")}function pe(){if(he&&he.disconnect(),!document.getElementById("quickNavBtnText"))return;const e={root:null,rootMargin:"-60px 0px -150px 0px",threshold:0},t=n=>{const r=n.filter(s=>s.isIntersecting).sort((s,o)=>s.target.getBoundingClientRect().top-o.target.getBoundingClientRect().top);r.length>0&&ct(r[0].target)};he=new IntersectionObserver(t,e),document.querySelectorAll(g.room).forEach(n=>he.observe(n))}function oe(e){if(!e)return;const t=e.closest(".form-group-with-favorites").querySelector(".btn-favorite");if(!t)return;const n=e.dataset.favoriteType,r=e.value;t.classList.toggle("is-favorite",_t(n,r))}function Oe(e,t=null){if(!e)return;const n=e.querySelector(".item-details-more"),r=e.querySelector('[data-act="toggle-more-details"]'),s=r==null?void 0:r.parentElement;if(!n||!r||!s)return;const o=n.classList.contains("show"),a=t!==null?t:!o;if(o===a)return;n.classList.toggle("show",a),r.classList.toggle("expanded",a);const l=r.querySelector("i");l&&(l.className=a?"ph ph-caret-up":"ph ph-caret-down");const m=r.querySelector("span");if(m&&(m.textContent=a?"‡∏¢‡πà‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á":"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°"),a)n.appendChild(s),Ee(e);else{const c=e.querySelector(".item-grid");c&&c.appendChild(s)}}function He(e,t){var l;const n=de[e];if(!n)return null;const r=document.querySelector(n.templateId);if(!r||!t)return null;const s=r.content.cloneNode(!0),o=s.firstElementChild;o.dataset.type=e,o.classList.add(`${e.replace(/_/g,"-")}-item`);const a=o.querySelector(".item-type-display");if(a&&(a.textContent=n.name),n.templateId==="#areaBasedTpl"){const m=o.querySelector("input[data-favorite-type]"),c=o.querySelector(".btn-favorite");m&&(m.dataset.favoriteType=e),c&&(c.dataset.type=e);const i=o.querySelector(".item-details-more .item-grid"),d=(l=i==null?void 0:i.querySelector('input[name="area_price_sqyd"]'))==null?void 0:l.closest(".form-group");if(i&&d){let u=null;e==="partition"||e==="pleated_screen"?(u=document.createElement("div"),u.className="form-group",u.innerHTML=`
                    <label>‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î
                        <select name="opening_style">
                            <option value="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á">‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á</option>
                            <option value="‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß">‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</option>
                        </select>
                    </label>
                `):["wooden_blind","roller_blind","vertical_blind","aluminum_blind"].includes(e)&&(u=document.createElement("div"),u.className="form-group",u.innerHTML=`
                    <label>‡πÄ‡∏ä‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏±‡∏ö
                        <select name="adjustment_side">
                            <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤">‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤</option>
                            <option value="‡∏õ‡∏£‡∏±‡∏ö‡∏ã‡πâ‡∏≤‡∏¢">‡∏õ‡∏£‡∏±‡∏ö‡∏ã‡πâ‡∏≤‡∏¢</option>
                        </select>
                    </label>
                `),u&&(d.classList.remove("full-width-item"),d.parentNode.insertBefore(u,d))}}return t.appendChild(s),o}function Ut(e,t){var s;if(!t)return;const n=t.querySelector(g.allItemsContainer);if(!n)return;te(j()),Q(),qe();const r=He(e,n);if(r){if(e==="wallpaper"){const o=je(r.querySelector('[data-act="add-wall"]'));o&&((s=o.querySelector("input"))==null||s.focus())}else{const o=r.querySelector('input:not([type="hidden"]), select, textarea');o&&o.focus()}r.classList.add("item-created"),r.scrollIntoView({behavior:"smooth",block:"center"}),z(),G(),P()}}async function ze(e,t=null){const n=document.querySelector("#itemTypeModal");if(!n)return null;n.querySelector("#itemTypeModalTitle").textContent=e;let r=t;t&&!de[t]&&(r="wooden_blind");const s=n.querySelector(`input[name="item_type_option"][value="${r||"set"}"]`);s&&(s.checked=!0);const o=await V("#itemTypeModal");if(!o||o.cancelled)return null;const a=n.querySelector('input[name="item_type_option"]:checked');return a?a.value:null}function Vt(e,t){if(!de[t])return;const r=e.parentElement;r&&(te(j()),Q(),e.classList.add("item-removing"),e.addEventListener("animationend",()=>{var o;const s=He(t,r);s&&(e.replaceWith(s),s.classList.add("item-created"),s.scrollIntoView({behavior:"smooth",block:"center"}),(o=s.querySelector('input:not([type="hidden"]), select, textarea'))==null||o.focus(),z(),G(),P(),$("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))},{once:!0}))}function le(){te(j()),Q();const e=document.querySelector(g.roomsContainer);if(!e)return;const t=document.querySelector("#roomTpl");if(!t)return;const n=Array.from(document.querySelectorAll(g.roomNameInput)).map(m=>parseInt(m.value.replace(/[^0-9]/g,""),10)).filter(m=>!isNaN(m)),o=`‡∏´‡πâ‡∏≠‡∏á ${(n.length>0?Math.max(...n):0)+1}`,l=t.content.cloneNode(!0).firstElementChild;if(l){l.id=`room-${Date.now()}`;const m=l.querySelector('input[name="room_name"]'),c=l.querySelector(".room-header-controls .form-group > label");if(m&&c){const d=`room_name_${l.id}`;m.id=d,c.setAttribute("for",d)}m&&(m.value=o);const i=l.querySelector("[data-room-name-display]");i&&(i.textContent=o),l.open=!0,e.appendChild(l),l.classList.add("item-created"),l.scrollIntoView({behavior:"smooth",block:"center"})}me(),K(),pe(),P()}function je(e){var n;const t=(n=e==null?void 0:e.closest(".walls-section"))==null?void 0:n.querySelector(g.wallsContainer);if(t){const r=document.querySelector(g.wallTpl);if(!r)return null;const s=r.content.cloneNode(!0),o=s.querySelector(".wall-input-row");if(!o)return null;const a=o.querySelector("input"),l=o.querySelector("label");if(a&&l){const m=`wall-input-${Date.now()}-${Math.random().toString(36).substring(2,7)}`;a.id=m,l.setAttribute("for",m)}return t.appendChild(s),requestAnimationFrame(()=>{o.classList.add("item-created")}),se(e),o}return null}function se(e){var a,l,m,c,i,d,u,h,_,f,p,y;if(!e)return;const t=e.closest(".item-card");if(!t){G();return}const n=t.dataset.type;let r,s,o;switch(n){case"set":r=t.querySelector("[data-set-summary]"),s={width_m:(a=t.querySelector('input[name="width_m"]'))==null?void 0:a.value,height_m:(l=t.querySelector('input[name="height_m"]'))==null?void 0:l.value,style:(m=t.querySelector('select[name="set_style"]'))==null?void 0:m.value,fabric_variant:(c=t.querySelector('select[name="fabric_variant"]'))==null?void 0:c.value,price_per_m_raw:(i=t.querySelector('select[name="set_price_per_m"]'))==null?void 0:i.value,sheer_price_per_m:(d=t.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:d.value},o=C.calculateSetPrice(s),t.dataset.totalPrice=o.total;let b=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(o.total)}</b> ‡∏ö.`;o.opaque>0&&o.sheer>0&&(b+=` <small>(‡∏ó‡∏∂‡∏ö: ${T(o.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${T(o.sheer)})</small>`),r&&(r.innerHTML=b);break;case"wallpaper":r=t.querySelector("[data-wallpaper-summary]"),s={height_m:(u=t.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:u.value,price_per_roll:(h=t.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:h.value,install_cost_per_roll:(_=t.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:_.value,widths:Array.from(t.querySelectorAll('input[name="wall_width_m"]')).map(S=>S.value)},o=C.calculateWallpaperPrice(s),t.dataset.totalPrice=o.total;let q=`‡∏£‡∏ß‡∏°: <b>${T(o.total)}</b> ‡∏ö. `;(o.material>0||o.install>0)&&(q+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${T(o.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${T(o.install)})</small>`),o.rolls>0&&(q+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${D(o.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${o.rolls} ‡∏°‡πâ‡∏ß‡∏ô`),r&&(r.innerHTML=q);break;default:r=t.querySelector("[data-area-summary]"),s={width_m:(f=t.querySelector('input[name="area_width_m"]'))==null?void 0:f.value,height_m:(p=t.querySelector('input[name="area_height_m"]'))==null?void 0:p.value,price_sqyd:(y=t.querySelector('input[name="area_price_sqyd"]'))==null?void 0:y.value},o=C.calculateDecoPrice(s),t.dataset.totalPrice=o.total;let x="";o.sqyd>0&&(x=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${D(o.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`),r&&(r.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(o.total)}</b> ‡∏ö.${x}`);break}G()}function $e(){const e=document.getElementById("suspendedItemsBtn");if(!e)return;if(ne){e.classList.remove("is-visible");return}const t=document.getElementById("suspendedCountBadge"),n=document.querySelectorAll(".item-card.is-suspended").length,r=document.querySelectorAll(".room-card.is-suspended");let s=0;r.forEach(a=>{s+=a.querySelectorAll(".item-card:not(.is-suspended)").length});const o=n+s;o>0?(t&&(t.textContent=o),e.classList.add("is-visible")):e.classList.remove("is-visible")}function G(){let e=0;document.querySelectorAll(g.room).forEach(a=>{let l=0,m=0;const c=a.classList.contains("is-suspended");a.querySelectorAll(".item-card").forEach(d=>{const u=v(d.dataset.totalPrice),h=d.classList.contains("is-suspended");!c&&!h&&(l+=u,u>0&&m++)});const i=a.querySelector("[data-room-brief]");i&&(c?i.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":m>0?i.innerHTML=`<span>${m}</span> &bull; ${T(l)} ‡∏ö‡∏≤‡∏ó`:i.innerHTML="<span>0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"),c||(e+=l)});const t=document.querySelector("#discount_type").value,n=v(document.querySelector("#discount_value").value);let r=0;n>0&&(r=t==="percent"?e*(n/100):n);const s=e-r;document.querySelector("#grandTotal").textContent=T(s);const o=document.querySelector("#originalTotal");r>0?(o.textContent=T(e),o.dataset.rawTotal=e,o.style.display="block"):(o.style.display="none",o.dataset.rawTotal=""),$e()}async function Ne(e,t=!1){if(e!=null&&e.favorites)if(t){const o=document.querySelector("#favoritesConflictModal");if(o){const a=await V("#favoritesConflictModal");if(!a||a.cancelled){$("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤","warning");return}switch(o.querySelector('input[name="fav_conflict_option"]:checked').value){case"overwrite":Ye(e.favorites)&&$("‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success");break;case"merge":const m=tt(e.favorites);$(`‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏û‡∏¥‡πà‡∏° ${m} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà)`,"success");break}}}else Ye(e.favorites);if(!(e!=null&&e.rooms)||!Array.isArray(e.rooms)){e.favorites||$("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå","error");return}const n=document.querySelector(g.roomsContainer);if(!n)return;n.innerHTML="",document.querySelector("#customer_name").value=e.customer_name||"",document.querySelector("#customer_phone").value=e.customer_phone||"",document.querySelector("#customer_address").value=e.customer_address||"",e.discount&&(document.querySelector("#discount_type").value=e.discount.type||"amount",document.querySelector("#discount_value").value=e.discount.value||0),document.querySelector("#customerDetailsCard").open=e.customer_card_open??!0;let r=0;const s=()=>{if(r>=e.rooms.length){document.querySelectorAll("input[data-favorite-type]").forEach(oe),G(),z(),me(),K(),pe(),t&&$("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success");return}const o=e.rooms[r],a=document.querySelector("#roomTpl");if(!a){console.error("Room template not found.");return}const m=a.content.cloneNode(!0).firstElementChild;if(n.appendChild(m),m){m.id=o.id||`room-${Date.now()}`,o.is_suspended&&m.classList.add("is-suspended"),m.open=o.is_open===!0;const c=o.room_name||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)",i=m.querySelector('input[name="room_name"]'),d=m.querySelector(".room-header-controls .form-group > label");if(i&&d){const _=`room_name_${m.id}`;i.id=_,d.setAttribute("for",_)}i&&(i.value=c);const u=m.querySelector("[data-room-name-display]");u&&(u.textContent=c);const h=m.querySelector(g.allItemsContainer);if(h&&o.items){const _=document.createDocumentFragment();o.items.forEach(f=>{var y,b,q;f.type==="deco"&&f.deco_type?(f.type=Et[f.deco_type]||"wooden_blind",f.code=f.deco_code,f.width_m=f.deco_width_m,f.height_m=f.deco_height_m,f.price_sqyd=f.deco_price_sqyd,f.notes=f.deco_notes):f.type==="deco"&&(f.type="wooden_blind",f.code=f.deco_code);const p=He(f.type,_);if(p){switch(f.is_suspended&&p.classList.add("is-suspended"),f.type){case"set":p.querySelector('input[name="width_m"]').value=Z(f.width_m),p.querySelector('input[name="height_m"]').value=Z(f.height_m);const x=p.querySelector('select[name="fabric_variant"]');x.value=f.fabric_variant||"‡∏ó‡∏∂‡∏ö",p.querySelector('select[name="set_style"]').value=f.style||f.set_style||"‡∏•‡∏≠‡∏ô",p.querySelector('select[name="set_price_per_m"]').value=f.price_per_m_raw||f.set_price_per_m||"",p.querySelector('select[name="sheer_price_per_m"]').value=f.sheer_price_per_m||"",p.querySelector('select[name="opening_style"]').value=f.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á",p.querySelector('input[name="track_color"]').value=f.track_color||"‡∏Ç‡∏≤‡∏ß",p.querySelector('input[name="bracket_color"]').value=f.bracket_color||"‡∏Ç‡∏≤‡∏ß",p.querySelector('input[name="finial_color"]').value=f.finial_color||"‡∏Ç‡∏≤‡∏ß",p.querySelector('input[name="grommet_color"]').value=f.grommet_color||"‡πÄ‡∏á‡∏¥‡∏ô",p.querySelector('input[name="fabric_code"]').value=f.fabric_code||"",p.querySelector('input[name="sheer_fabric_code"]').value=f.sheer_fabric_code||"",p.querySelector('input[name="notes"]').value=f.notes||"";const S=x.value,w=S==null?void 0:S.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á"),M=S==="‡πÇ‡∏õ‡∏£‡πà‡∏á",B=S==="‡∏ó‡∏∂‡∏ö";(y=p.querySelector(g.sheerWrap))==null||y.classList.toggle("hidden",!w),(b=p.querySelector(g.sheerCodeWrap))==null||b.classList.toggle("hidden",!w);const A=p.querySelector('select[name="set_price_per_m"]'),L=p.querySelector('input[name="fabric_code"]');A&&(A.disabled=M),L&&(L.disabled=M);const I=p.querySelector('select[name="sheer_price_per_m"]'),E=p.querySelector('input[name="sheer_fabric_code"]');I&&(I.disabled=B),E&&(E.disabled=B);break;case"wallpaper":p.querySelector('input[name="wallpaper_height_m"]').value=Z(f.height_m||f.wallpaper_height_m),p.querySelector('input[name="wallpaper_code"]').value=f.wallpaper_code||"";const R=v(f.price_per_roll||f.wallpaper_price_roll);p.querySelector('input[name="wallpaper_price_roll"]').value=R>0?T(R):"",p.querySelector('input[name="wallpaper_install_cost"]').value=f.hasOwnProperty("install_cost_per_roll")?T(f.install_cost_per_roll):f.wallpaper_install_cost?T(f.wallpaper_install_cost):"300",p.querySelector('input[name="wallpaper_notes"]').value=f.notes||f.wallpaper_notes||"",f.widths&&f.widths.forEach(N=>{const O=je(p.querySelector('[data-act="add-wall"]'));O&&(O.querySelector('input[name="wall_width_m"]').value=Z(N))});break;default:if(((q=de[f.type])==null?void 0:q.templateId)==="#areaBasedTpl"){p.querySelector('input[name="area_width_m"]').value=Z(f.width_m),p.querySelector('input[name="area_height_m"]').value=Z(f.height_m);const N=v(f.price_sqyd);p.querySelector('input[name="area_price_sqyd"]').value=N>0?T(N):"",p.querySelector('input[name="area_code"]').value=f.code||"",p.querySelector('input[name="area_notes"]').value=f.notes||"";const O=p.querySelector('select[name="opening_style"]');O&&(O.value=f.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á");const Y=p.querySelector('select[name="adjustment_side"]');Y&&(Y.value=f.adjustment_side||"‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ß‡∏≤")}break}se(p)}}),h.appendChild(_)}}r++,requestAnimationFrame(s)};requestAnimationFrame(s)}function Gt(e){if(document.getElementById("loading-overlay"))return;const t=document.createElement("div");t.id="loading-overlay",t.innerHTML=`<div class="loading-spinner"></div><p>${e}</p>`,document.body.appendChild(t),document.body.style.overflow="hidden"}function Yt(){const e=document.getElementById("loading-overlay");e&&e.remove(),document.body.style.overflow=""}async function Jt(e,t){var r,s;const n=document.querySelector(g.printableContent);if(!n||!e||!e.html){$("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","error");return}if(t==="direct"){Gt("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...");let o;try{typeof html2pdf>"u"&&($("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF...","default"),await It("https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js")),o=document.createElement("div"),o.style.position="fixed",o.style.left="-300mm",o.style.top="0",o.style.width="210mm",o.style.background="#fff",o.innerHTML=e.html,document.body.appendChild(o),await new Promise(l=>setTimeout(l,500));const a={margin:0,filename:`${e.fileName}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1,width:((r=o.querySelector(".pdf-page"))==null?void 0:r.scrollWidth)||210*3.77,windowWidth:((s=o.querySelector(".pdf-page"))==null?void 0:s.scrollWidth)||210*3.77},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await window.html2pdf().from(o).set(a).save(),$("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch(a){console.error("PDF Generation Error:",a),$("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß, ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 (‡∏û‡∏¥‡∏°‡∏û‡πå)","error")}finally{Yt(),o&&document.body.contains(o)&&document.body.removeChild(o)}}t==="print"&&(n.innerHTML=e.html,setTimeout(()=>{window.print(),setTimeout(()=>{n.innerHTML=""},1e3)},mt))}function Kt(e){if(!e||!e.html){$("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML","error");return}try{const t=`
            <!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${e.fileName}</title>
                <link rel="stylesheet" href="https://grobmak.github.io/marnthara-form/src/style.css">
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/bold/style.css">
                <style>#printable-content { display: block !important; } .pdf-page { border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: 10mm auto; } i.ph { vertical-align: middle; }</style>
            </head>
            <body>${e.html}</body></html>`,n=new Blob([t],{type:"text/html;charset=utf-8"}),r=URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download=`${e.fileName}.html`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),$("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch(t){console.error("HTML Export Error:",t),$("‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}function Qt(e){if(!e)return;const t=e.closest(".item-card");if(!t)return;const n=v(e.value);let r,s;const o=e.getAttribute("name");if(o==="set_price_per_m"?(r=t.querySelector('input[name="fabric_code"]'),s="fabric"):o==="sheer_price_per_m"?(r=t.querySelector('input[name="sheer_fabric_code"]'),s="sheer"):o==="wallpaper_price_roll"?(r=t.querySelector('input[name="wallpaper_code"]'),s="wallpaper"):o==="area_price_sqyd"&&(r=t.querySelector('input[name="area_code"]'),r&&(s=r.dataset.favoriteType)),r&&s&&r.value.trim()){const a=Fe(s,r.value);a&&a.price!==n&&(r.value="",oe(r))}}const Xt=ft(e=>{e.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_price_per_m"]')&&Qt(e),se(e),P()},200);function Ze(e){var n,r;if(J){e.preventDefault();return}const t=e.target;if(t.matches('select[name="fabric_variant"]')){const s=t.closest(".set-item");if(s){const o=t.value,a=o==null?void 0:o.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");o==null||o.includes("‡∏ó‡∏∂‡∏ö");const l=o==="‡πÇ‡∏õ‡∏£‡πà‡∏á",m=o==="‡∏ó‡∏∂‡∏ö";(n=s.querySelector(g.sheerWrap))==null||n.classList.toggle("hidden",!a),(r=s.querySelector(g.sheerCodeWrap))==null||r.classList.toggle("hidden",!a);const c=s.querySelector('select[name="set_price_per_m"]'),i=s.querySelector('input[name="fabric_code"]'),d=s.querySelector('select[name="sheer_price_per_m"]'),u=s.querySelector('input[name="sheer_fabric_code"]');c&&(c.disabled=l),i&&(i.disabled=l),l&&(c&&(c.value=""),i&&(i.value="",oe(i))),d&&(d.disabled=m),u&&(u.disabled=m),m&&(d&&(d.value=""),u&&(u.value="",oe(u)))}}if(t.matches(g.roomNameInput)){const s=t.closest(".room-card");if(s){const o=s.querySelector("[data-room-name-display]");o&&(o.textContent=t.value||"‡∏´‡πâ‡∏≠‡∏á")}me(),pe()}t.matches("input[data-favorite-type]")&&oe(t),Xt(t)}function zt(e){const t=e.target;t.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_install_cost"]')?t.value=v(t.value)>0?T(v(t.value)):"":t.matches('input[name$="_m"], input[name$="width_m"]')&&(t.value=Z(t.value))}function Zt(e){const t=e.target;t.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_install_cost"]')&&v(t.value)>0&&(t.value=v(t.value)),t.matches("input[data-favorite-type]")&&(Se=t,at(t))}const er=async e=>{var i,d,u;const t=e.target.closest(".summary-tag[data-filter-type]");if(t){const h=t.dataset.filterType,_=t.textContent.trim().replace(/\s*\d+\s*$/,""),f=document.querySelector("#overviewModal");f&&f.classList.remove("visible"),Pt(h,_);return}const n=e.target.closest(".favorite-chips-container .btn-chip");if(n){Rt(n);return}const r=e.target.closest(".fav-manager-item");if(r){const h=r.parentElement.querySelector(".is-selected");h&&h.classList.remove("is-selected"),h!==r?(r.classList.add("is-selected"),Ae(r)):Ae(null);return}const s=e.target.closest("[data-act]");if(!s)return;const o=["toggle-more-details","show-discount-modal","collapse-room","show-suspended-items","clear-filter"];if(J&&!s.closest(".unlockable")&&!o.includes(s.dataset.act))return;const a=s.dataset.act,l=s.closest(g.room),m=s.closest(".item-card"),c=(h,_,f)=>ue(h,_).then(p=>p&&f());switch(a){case"add-room":le();break;case"add-item":{if(Le=s.closest(g.room),Le){const f=await ze("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà");f&&Ut(f,Le)}break}case"collapse-room":l&&(e.preventDefault(),l.open=!1);break;case"clear-filter":e.stopPropagation(),st();break;case"show-suspended-items":Me();break;case"change-type":{const f=m==null?void 0:m.dataset.type;if(m&&f){const p=await ze("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",f);p&&p!==f&&c("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á","‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",()=>Vt(m,p))}break}case"add-wall":{const f=je(s);f&&((i=f.querySelector('input[name="wall_width_m"]'))==null||i.focus());break}case"show-discount-modal":jt();break;case"open-hardware-modal":{H=m,Wt();break}case"apply-hardware-to-room":{const f=s.closest("#hardwareModal"),p=H==null?void 0:H.closest(g.room);if(!f||!p)break;const y=f.querySelector('[name="modal_track_color"]').value,b=f.querySelector('[name="modal_bracket_color"]').value,q=f.querySelector('[name="modal_finial_color"]').value,x=f.querySelector('[name="modal_grommet_color"]').value;p.querySelectorAll(".set-item").forEach(S=>{S.querySelector('[name="track_color"]').value=y,S.querySelector('[name="bracket_color"]').value=b,S.querySelector('[name="finial_color"]').value=q,S.querySelector('[name="grommet_color"]').value=x}),P(),$("‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success");break}case"toggle-more-details":{Ft(e),Oe(m);break}case"toggle-favorite":{const f=s.closest(".form-group-with-favorites").querySelector("input[data-favorite-type]");if(!f||!m)break;const p=f.dataset.favoriteType,y=f.value;let b;p==="fabric"?b="set_price_per_m":p==="sheer"?b="sheer_price_per_m":p==="wallpaper"?b="wallpaper_price_roll":b="area_price_sqyd";const q=m.querySelector(`[name="${b}"]`),x=v(q==null?void 0:q.value);if(!y.trim()){$("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");break}if(x<=0&&p!=="fabric"&&p!=="sheer"){$("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");break}const S=ke(p,y,x);s.classList.toggle("is-favorite",S),$(S?"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß":"‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î","success"),P();break}case"manage-favorites":{const f=s.dataset.type;Se=s.closest(".form-group-with-favorites").querySelector("input[data-favorite-type]"),Ot(f);break}case"add-new-fav-form":{const p=s.closest("#favManagerModal").dataset.currentType;if(!p)break;const y=document.querySelector("#favAddModal");y.querySelector("h3").textContent=`‡πÄ‡∏û‡∏¥‡πà‡∏° '${((d=de[p])==null?void 0:d.name)||p}'`;const b=y.querySelector('[name="fav_code_add"]'),q=y.querySelector('[name="fav_price_add"]');b.value="",q.value="";const x=await V("#favAddModal");if(x&&!x.cancelled){const S=b.value.trim(),w=v(q.value);S&&(ke(p,S,w),ie=!0,ge(p),$("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"))}break}case"edit-selected-fav":{if(!U)break;const p=s.closest("#favManagerModal").dataset.currentType;if(!p)break;const y=document.querySelector("#favEditModal");y.querySelector("h3").textContent=`‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç '${U.code}'`;const b=y.querySelector('[name="fav_code_edit"]'),q=y.querySelector('[name="fav_price_edit"]');b.value=U.code,q.value=U.price>0?U.price:"";const x=await V("#favEditModal");if(x&&!x.cancelled){const S=b.value.trim(),w=v(q.value);S&&(S!==U.code&&Ce(p,U.code),ke(p,S,w),ie=!0,ge(p),$("‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"))}break}case"del-selected-fav":{if(!U)break;const p=s.closest("#favManagerModal").dataset.currentType;if(!p)break;await ue("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î",`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏´‡∏±‡∏™ "${U.code}"?`)&&(Ce(p,U.code),ie=!0,ge(p),$("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"));break}case"del-room":c("‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>Be(l,"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-item":c("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?",()=>Be(m,"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wall":c("‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",()=>Be(s.closest(".wall-input-row"),"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß",()=>se(m)));break;case"clear-room":c("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>{te(j()),Q(),l.querySelector(g.allItemsContainer).innerHTML="",z(),G(),P(),$("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success")});break;case"toggle-room-menu":e.preventDefault();const h=s.nextElementSibling;if(!h||!l)return;const _=!h.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(f=>f.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(f=>f.classList.remove("overflow-visible")),_&&(h.classList.add("show"),l.classList.add("overflow-visible"));break;case"toggle-suspend-room":e.preventDefault(),l==null||l.classList.toggle("is-suspended"),(u=s.closest(".room-options-menu"))==null||u.classList.remove("show"),l==null||l.classList.remove("overflow-visible"),G(),P(),ne==="suspended"&&Me();break;case"toggle-suspend":e.preventDefault(),m==null||m.classList.toggle("is-suspended"),se(s),P(),ne==="suspended"&&Me();break}};function tr(){J=!J,lt()}function rr(e){if(!e||e.closest(".modal-wrapper"))return;const t=e.getAttribute("name"),n=e.closest(".item-card"),o=(a=>{const l=a[t];if(!l)return null;const m=n||document;let c=null;return typeof l=="string"?c=m.querySelector(`[name="${l}"]:not(:disabled)`):typeof l=="function"&&(c=l(e)),!c&&n&&typeof l=="string"&&(c=document.querySelector(`[name="${l}"]:not(:disabled)`)),c})({customer_name:"customer_phone",customer_phone:"customer_address",customer_address:()=>document.querySelector(".room-name-input"),room_name:a=>{var l;return(l=a.closest(".room-card"))==null?void 0:l.querySelector('[data-act="add-item"]')},width_m:"height_m",height_m:"set_price_per_m",set_price_per_m:a=>{var c;const l=a.closest(".set-item"),m=(c=l==null?void 0:l.querySelector('[name="fabric_variant"]'))==null?void 0:c.value;return m!=null&&m.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")?l==null?void 0:l.querySelector('[name="sheer_price_per_m"]'):l==null?void 0:l.querySelector('[data-act="toggle-more-details"]')},sheer_price_per_m:a=>{var l;return(l=a.closest(".item-card"))==null?void 0:l.querySelector('[data-act="toggle-more-details"]')},area_width_m:"area_height_m",area_height_m:"area_price_sqyd",area_price_sqyd:"area_code",wall_width_m:a=>{var m,c;const l=(m=a.closest(".wall-input-row"))==null?void 0:m.nextElementSibling;return l!=null&&l.matches(".wall-input-row")?l.querySelector("input"):(c=a.closest(".item-card"))==null?void 0:c.querySelector('[name="wallpaper_price_roll"]')},wallpaper_price_roll:"wallpaper_height_m",wallpaper_height_m:"wallpaper_code"});o&&(o.focus(),typeof o.select=="function"&&o.select())}function or(){const e=document.querySelector(g.setTpl);if(!e)return;const t=e.content.querySelector('select[name="set_price_per_m"]'),n=e.content.querySelector('select[name="sheer_price_per_m"]'),r=s=>{let o='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return Array.isArray(s)?(s.forEach(a=>{o+=`<option value="${a}">${a.toLocaleString("th-TH")}</option>`}),o):(console.error("Price data for dropdown is not available or not an array.",s),o)};t&&(t.innerHTML=r(be.fabric)),n&&(n.innerHTML=r(be.sheer))}function nr(){or(),nt();const e=document.querySelector(g.orderForm),t=document.querySelector(g.fileImporter),n=document.querySelector("#favImporter"),r=document.querySelector(g.menuDropdown),s=document.querySelector(g.quickNavDropdown),o=document.querySelector("#pageBreakBuffer"),a=document.querySelector("#pageBreakBufferValue");o&&a&&o.addEventListener("input",()=>{a.textContent=o.value}),e.addEventListener("input",Ze),e.addEventListener("change",Ze),document.addEventListener("click",er),e.addEventListener("blur",zt,!0),e.addEventListener("focusin",Zt,!0),e.addEventListener("focusin",c=>{const i=c.target.closest(".item-card");i&&Ee(i)},!0),e.addEventListener("keydown",c=>{const i=c.target;c.key==="Enter"&&!i.matches("textarea, button, [data-act]")&&(c.preventDefault(),rr(i))});const l=c=>{const i=c.target.closest(g.room);i&&ct(i)};e.addEventListener("click",l),e.addEventListener("focusin",l),document.body.addEventListener("click",c=>{const i=c.target.closest("summary");if(i){const d=i.closest("details.card");setTimeout(()=>{K(),P(),d&&d.open&&Ee(d)},50)}}),document.querySelector("#undoBtn").addEventListener("click",c=>{c.preventDefault(),Nt()}),document.querySelector(g.lockBtn).addEventListener("click",tr),document.querySelector(g.toggleAllRoomsBtn).addEventListener("click",Dt),document.querySelector(g.quickNavBtn).addEventListener("click",c=>{var d;c.stopPropagation(),r.classList.remove("show");const i=!s.classList.contains("show");s.classList.toggle("show"),c.currentTarget.setAttribute("aria-expanded",i),i&&((d=document.querySelector(g.menuBtn))==null||d.setAttribute("aria-expanded","false"))}),document.querySelector(g.quickNavRoomList).addEventListener("click",c=>{var d;const i=c.target.closest("a[data-jump-to]");if(i){c.preventDefault();const u=i.dataset.jumpTo,h=document.getElementById(u);h&&(document.body.classList.add("disable-animations"),h.open=!0,h.scrollIntoView({behavior:"auto",block:"start"}),h.classList.add("scrolling-jump"),setTimeout(()=>{h.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),K()},1e3)),s.classList.remove("show"),(d=document.querySelector(g.quickNavBtn))==null||d.setAttribute("aria-expanded","false")}});const m=document.querySelector("#addRoomQuickNavBtn");if(m){const c=ht(le,700);m.addEventListener("click",i=>{var d;i.stopPropagation(),c(),s.classList.remove("show"),(d=document.querySelector(g.quickNavBtn))==null||d.setAttribute("aria-expanded","false")})}document.querySelector(g.menuBtn).addEventListener("click",c=>{var d;c.stopPropagation(),s.classList.remove("show");const i=!r.classList.contains("show");r.classList.toggle("show"),c.currentTarget.setAttribute("aria-expanded",i),i&&((d=document.querySelector(g.quickNavBtn))==null||d.setAttribute("aria-expanded","false"))}),document.querySelector("#themeToggleBtn").addEventListener("click",c=>{c.preventDefault(),At()}),document.querySelector("#overviewBtn").addEventListener("click",async c=>{var h;c.preventDefault(),r.classList.remove("show"),(h=document.querySelector(g.menuBtn))==null||h.setAttribute("aria-expanded","false");const i=j(),d=document.querySelector("#overviewModalHeader"),u=document.querySelector("#overviewModalBody");if(d&&u){const _=i.rooms.reduce((y,b)=>{if(b.is_suspended)return y;const q=(b.items||[]).filter(x=>{if(x.is_suspended)return!1;let S=0;switch(x.type){case"set":S=C.calculateSetPrice(x).total;break;case"wallpaper":S=C.calculateWallpaperPrice(x).total;break;default:S=C.calculateDecoPrice(x).total;break}return S>0}).length;return y+q},0),f=document.querySelector(g.grandTotal).textContent||"0",p=i.rooms.filter(y=>!y.is_suspended&&y.items&&y.items.some(b=>!b.is_suspended)).length;d.innerHTML=`
                <div class="overview-stats-grid">
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-map-pin-line"></i>
                        <div class="stat-value">${p}</div>
                        <div class="stat-label">‡∏´‡πâ‡∏≠‡∏á</div>
                    </div>
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-stack"></i>
                        <div class="stat-value">${_}</div>
                        <div class="stat-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                    </div>
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-coins"></i>
                        <div class="stat-value">${f}</div>
                        <div class="stat-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</div>
                    </div>
                </div>
            `,u.innerHTML=kt(i),V("#overviewModal")}}),document.querySelector(g.exportPdfBtn).addEventListener("click",async c=>{var h;c.preventDefault(),r.classList.remove("show"),(h=document.querySelector(g.menuBtn))==null||h.setAttribute("aria-expanded","false");const i=await Ht();if(!i)return;const d=j(),u=Lt(d,{vatRate:i.vatOption==="include"?F.baseVatRate:0,pageBreakBuffer:i.pageBreakBuffer});if(!u){$("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}i.exportMethod==="html"?Kt(u):Jt(u,i.exportMethod)}),document.querySelector("#visualReportsBtn").addEventListener("click",async c=>{var i;c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),V("#visualReportsModal")}),document.querySelector("#visualReportsConfirm").addEventListener("click",async c=>{var u;c.preventDefault();const i=document.querySelector("#visualReportsModal"),d=(u=i.querySelector('input[name="report_type_option"]:checked'))==null?void 0:u.value;if(!d){$("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô","warning");return}if(i.classList.remove("visible"),d==="lookbook"){const h=j(),_=Tt(h),f=document.querySelector("#lookbookModalBody");_&&f?(f.innerHTML=_,V("#lookbookModal")):$("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô","warning")}else $(`‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó '${d}' ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô`,"default")}),document.querySelector(g.importBtn).addEventListener("click",c=>{var i;c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),t.click()}),t.addEventListener("change",c=>{var u;const i=(u=c.target.files)==null?void 0:u[0];if(!i)return;const d=new FileReader;d.onload=async h=>{try{const _=JSON.parse(h.target.result);await Ne(_,!0)}catch(_){$("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error"),console.error("JSON Parse Error:",_)}},d.readAsText(i),c.target.value=null}),document.querySelector(g.exportBtn).addEventListener("click",c=>{var i;c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false");try{const d=j(),u=JSON.stringify(d,null,4),h=new Blob([u],{type:"application/json"}),_=URL.createObjectURL(h),f=document.createElement("a"),p=new Date,y=`${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`,b=`${p.getHours().toString().padStart(2,"0")}${p.getMinutes().toString().padStart(2,"0")}`,q=et(d.customer_name||"data");f.href=_,f.download=`MTR-${y}${b}-${q}.json`,f.click(),URL.revokeObjectURL(_),$("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{$("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector("#importFavsBtn").addEventListener("click",c=>{var i;c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),n.click()}),n.addEventListener("change",c=>{var u;const i=(u=c.target.files)==null?void 0:u[0];if(!i)return;const d=new FileReader;d.onload=h=>{try{const _=JSON.parse(h.target.result),f=tt(_);f>0?$(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà ${f} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`,"success"):$("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°","default"),P()}catch(_){$("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error"),console.error("Favorites JSON Parse Error:",_)}},d.readAsText(i),c.target.value=null}),document.querySelector("#exportFavsBtn").addEventListener("click",c=>{var i;c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false");try{const d=X(),u=JSON.stringify(d,null,4),h=new Blob([u],{type:"application/json"}),_=URL.createObjectURL(h),f=document.createElement("a"),p=new Date,y=`${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`;f.href=_,f.download=`MTR-Favorites-${y}.json`,f.click(),URL.revokeObjectURL(_),$("Export ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{$("Export ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(g.submitBtn).addEventListener("click",async c=>{var i;if(c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ue("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const d=j();if(!d.customer_name&&!d.customer_phone){$("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}$("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const u=await fetch(dt,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});u.ok?$("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):$(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${u.status}`,"error")}catch{$("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(g.copyTextBtn).addEventListener("click",async c=>{var u;c.preventDefault(),r.classList.remove("show"),(u=document.querySelector(g.menuBtn))==null||u.setAttribute("aria-expanded","false");const i=document.querySelector(g.copyOptionsModal);i.querySelector('input[name="copy_option"][value="customer"]').checked=!0;const d=await V(g.copyOptionsModal);if(d&&!d.cancelled){const h=i.querySelector('input[name="copy_option"]:checked').value,_=xt(j(),h);try{await navigator.clipboard.writeText(_),$("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{$("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(g.clearItemsBtn).addEventListener("click",async c=>{var i;if(c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ue("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")){te(j()),Q(),document.querySelectorAll(g.room).forEach(h=>{const _=h.querySelector(g.allItemsContainer);_&&(_.innerHTML="")});const d=document.querySelector("#discount_type"),u=document.querySelector("#discount_value");d&&(d.value="amount"),u&&(u.value="0"),G(),P(),$("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡πÅ‡∏•‡πâ‡∏ß","success")}}),document.querySelector(g.clearAllBtn).addEventListener("click",async c=>{var i;if(c.preventDefault(),r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ue("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",'‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô! ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡πÅ‡∏•‡∏∞ "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î" ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')){te(j()),Q(),localStorage.removeItem(ve),gt();const d=document.querySelector("#customer_name"),u=document.querySelector("#customer_phone"),h=document.querySelector("#customer_address");d&&(d.value=""),u&&(u.value=""),h&&(h.value="");const _=document.querySelector("#discount_type"),f=document.querySelector("#discount_value");_&&(_.value="amount"),f&&(f.value="0");const p=document.querySelector(g.roomsContainer);p&&(p.innerHTML=""),G(),me(),K(),le();const y=document.querySelector("#customerDetailsCard");y&&(y.open=!0),$("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà","success")}}),window.addEventListener("click",c=>{var i,d;c.target.closest(".modal-wrapper")||(c.target.closest(".menu-container")||(r.classList.contains("show")&&(r.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false")),s.classList.contains("show")&&(s.classList.remove("show"),(d=document.querySelector(g.quickNavBtn))==null||d.setAttribute("aria-expanded","false"))),c.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(u=>u.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(u=>u.classList.remove("overflow-visible"))),c.target.closest('[data-act="toggle-more-details"]')||document.querySelectorAll(".item-details-more.show").forEach(u=>{const h=u.closest(".item-card");h&&!h.contains(c.target)&&Oe(h,!1)}),c.target.closest(".form-group-with-favorites")||qe())}),window.addEventListener("beforeunload",P);try{const c=localStorage.getItem(ve);if(c&&c.length>2&&c!=="null")Ne(JSON.parse(c),!1);else{le();const i=document.querySelector("#customerDetailsCard");i&&(i.open=!0)}}catch(c){console.error("Failed to load data from localStorage:",c),localStorage.removeItem(ve),le()}G(),lt(),K(),pe(),Q()}document.addEventListener("DOMContentLoaded",nr);
