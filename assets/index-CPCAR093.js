(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const Le="input-ui/5.6.0-final",Te="https://your-make-webhook-url.com/your-unique-path",re="marnthara.input.v4",$e=500,I={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"https://i.imgur.com/l7y85nI.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},Ce=1.19599,de={ROLL_WIDTH_M:.53,ROLL_LENGTH_M:10,STRIPS_PER_ROLL_UNDER_2_5M:3},se={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},m={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",setCount:"#setCount",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",set:"[data-set]",setsContainer:"[data-sets]",decorationsContainer:"[data-decorations]",decoItem:"[data-deco-item]",wallpapersContainer:"[data-wallpapers]",wallpaperItem:"[data-wallpaper-item]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn",allDetailsCards:'.card[id="customerDetailsCard"], .room-card'},v=e=>{typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return Number.isFinite(t)?t:0},O=e=>{const t=v(e);return t>0?t.toFixed(2):""},M=(e,t=2,o=!1)=>Number.isFinite(e)?e.toLocaleString("en-US",{minimumFractionDigits:o?2:t,maximumFractionDigits:o?2:t}):"0",T=(e,t=0)=>Number.isFinite(e)?e.toLocaleString("th-TH",{minimumFractionDigits:t,maximumFractionDigits:t}):"0",ke=(e,t=150)=>{let o;return(...r)=>{clearTimeout(o),o=setTimeout(()=>e(...r),t)}},Ee=(e,t=700)=>{let o=!1;return(...r)=>{if(!o){o=!0;try{return e(...r)}finally{setTimeout(()=>{o=!1},t)}}}};function Ie(e){let t=v(e);if(isNaN(t))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";if(t===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const o=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"],r=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];let n=Math.floor(t),a=Math.round((t-n)*100);const s=i=>{if(i===0)return"";let u="";const d=String(i);for(let p=0;p<d.length;p++){const f=d[p];d.length-1;const _=d.length-p-1;f!=="0"&&(_===1&&f==="1"?u+=r[_]:_===1&&f==="2"?u+="‡∏¢‡∏µ‡πà"+r[_]:_===0&&f==="1"&&d.length>1?u+="‡πÄ‡∏≠‡πá‡∏î":u+=o[parseInt(f)]+r[_])}return u};let l="";if(n>0){const i=Math.floor(n/1e6),u=n%1e6;i>0&&(l+=s(i)+"‡∏•‡πâ‡∏≤‡∏ô"),l+=s(u),l+="‡∏ö‡∏≤‡∏ó"}let c="";return a>0?c=s(a)+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":l+="‡∏ñ‡πâ‡∏ß‡∏ô",(l+c).trim()}function j(){var t,o,r,n;const e={app_version:Le,customer_name:((t=document.querySelector('[name="customer_name"]'))==null?void 0:t.value)||"",customer_phone:((o=document.querySelector('[name="customer_phone"]'))==null?void 0:o.value)||"",customer_address:((r=document.querySelector('[name="customer_address"]'))==null?void 0:r.value)||"",customer_card_open:(n=document.querySelector("#customerDetailsCard"))==null?void 0:n.open,rooms:[]};return document.querySelectorAll(m.room).forEach(a=>{var l;const s={id:a.id,room_name:((l=a.querySelector(m.roomNameInput))==null?void 0:l.value)||"",is_suspended:a.classList.contains("is-suspended"),sets:[],decorations:[],wallpapers:[]};a.querySelectorAll(m.set).forEach(c=>{var i,u,d,p,f,_,w,g,h,q,y;s.sets.push({width_m:v((i=c.querySelector('input[name="width_m"]'))==null?void 0:i.value),height_m:v((u=c.querySelector('input[name="height_m"]'))==null?void 0:u.value),style:((d=c.querySelector('select[name="set_style"]'))==null?void 0:d.value)||"",fabric_variant:((p=c.querySelector('select[name="fabric_variant"]'))==null?void 0:p.value)||"",price_per_m_raw:v((f=c.querySelector('select[name="set_price_per_m"]'))==null?void 0:f.value),sheer_price_per_m:v((_=c.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:_.value),fabric_code:((w=c.querySelector('input[name="fabric_code"]'))==null?void 0:w.value)||"",sheer_fabric_code:((g=c.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:g.value)||"",opening_style:((h=c.querySelector('select[name="opening_style"]'))==null?void 0:h.value)||"",track_color:((q=c.querySelector('select[name="track_color"]'))==null?void 0:q.value)||"",notes:((y=c.querySelector('input[name="notes"]'))==null?void 0:y.value)||"",is_suspended:c.classList.contains("is-suspended")})}),a.querySelectorAll(m.decoItem).forEach(c=>{var i,u,d,p,f,_;s.decorations.push({type:((i=c.querySelector('[name="deco_type"]'))==null?void 0:i.value)||"",width_m:v((u=c.querySelector('[name="deco_width_m"]'))==null?void 0:u.value),height_m:v((d=c.querySelector('[name="deco_height_m"]'))==null?void 0:d.value),price_sqyd:v((p=c.querySelector('[name="deco_price_sqyd"]'))==null?void 0:p.value),deco_code:((f=c.querySelector('[name="deco_code"]'))==null?void 0:f.value)||"",notes:((_=c.querySelector('[name="deco_notes"]'))==null?void 0:_.value)||"",is_suspended:c.classList.contains("is-suspended")})}),a.querySelectorAll(m.wallpaperItem).forEach(c=>{var i,u,d,p,f;s.wallpapers.push({height_m:v((i=c.querySelector('[name="wallpaper_height_m"]'))==null?void 0:i.value),wallpaper_code:((u=c.querySelector('[name="wallpaper_code"]'))==null?void 0:u.value)||"",price_per_roll:v((d=c.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:d.value),install_cost_per_roll:v((p=c.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:p.value),notes:((f=c.querySelector('[name="wallpaper_notes"]'))==null?void 0:f.value)||"",widths:Array.from(c.querySelectorAll('[name="wall_width_m"]')).map(_=>v(_.value)),is_suspended:c.classList.contains("is-suspended")})}),e.rooms.push(s)}),e}function F(){localStorage.setItem(re,JSON.stringify(j()))}const L={stylePlus:e=>se.style_surcharge[e]??0,heightPlus:e=>{const t=[...se.height].sort((o,r)=>r.threshold-o.threshold);for(const o of t)if(e>o.threshold)return o.add_per_m;return 0},fabricYardage:(e,t)=>{const o=v(t);return o<=0||!e?0:e==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||e==="‡∏à‡∏µ‡∏ö"?(o*2+.6)/.9:e==="‡∏•‡∏≠‡∏ô"?(o*2.6+.6)/.9:0},wallpaperRolls:(e,t)=>{const o=v(e),r=v(t);if(o<=0||r<=0)return 0;const n=r>2.5?Math.floor(de.ROLL_LENGTH_M/r):de.STRIPS_PER_ROLL_UNDER_2_5M;if(n<=0)return 0;const a=Math.ceil(o/de.ROLL_WIDTH_M);return Math.ceil(a/n)},calculateSetPrice:function(e){var s,l;if(!e||e.is_suspended||v(e.width_m)<=0)return{total:0,opaque:0,sheer:0};const t=this.stylePlus(e.style),o=this.heightPlus(v(e.height_m)),r=v(e.width_m),n=(s=e.fabric_variant)!=null&&s.includes("‡∏ó‡∏∂‡∏ö")&&v(e.price_per_m_raw)>0?(v(e.price_per_m_raw)+t+o)*r:0,a=(l=e.fabric_variant)!=null&&l.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&v(e.sheer_price_per_m)>0?(v(e.sheer_price_per_m)+t+o)*r:0;return{total:Math.round(n+a),opaque:Math.round(n),sheer:Math.round(a)}},calculateDecoPrice:function(e){if(!e||e.is_suspended||v(e.width_m)<=0)return{total:0,sqm:0,sqyd:0};const t=v(e.width_m)*v(e.height_m),o=t*Ce,r=o*v(e.price_sqyd);return{total:Math.round(r),sqm:t,sqyd:o}},calculateWallpaperPrice:function(e){var s;if(!e||e.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const t=((s=e.widths)==null?void 0:s.reduce((l,c)=>l+v(c),0))||0;if(t<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const o=v(e.height_m),r=this.wallpaperRolls(t,o),n=r*v(e.price_per_roll),a=r*v(e.install_cost_per_roll??300);return{total:Math.round(n+a),material:Math.round(n),install:Math.round(a),rolls:r,sqm:t*o}}};function xe(e){return e.rooms.reduce((t,o)=>{if(o.is_suspended)return t;const r=o.sets.reduce((s,l)=>s+L.calculateSetPrice(l).total,0),n=o.decorations.reduce((s,l)=>s+L.calculateDecoPrice(l).total,0),a=o.wallpapers.reduce((s,l)=>s+L.calculateWallpaperPrice(l).total,0);return t+r+n+a},0)}function Be(e,t){const o=xe(e);let r=`‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"numeric",year:"numeric"})})
`;if(r+=`‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${e.customer_name||"-"}
`,(t==="customer"||t==="owner")&&(r+=`‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${e.customer_phone||"-"}
`,r+=`‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${e.customer_address||"-"}
`),r+=`------------------------------
`,t==="customer")return r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
`,e.rooms.forEach(n=>{if(n.is_suspended||[...n.sets,...n.decorations,...n.wallpapers].filter(l=>l.is_suspended?!1:l.widths?l.widths.reduce((c,i)=>c+i,0)>0:l.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let s=0;n.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(s++,r+=` ${s}) ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} (${l.fabric_variant})
`)}),n.decorations.forEach(l=>{l.is_suspended||l.width_m<=0||(s++,r+=` ${s}) ${l.type||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}
`)}),n.wallpapers.forEach(l=>{l.is_suspended||l.widths.reduce((c,i)=>c+i,0)<=0||(s++,r+=` ${s}) ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå
`)})}),r+=`------------------------------
`,r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(o)} ‡∏ö‡∏≤‡∏ó
`,r+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
${I.name}
‡πÇ‡∏ó‡∏£: ${I.phone}`,r;if(t==="purchase_order"||t==="owner"){const n={opaqueFabrics:[],sheerFabrics:[],decorations:[],wallpapers:[],allSets:[]};if(e.rooms.forEach(a=>{a.is_suspended||(a.sets.forEach(s=>{s.is_suspended||s.width_m<=0||(n.allSets.push(s),s.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&n.opaqueFabrics.push({code:s.fabric_code||"??",yards:L.fabricYardage(s.style,s.width_m)}),s.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&n.sheerFabrics.push({code:s.sheer_fabric_code||"??",yards:L.fabricYardage(s.style,s.width_m)}))}),a.decorations.forEach(s=>{s.is_suspended||!s.type||s.width_m<=0||n.decorations.push({type:s.type,code:s.deco_code||"xxx",width:s.width_m,height:s.height_m})}),a.wallpapers.forEach(s=>{if(s.is_suspended)return;const l=s.widths.reduce((c,i)=>c+i,0);if(l>0){const c=L.wallpaperRolls(l,s.height_m);c>0&&n.wallpapers.push({code:s.wallpaper_code||"xxx",rolls:c})}}))}),r+=`üìã *‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤*
`,r+=`------------------------------
`,n.opaqueFabrics.length>0&&n.opaqueFabrics.forEach(a=>{r+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${a.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${a.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),n.sheerFabrics.length>0&&n.sheerFabrics.forEach(a=>{r+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${a.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${a.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á*
`,r+=`------------------------------

`,n.allSets.length>0){let a=1;n.allSets.forEach(s=>{r+=`(${a++}) ‡∏£‡∏≤‡∏á‡∏°‡πà‡∏≤‡∏ô: ${s.style}, ‡∏™‡∏µ: ${s.track_color}
`,s.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${s.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),s.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${s.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),s.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"&&(r+=`  (‚ùóÔ∏è‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô)
`),r+=`
`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Blind*
`,r+=`------------------------------

`,n.decorations.length>0){const a={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"Wooden Blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"Roller Blind",‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"Vertical Blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"Partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"Pleated Insect Screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"Aluminium Blind"};n.decorations.forEach(s=>{const l=a[s.type]?` (${a[s.type]})`:"";r+=`- ${s.type}${l}
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"xxx"}
`,r+=`‡∏Ç‡∏ô‡∏≤‡∏î: ${s.width.toFixed(2)} x ${s.height.toFixed(2)} m.
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: 1 ‡∏ä‡∏∏‡∏î

`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Wallpaper*
`,r+=`------------------------------

`,n.wallpapers.length>0&&n.wallpapers.forEach(a=>{r+=`- ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå -
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${a.code||"xxx"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${a.rolls} ‡∏°‡πâ‡∏ß‡∏ô

`}),r+=`------------------------------
`,t==="purchase_order")return r}return(t==="seamstress"||t==="owner")&&(r+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á*
`,e.rooms.forEach(n=>{if(n.is_suspended||n.sets.filter(l=>!l.is_suspended&&l.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let s=1;n.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(r+=`${s++}) *‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} ${l.fabric_variant}*
`,r+=`  ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${l.width_m} x ‡∏™‡∏π‡∏á ${l.height_m} ‡∏°.
`,r+=`  ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${l.opening_style}
`,l.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: ‡∏£‡∏´‡∏±‡∏™ ${l.fabric_code||"-"}
`),l.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: ‡∏£‡∏´‡∏±‡∏™ ${l.sheer_fabric_code||"-"}
`))})}),r+=`------------------------------
`,t==="seamstress")||t==="owner"&&(r+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(o)} ‡∏ö‡∏≤‡∏ó*
`),r}function Me(e){if(!e.rooms||e.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';const t={};let o=0,r="";if(e.rooms.forEach(s=>{if(s.is_suspended)return;const l={};s.sets.forEach(i=>{if(L.calculateSetPrice(i).total>0){const u="‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô";l[u]=(l[u]||0)+1,t[u]=(t[u]||0)+1}}),s.decorations.forEach(i=>{if(i.type&&L.calculateDecoPrice(i).total>0){const u=i.type;l[u]=(l[u]||0)+1,t[u]=(t[u]||0)+1}}),s.wallpapers.forEach(i=>{if(L.calculateWallpaperPrice(i).total>0){const u="‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå";l[u]=(l[u]||0)+1,t[u]=(t[u]||0)+1}});const c=Object.entries(l);c.length>0&&(r+=`<tr class="room-header-row"><td colspan="3">${s.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</td></tr>`,c.forEach(([i,u])=>{r+=`<tr><td></td><td class="item-type-cell">${i}</td><td class="pdf-text-center">${u}</td></tr>`,o+=u}))}),o===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let a=`<div id="detailed-material-summary">
        <h4><i class="ph ph-stack"></i> ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
        <ul><li class="summary-note">${Object.entries(t).map(([s,l])=>`${s}: ${l}`).join(" , ")}</li></ul>
    </div>`;return a+=`<table>
        <thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th class="pdf-text-center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th></tr></thead>
        <tbody>${r}</tbody>
    </table>`,a}function Ne(e,t){const{vatRate:o,pageBreakBuffer:r=3}=t,n=[];e.rooms.forEach($=>{if($.is_suspended)return;const C=[];$.sets.forEach(b=>{const E=L.calculateSetPrice(b).total;if(E>0){let x=`‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${b.style} (${b.fabric_variant}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${b.width_m.toFixed(2)} x ${b.height_m.toFixed(2)} ‡∏°.${b.notes?` - ${b.notes}`:""}</small>`;C.push({description:x,total:E,units:x.includes("<br>")?1.5:1})}}),$.decorations.forEach(b=>{const E=L.calculateDecoPrice(b).total;if(E>0){let x=`${b.type||"‡∏á‡∏≤‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"} <br><small>‡∏£‡∏´‡∏±‡∏™: ${b.deco_code||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${b.width_m.toFixed(2)} x ${b.height_m.toFixed(2)} ‡∏°.</small>`;C.push({description:x,total:E,units:x.includes("<br>")?1.5:1})}}),$.wallpapers.forEach(b=>{const E=L.calculateWallpaperPrice(b).total;if(E>0){const x=b.widths.reduce((ee,ue)=>ee+ue,0),U=L.wallpaperRolls(x,b.height_m);let D=`‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå <br><small>‡∏£‡∏´‡∏±‡∏™: ${b.wallpaper_code||"-"}, ‡∏™‡∏π‡∏á ${b.height_m.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${U} ‡∏°‡πâ‡∏ß‡∏ô)</small>`;C.push({description:D,total:E,units:D.includes("<br>")?1.5:1})}}),C.length>0&&(n.push({isRoomHeader:!0,roomName:$.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),n.push(...C))});const a=n.reduce(($,C)=>$+(C.total||0),0);if(a===0)return null;const s=a*o,l=a+s,c=17,i=23,u=[];let d=[],p=0;n.forEach(($,C)=>{const b=u.length===0?c:i,E=p+$.units>b;let x=!1;if(!E&&C<n.length-1){const U=b-(p+$.units);U>0&&U<r&&(x=!0)}(E||x)&&d.length>0&&(u.push(d),d=[],p=0),d.push($),p+=$.units}),d.length>0&&u.push(d);const f=new Date,_=f.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),w=`QT-${f.getFullYear()}${(f.getMonth()+1).toString().padStart(2,"0")}${f.getDate().toString().padStart(2,"0")}`;let g="",h=0,q=1;u.forEach(($,C)=>{const b=C===0,E=C===u.length-1,x=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${I.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong>${I.name}</strong><br>
                            ${I.address.replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${I.phone} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${I.taxId}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${u.length>1?b?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${w}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${_}</td></tr>
                        </table>
                    </div>
                </div>
                ${b?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${e.customer_name||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${e.customer_address.replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${e.customer_phone||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${I.pdf.paymentTerms}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${I.pdf.priceValidity}
                    </div>
                </section>`:""}
            </div>`,U=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span>${I.name} | ‡πÇ‡∏ó‡∏£: ${I.phone}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${C+1} / ${u.length}</span>
                </div>
            </div>`;let D="";b||(D+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${M(h,2,!0)}</td></tr>`),$.forEach(A=>{A.isRoomHeader?D+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${A.roomName}</td></tr>`:(D+=`<tr><td class="pdf-text-center">${q++}</td><td>${A.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${M(A.total,2,!0)}</td><td class="pdf-text-right">${M(A.total,2,!0)}</td></tr>`,h+=A.total)});let ee="";E||(ee=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${M(h,2,!0)}</td></tr></tfoot>`);const ue=E?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                        <ul>${I.pdf.notes.map(A=>`<li>${A}</li>`).join("")}</ul>
                        <div class="pdf-amount-text">( ${Ie(l)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td colspan="2" class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${M(a,2,!0)}</td></tr>
                            ${o>0?`<tr><td colspan="2" class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(o*100).toFixed(0)}%</td><td class="pdf-amount">${M(s,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td colspan="2" class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${M(l,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(${I.name})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${_}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";g+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${x}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${D}</tbody>
                            ${ee}
                        </table>
                        ${ue}
                    </div>
                    ${U}
                </div>
            </div>`});const P=(e.customer_name||"quote").trim().replace(/\s+/g,"-");return{html:`<div id="quotation-template">${g}</div>`,fileName:`${w}_${P}`}}const pe="marnthara.favorites.v3";function W(){try{const e=localStorage.getItem(pe),t={fabric:[],sheer:[],deco:{},wallpaper:[]};return e?{...t,...JSON.parse(e)}:t}catch(e){return console.error("Failed to parse favorites from localStorage",e),{fabric:[],sheer:[],deco:{},wallpaper:[]}}}function ce(e){try{localStorage.setItem(pe,JSON.stringify(e))}catch(t){console.error("Failed to save favorites to localStorage",t)}}function X(e,t,o){return t==="deco"?o?(e.deco[o]||(e.deco[o]=[]),e.deco[o]):null:(e[t]||(e[t]=[]),e[t])}function Pe(e,t,o,r=null){const n=W(),a=X(n,e,r);if(!a)return!1;const s=a.find(l=>l.code===t);return s?s.price=o:a.push({code:t,price:o}),a.sort((l,c)=>l.code.localeCompare(c.code)),ce(n),!0}function Ae(e,t,o,r=null){const n=W(),a=X(n,e,r);return!a||a.some(s=>s.code===t)?!1:(a.push({code:t,price:o}),a.sort((s,l)=>s.code.localeCompare(l.code)),ce(n),!0)}function Fe(e,t,o,r,n=null){const a=W(),s=X(a,e,n);if(!s||t!==o&&s.some(c=>c.code===o))return!1;const l=s.find(c=>c.code===t);return l?(l.code=o,l.price=r,s.sort((c,i)=>c.code.localeCompare(i.code)),ce(a),!0):!1}function he(e,t,o=null){const r=W(),n=X(r,e,o);if(!n)return!1;const a=n.findIndex(s=>s.code===t);return a>-1?(n.splice(a,1),ce(r),!0):!1}function _e(e,t,o=null){if(!e||!t)return;const r=W(),n=t.trim(),a=X(r,e,o);return a==null?void 0:a.find(s=>s.code===n)}function Re(e,t,o=null){return!!_e(e,t,o)}function De(e,t,o,r=null){const n=_e(e,t,r);return n&&n.price===o?(he(e,t,r),!1):(Pe(e,t,o,r),!0)}function Oe(){localStorage.removeItem(pe),console.log("All favorites have been cleared.")}let B=!1,Q=null,te=null,J=!1,k=null;const ye="marnthara.theme";function ve(){const e=localStorage.getItem(ye),t=document.querySelector("#themeToggleBtn");if(!t)return;const o=t.querySelector("i"),r=t.querySelector("span");e==="dark"?(document.body.classList.add("dark-theme"),o&&(o.className="ph-fill ph-sun"),r&&(r.textContent=" Light Mode")):(document.body.classList.remove("dark-theme"),o&&(o.className="ph-fill ph-moon"),r&&(r.textContent=" Dark Mode"))}function He(){document.body.classList.toggle("dark-theme");const e=document.body.classList.contains("dark-theme");localStorage.setItem(ye,e?"dark":"light"),ve()}function S(e,t="default"){const o=document.querySelector(m.toastContainer);if(!o)return;const r={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},n=document.createElement("div");n.className=`toast toast-${t}`,n.innerHTML=`<i class="${r[t]||r.default}"></i> ${e}`,o.appendChild(n),setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),n.addEventListener("transitionend",()=>n.remove())},3e3)}function H(e,t){return new Promise(o=>{const r=document.querySelector(e);if(!r){o(null);return}const n=document.querySelector(".modal-wrapper.visible");n&&n.classList.add("is-underlay"),r.classList.add("visible");const a=r.querySelector('[id$="Confirm"]'),s=r.querySelector('[id$="Cancel"], [data-act="close-modal"]'),l=u=>{r.classList.remove("visible"),a&&(a.onclick=null),s&&(s.onclick=null),document.removeEventListener("keydown",c),n&&n.classList.remove("is-underlay"),typeof u=="object"&&u.cancelled&&t&&t(),o(u)},c=u=>{u.key==="Escape"&&!r.classList.contains("is-underlay")&&l({cancelled:!0})},i=()=>{r.classList.contains("is-underlay")||l({cancelled:!0})};a&&(a.onclick=()=>l(!0)),s&&(s.onclick=i),document.addEventListener("keydown",c)})}async function oe(e,t){const o=document.querySelector(m.modal);if(!o)return!0;const r=o.querySelector(m.modalTitle),n=o.querySelector(m.modalBody);return r&&(r.textContent=e),n&&(n.textContent=t),await H(m.modal)}async function We(){const e=document.querySelector(m.exportOptionsModal);if(!e||!await H(m.exportOptionsModal))return null;const o=e.querySelector('input[name="vat_option"]:checked'),r=e.querySelector("#exportMethod"),n=e.querySelector("#pageBreakBuffer");return{vatOption:o?o.value:"include",exportMethod:r?r.value:"direct",pageBreakBuffer:n?parseInt(n.value,10):3}}function G(e,t){e&&(e.classList.add("item-removing"),e.addEventListener("animationend",()=>{e.remove(),t&&S(t),ie(),le(),R(),F(),Y()},{once:!0}))}function le(){document.querySelectorAll(m.room).forEach(e=>{const t=e.querySelectorAll(".item-card"),o=t.length;t.forEach((r,n)=>{const a=r.querySelector("[data-item-title]");a&&(a.textContent=`${n+1}/${o}`)})})}function ge(){const e=document.querySelector(m.orderForm),t=document.querySelector(m.lockBtn);if(!e||!t)return;const o=e.querySelectorAll("input, select, textarea, button");e.classList.toggle("is-locked",B),t.classList.toggle("is-locked",B);const r=t.querySelector("i");r&&(r.className=B?"ph-bold ph-lock-key":"ph-bold ph-lock-key-open"),o.forEach(n=>{n.closest(".summary-footer")||n.closest(".main-header")||n.closest(".modal-wrapper")||(n.disabled=B)}),S(B?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",B?"warning":"success")}function V(){const e=document.querySelectorAll(m.allDetailsCards);if(e.length===0)return;const t=[...e].some(r=>r.open),o=document.querySelector(m.toggleAllRoomsBtn);if(o){const r=o.querySelector("i"),n=o.querySelector("span");r&&(r.className=t?"ph ph-rows-slash":"ph ph-rows"),n&&(n.textContent=t?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}}function Ue(){const e=document.querySelectorAll(m.allDetailsCards),t=[...e].some(o=>o.open);e.forEach(o=>{o.open=!t}),setTimeout(V,50)}function ie(){const e=document.querySelector(m.quickNavRoomList);if(!e)return;e.innerHTML="",document.querySelectorAll(m.room).forEach(o=>{const r=o.querySelector(m.roomNameInput),n=r?r.value:"‡∏´‡πâ‡∏≠‡∏á",a=document.createElement("a");a.href=`#${o.id}`,a.dataset.jumpTo=o.id,a.innerHTML=`<i class="ph ph-arrow-bend-left-up"></i> ${n||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)"}`,e.appendChild(a)})}function Se(e){const t=document.getElementById("quickNavBtnText");if(t)if(e){const o=e.querySelector('input[name="room_name"]');o&&(t.textContent=o.value||"...")}else t.textContent="‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á"}function Y(){if(te&&te.disconnect(),!document.getElementById("quickNavBtnText"))return;const t={root:null,rootMargin:"-60px 0px -150px 0px",threshold:0},o=n=>{const a=n.filter(s=>s.isIntersecting).sort((s,l)=>s.target.getBoundingClientRect().top-l.target.getBoundingClientRect().top);a.length>0&&Se(a[0].target)};te=new IntersectionObserver(o,t),document.querySelectorAll(m.room).forEach(n=>te.observe(n))}function je(){document.querySelectorAll("[data-favorite-type]").forEach(N)}function me(){const e=document.querySelector('[data-act="edit-selected-fav"]'),t=document.querySelector('[data-act="del-selected-fav"]');if(e&&t){const o=k!==null;e.disabled=!o,t.disabled=!o}}function ne(e,t=null){const o=document.getElementById("favManagerBody");if(!o)return;const r=W();let n=[];if(e==="deco"?n=r.deco[t]||[]:n=r[e]||[],o.innerHTML="",n.length===0)o.innerHTML='<p class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</p>';else{const a=document.getElementById("favManagerItemTpl").innerHTML;n.forEach(s=>{const l=a.replace(/{CODE}/g,s.code).replace(/{PRICE}/g,T(s.price)).replace(/{RAW_PRICE}/g,s.price),c=document.createElement("div");c.innerHTML=l;const i=c.firstElementChild;i.dataset.type=e,t&&(i.dataset.subType=t),o.appendChild(i)})}k=null,me()}async function Ve(e,t=null){J=!1,k=null;const o=document.getElementById("favManagerTitle");if(!o)return;let r="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î";e==="deco"?r=`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î: ${t||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}`:r=`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î: ${{fabric:"‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö",sheer:"‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á",wallpaper:"‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå"}[e]||e}`,o.textContent=r,o.dataset.type=e,o.dataset.subType=t||"",ne(e,t),await H("#favManagerModal"),J&&(je(),Q&&we(Q))}async function Ye(){const e=document.querySelector("#favAddModal");if(!e)return null;const t=e.querySelector("#fav_code_add"),o=e.querySelector("#fav_price_add");t.value="",o.value="";const r=await H("#favAddModal");return r&&!r.cancelled?{newCode:t.value.trim(),newPrice:v(o.value)}:null}async function Ge(e){const t=document.querySelector("#favEditModal");if(!t)return null;const o=t.querySelector("#fav_code_edit"),r=t.querySelector("#fav_price_edit");o.value=e.code,r.value=e.price;const n=await H("#favEditModal");return n&&!n.cancelled?{newCode:o.value.trim(),newPrice:v(r.value)}:null}function K(){document.querySelectorAll(".favorite-chips-container.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll(".item-card.overflow-visible").forEach(e=>{e.classList.remove("overflow-visible")}),Q=null}function N(e){var l;if(!e||!e.matches("[data-favorite-type]"))return;const t=e.nextElementSibling;if(!t||!t.matches(".btn-favorite"))return;const o=t.dataset.type,r=e.value;if(!r){t.classList.remove("is-favorite"),t.querySelector("i").className="ph ph-star";return}const n=e.closest(".item-card");if(!n)return;let a=null;o==="deco"&&(a=(l=n.querySelector('[name="deco_type"]'))==null?void 0:l.value);const s=Re(o,r,a);t.classList.toggle("is-favorite",s),t.querySelector("i").className=s?"ph-fill ph-star":"ph ph-star"}function we(e){var c,i;K();const t=e.dataset.favoriteType;if(!t)return;let o=null,r=[];const n=W();t==="deco"?(o=(i=(c=e.closest(".item-card"))==null?void 0:c.querySelector('[name="deco_type"]'))==null?void 0:i.value,o&&(r=n.deco[o]||[])):r=n[t]||[];const a=e.closest(".form-group-with-favorites").querySelector(".favorite-chips-container");if(!a)return;a.innerHTML="",r.length>0&&r.forEach(u=>{const d=document.createElement("button");d.type="button",d.className="btn-chip",d.textContent=u.code,d.dataset.act="select-favorite",d.dataset.code=u.code,d.dataset.price=u.price,a.appendChild(d)});const s=document.createElement("button");s.type="button",s.className="btn-manage-favorites",s.dataset.act="manage-favorites",s.dataset.type=t,o&&(s.dataset.subType=o),s.innerHTML='<i class="ph ph-pencil-simple"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç',a.appendChild(s),a.classList.add("show");const l=e.closest(".item-card");l&&l.classList.add("overflow-visible")}function z(e,t,o=!0){K();const r=document.querySelector(e);if(!r||!t)return null;const n=r.content.cloneNode(!0),a=n.firstElementChild;t.appendChild(n),a.querySelectorAll("input[data-favorite-type]").forEach(N),o&&a&&(a.classList.add("item-created"),a.scrollIntoView({behavior:"smooth",block:"center"}));const s=a.querySelector('input:not([type="hidden"]), select, textarea');return s&&s.focus(),le(),R(),F(),a}function ae(){const e=document.querySelector(m.roomsContainer);if(!e)return;const t=document.querySelectorAll(m.roomNameInput);let o=0;t.forEach(a=>{const s=a.value.match(/\d+/g);if(s){const l=parseInt(s[s.length-1],10);l>o&&(o=l)}});const r=o+1,n=z("#roomTpl",e,!0);if(n){n.id=`room-${Date.now()}`;const a=n.querySelector(m.roomNameInput);a&&(a.value=`‡∏´‡πâ‡∏≠‡∏á ${r}`),n.open=!0}ie(),V(),Y()}function Je(e){if(!e)return;const t=e.querySelector(m.setsContainer);t&&z("#setTpl",t)}function Qe(e){if(!e)return;const t=e.querySelector(m.decorationsContainer);t&&z("#decoTpl",t)}function Ke(e){if(!e)return;const t=e.querySelector(m.wallpapersContainer);if(t){const o=z("#wallpaperTpl",t);o&&qe(o.querySelector('[data-act="add-wall"]'))}}function qe(e){var o;const t=(o=e==null?void 0:e.closest(".walls-section"))==null?void 0:o.querySelector(m.wallsContainer);t&&(z("#wallTpl",t,!0),Z(e))}function be(e){var n,a;if(!e)return;const t=(n=e.querySelector('select[name="fabric_variant"]'))==null?void 0:n.value,o=t&&t.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");(a=e.querySelector(m.sheerWrap))==null||a.classList.toggle("hidden",!o);const r=e.querySelector('input[name="sheer_fabric_code"]');if(r){const s=r.closest(".form-group-with-favorites");s&&s.classList.toggle("hidden",!o)}}function Xe(e,t,o,r=null){let n=0;document.querySelectorAll(`
        [name="fabric_code"], 
        [name="sheer_fabric_code"], 
        [name="deco_code"], 
        [name="wallpaper_code"]
    `).forEach(s=>{var l;if(s.value.trim()===e){const c=s.closest(".item-card");if(!c)return;const i=s.dataset.favoriteType;let u=null;if(i===o){if(o==="deco"&&((l=c.querySelector('[name="deco_type"]'))==null?void 0:l.value)!==r)return;o==="fabric"&&(u=c.querySelector('[name="set_price_per_m"]')),o==="sheer"&&(u=c.querySelector('[name="sheer_price_per_m"]')),o==="deco"&&(u=c.querySelector('[name="deco_price_sqyd"]')),o==="wallpaper"&&(u=c.querySelector('[name="wallpaper_price_roll"]')),s.value=t.newCode,u&&(u.tagName==="SELECT"?u.value=t.newPrice:u.value=T(v(t.newPrice)),s.classList.add("input-highlight"),u.classList.add("input-highlight"),setTimeout(()=>{s.classList.remove("input-highlight"),u.classList.remove("input-highlight")},1500),u.dispatchEvent(new Event("change",{bubbles:!0}))),n++}}}),n>0&&S(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï ${n} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß`,"success")}function ze(e,t,o=null){document.querySelectorAll(`input[data-favorite-type="${t}"]`).forEach(r=>{var n;if(r.value.trim()===e)if(t==="deco"){const a=r.closest(".item-card");((n=a==null?void 0:a.querySelector('[name="deco_type"]'))==null?void 0:n.value)===o&&N(r)}else N(r)})}const Ze=ke(e=>{Z(e),F()});function et(e){if(B){S("‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ","warning"),e.preventDefault();return}e.target.matches("input[data-favorite-type]")&&N(e.target),e.target.matches(m.roomNameInput)&&Y(),Ze(e.target)}function tt(e){if(B)return;const t=e.target;if(t.matches('select[name="fabric_variant"]')&&be(t.closest(m.set)),t.matches('select[name="deco_type"]')){const r=t.closest(m.decoItem);if(r){const n=r.querySelector(".deco-type-display");n&&(n.textContent=t.value||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á");const a=r.querySelector('input[name="deco_code"]');a&&N(a)}}if(t.matches(m.roomNameInput)&&(ie(),Y()),["set_price_per_m","sheer_price_per_m","deco_price_sqyd","wallpaper_price_roll"].includes(t.name)){const r=t.closest(".item-card");if(r){let n;t.name==="set_price_per_m"&&(n=r.querySelector('[name="fabric_code"]')),t.name==="sheer_price_per_m"&&(n=r.querySelector('[name="sheer_fabric_code"]')),t.name==="deco_price_sqyd"&&(n=r.querySelector('[name="deco_code"]')),t.name==="wallpaper_price_roll"&&(n=r.querySelector('[name="wallpaper_code"]')),n&&N(n)}}Z(t),F()}function rt(e){const t=e.target,o=t.matches('[name="deco_price_sqyd"], [name="wallpaper_price_roll"], [name="wallpaper_install_cost"], [name="fav_price_edit"], [name="fav_price_add"]'),r=t.matches('input[name="width_m"], input[name="height_m"], input[name="deco_width_m"], input[name="deco_height_m"], input[name="wallpaper_height_m"], input[name="wall_width_m"]');if(o){const n=v(t.value);n>0?t.value=T(n):t.value=""}else r&&(t.value=O(t.value))}function ot(e){const t=e.target;t.matches("input[data-favorite-type]")&&(Q=t,we(t))}function Z(e){var n,a,s,l,c,i,u,d,p,f,_,w;if(!e)return;const t=e.closest(m.set);if(t){const g=t.querySelector("[data-set-summary]");if(g){const h={width_m:(n=t.querySelector('input[name="width_m"]'))==null?void 0:n.value,height_m:(a=t.querySelector('input[name="height_m"]'))==null?void 0:a.value,style:(s=t.querySelector('select[name="set_style"]'))==null?void 0:s.value,fabric_variant:(l=t.querySelector('select[name="fabric_variant"]'))==null?void 0:l.value,price_per_m_raw:(c=t.querySelector('select[name="set_price_per_m"]'))==null?void 0:c.value,sheer_price_per_m:(i=t.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:i.value},q=L.calculateSetPrice(h);let y=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(q.total)}</b> ‡∏ö.`;q.opaque>0&&q.sheer>0&&(y+=` <small>(‡∏ó‡∏∂‡∏ö: ${T(q.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${T(q.sheer)})</small>`),g.innerHTML=y}}const o=e.closest(m.decoItem);if(o){const g=o.querySelector("[data-deco-summary]");if(g){const h={width_m:(u=o.querySelector('input[name="deco_width_m"]'))==null?void 0:u.value,height_m:(d=o.querySelector('input[name="deco_height_m"]'))==null?void 0:d.value,price_sqyd:(p=o.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:p.value},q=L.calculateDecoPrice(h);g.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(q.total)}</b> ‡∏ö. &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${M(q.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`}}const r=e.closest(m.wallpaperItem);if(r){const g=r.querySelector("[data-wallpaper-summary]");if(g){const h={height_m:(f=r.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:f.value,price_per_roll:(_=r.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:_.value,install_cost_per_roll:(w=r.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:w.value,widths:Array.from(r.querySelectorAll('input[name="wall_width_m"]')).map(P=>P.value)},q=L.calculateWallpaperPrice(h);let y=`‡∏£‡∏ß‡∏°: <b>${T(q.total)}</b> ‡∏ö. `;(q.material>0||q.install>0)&&(y+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${T(q.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${T(q.install)})</small>`),y+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${M(q.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${q.rolls} ‡∏°‡πâ‡∏ß‡∏ô`,g.innerHTML=y}}R()}function R(){let e=0,t=0;document.querySelectorAll(m.room).forEach(n=>{let a=0,s=0;const l=n.classList.contains("is-suspended");n.querySelectorAll(m.set).forEach(i=>{var d,p,f,_,w,g;const u=L.calculateSetPrice({is_suspended:l||i.classList.contains("is-suspended"),width_m:(d=i.querySelector('input[name="width_m"]'))==null?void 0:d.value,height_m:(p=i.querySelector('input[name="height_m"]'))==null?void 0:p.value,style:(f=i.querySelector('select[name="set_style"]'))==null?void 0:f.value,fabric_variant:(_=i.querySelector('select[name="fabric_variant"]'))==null?void 0:_.value,price_per_m_raw:(w=i.querySelector('select[name="set_price_per_m"]'))==null?void 0:w.value,sheer_price_per_m:(g=i.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:g.value}).total;a+=u,u>0&&(t++,s++)}),n.querySelectorAll(m.decoItem).forEach(i=>{var d,p,f;const u=L.calculateDecoPrice({is_suspended:l||i.classList.contains("is-suspended"),width_m:(d=i.querySelector('input[name="deco_width_m"]'))==null?void 0:d.value,height_m:(p=i.querySelector('input[name="deco_height_m"]'))==null?void 0:p.value,price_sqyd:(f=i.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:f.value}).total;a+=u,u>0&&(t++,s++)}),n.querySelectorAll(m.wallpaperItem).forEach(i=>{var d,p,f;const u=L.calculateWallpaperPrice({is_suspended:l||i.classList.contains("is-suspended"),height_m:(d=i.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:d.value,price_per_roll:(p=i.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:p.value,install_cost_per_roll:(f=i.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:f.value,widths:Array.from(i.querySelectorAll('input[name="wall_width_m"]')).map(_=>_.value)}).total;a+=u,u>0&&(t++,s++)});const c=n.querySelector("[data-room-brief]");c&&(l?c.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":s>0?c.innerHTML=`<span>${s}</span> &bull; ${T(a)} ‡∏ö‡∏≤‡∏ó`:c.textContent=""),e+=l?0:a});const o=document.querySelector(m.grandTotal),r=document.querySelector(m.setCount);o&&(o.textContent=T(e)),r&&(r.textContent=t)}function fe(e){if(!e||!e.rooms)return;const t=document.querySelector(m.roomsContainer);if(!t)return;t.innerHTML="";const o=document.querySelector("#customer_name"),r=document.querySelector("#customer_phone"),n=document.querySelector("#customer_address");o&&(o.value=e.customer_name||""),r&&(r.value=e.customer_phone||""),n&&(n.value=e.customer_address||""),e.rooms.forEach(a=>{const s=document.querySelector("#roomTpl");if(!s)return;const l=s.content.cloneNode(!0),c=l.querySelector(m.room);if(!c)return;c.id=a.id||`room-${Date.now()}`,a.is_suspended&&c.classList.add("is-suspended");const i=c.querySelector(m.roomNameInput);i&&(i.value=a.room_name||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)");const u=c.querySelector(m.setsContainer),d=c.querySelector(m.decorationsContainer),p=c.querySelector(m.wallpapersContainer),f=document.querySelector("#setTpl"),_=document.querySelector("#decoTpl"),w=document.querySelector("#wallpaperTpl"),g=document.querySelector("#wallTpl");u&&f&&a.sets&&a.sets.forEach(h=>{const q=f.content.cloneNode(!0),y=q.querySelector(m.set);h.is_suspended&&y.classList.add("is-suspended"),y.querySelector('input[name="width_m"]').value=O(h.width_m),y.querySelector('input[name="height_m"]').value=O(h.height_m),y.querySelector('select[name="set_style"]').value=h.style||"‡∏•‡∏≠‡∏ô",y.querySelector('select[name="fabric_variant"]').value=h.fabric_variant||"‡∏ó‡∏∂‡∏ö",y.querySelector('select[name="set_price_per_m"]').value=h.price_per_m_raw||"",y.querySelector('select[name="sheer_price_per_m"]').value=h.sheer_price_per_m||"",y.querySelector('select[name="opening_style"]').value=h.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á",y.querySelector('select[name="track_color"]').value=h.track_color||"‡∏Ç‡∏≤‡∏ß",y.querySelector('input[name="fabric_code"]').value=h.fabric_code||"",y.querySelector('input[name="sheer_fabric_code"]').value=h.sheer_fabric_code||"",y.querySelector('input[name="notes"]').value=h.notes||"",be(y),u.appendChild(q)}),d&&_&&a.decorations&&a.decorations.forEach(h=>{const q=_.content.cloneNode(!0),y=q.querySelector(m.decoItem);h.is_suspended&&y.classList.add("is-suspended");const P=y.querySelector('select[name="deco_type"]');P.value=h.type||"",y.querySelector(".deco-type-display").textContent=h.type||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",y.querySelector('input[name="deco_width_m"]').value=O(h.width_m),y.querySelector('input[name="deco_height_m"]').value=O(h.height_m),y.querySelector('input[name="deco_price_sqyd"]').value=T(h.price_sqyd)||"",y.querySelector('input[name="deco_code"]').value=h.deco_code||"",y.querySelector('input[name="deco_notes"]').value=h.notes||"",d.appendChild(q)}),p&&w&&a.wallpapers&&a.wallpapers.forEach(h=>{const q=w.content.cloneNode(!0),y=q.querySelector(m.wallpaperItem);h.is_suspended&&y.classList.add("is-suspended"),y.querySelector('input[name="wallpaper_height_m"]').value=O(h.height_m),y.querySelector('input[name="wallpaper_code"]').value=h.wallpaper_code||"",y.querySelector('input[name="wallpaper_price_roll"]').value=T(h.price_per_roll)||"",y.querySelector('input[name="wallpaper_install_cost"]').value=h.hasOwnProperty("install_cost_per_roll")?T(h.install_cost_per_roll):"300",y.querySelector('input[name="wallpaper_notes"]').value=h.notes||"";const P=y.querySelector(m.wallsContainer);P&&g&&h.widths&&h.widths.forEach($=>{const C=g.content.cloneNode(!0);C.querySelector('input[name="wall_width_m"]').value=O($),P.appendChild(C)}),p.appendChild(q)}),t.appendChild(l)}),document.querySelectorAll("input[data-favorite-type]").forEach(N),document.querySelectorAll(".item-card").forEach(a=>{Z(a)}),le(),R(),ie(),V(),Y(),S("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}function nt(e,t){const o=document.querySelector(m.printableContent);!o||!e||!e.html||(o.innerHTML=e.html,setTimeout(()=>{if(t==="direct"){const r=document.getElementById("quotation-template");r&&html2pdf().from(r).set({margin:[15,12,10,12],filename:`${e.fileName}.pdf`,pagebreak:{mode:["css","legacy"]},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save().then(()=>{o.innerHTML=""})}else t==="print"&&(window.print(),o.innerHTML="")},$e))}function at(e){if(!e||!e.html)return;const t=new Blob([e.html],{type:"text/html;charset=utf-8"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=`${e.fileName}.html`,r.click(),URL.revokeObjectURL(o),S("Export ‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}const st=async e=>{var s,l,c;const t=e.target.closest("[data-act]"),o=e.target.closest(".fav-manager-item");if(o&&!t&&o.closest("#favManagerBody")){k===o?(k.classList.remove("is-selected"),k=null):(k&&k.classList.remove("is-selected"),o.classList.add("is-selected"),k=o),me();return}if(!t||B&&!t.closest(".unlockable")&&!["select-favorite","manage-favorites","close-modal","add-new-fav-form","edit-selected-fav","del-selected-fav"].includes(t.dataset.act))return;const r=t.dataset.act,n=t.closest(m.room),a=(i,u,d)=>{oe(i,u).then(p=>{p===!0&&d()})};switch(r){case"add-room":ae();break;case"add-set":Je(n);break;case"add-deco":Qe(n);break;case"add-wallpaper":Ke(n);break;case"add-wall":qe(t);break;case"del-room":a("‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>G(n,"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-set":a("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô?",()=>G(t.closest(m.set),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-deco":a("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á?",()=>G(t.closest(m.decoItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wallpaper":a("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå?",()=>G(t.closest(m.wallpaperItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wall":a("‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",()=>G(t.closest(".wall-input-row"),"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"clear-room":a("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>{n.querySelector(m.setsContainer).innerHTML="",n.querySelector(m.decorationsContainer).innerHTML="",n.querySelector(m.wallpapersContainer).innerHTML="",le(),R(),F(),S("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success")});break;case"toggle-room-menu":e.preventDefault();const i=t.nextElementSibling;if(!i||!n)return;const u=!i.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(d=>d.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(d=>d.classList.remove("overflow-visible")),u&&(i.classList.add("show"),n.classList.add("overflow-visible"));break;case"toggle-suspend-room":e.preventDefault(),n==null||n.classList.toggle("is-suspended"),R(),F(),(s=t.closest(".room-options-menu"))==null||s.classList.remove("show"),n==null||n.classList.remove("overflow-visible");break;case"toggle-suspend":e.preventDefault(),(l=t.closest(".item-card"))==null||l.classList.toggle("is-suspended"),Z(t),F();break;case"toggle-favorite":{const d=t.dataset.type,p=t.previousElementSibling,f=p==null?void 0:p.value;if(!f||f.trim()===""){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");return}const _=t.closest(".item-card");if(!_)return;let w=0,g=null,h=null;if(d==="fabric"&&(g=_.querySelector('[name="set_price_per_m"]')),d==="sheer"&&(g=_.querySelector('[name="sheer_price_per_m"]')),d==="wallpaper"&&(g=_.querySelector('[name="wallpaper_price_roll"]')),d==="deco"&&(g=_.querySelector('[name="deco_price_sqyd"]'),h=(c=_.querySelector('[name="deco_type"]'))==null?void 0:c.value,!h)){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");return}if(g&&g.value&&(w=v(g.value)),w<=0){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î","warning");return}const q=De(d,f,w,h);N(p),S(q?"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß":"‡∏•‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success");break}case"select-favorite":{const d=t.dataset.code,p=t.dataset.price,f=t.closest(".form-group-with-favorites"),_=f?f.querySelector("input[data-favorite-type]"):Q;if(_){_.value=d;const w=t.closest(".item-card");if(w&&p){const g=_.dataset.favoriteType;let h=null;g==="fabric"&&(h=w.querySelector('[name="set_price_per_m"]')),g==="sheer"&&(h=w.querySelector('[name="sheer_price_per_m"]')),g==="deco"&&(h=w.querySelector('[name="deco_price_sqyd"]')),g==="wallpaper"&&(h=w.querySelector('[name="wallpaper_price_roll"]')),h&&(h.tagName==="SELECT"?h.value=p:h.value=T(v(p)),h.classList.add("input-highlight"),setTimeout(()=>h.classList.remove("input-highlight"),1200),h.dispatchEvent(new Event("change",{bubbles:!0})))}_.dispatchEvent(new Event("input",{bubbles:!0})),K(),S(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î ${d} ‡πÅ‡∏•‡πâ‡∏ß`,"success")}break}case"manage-favorites":{K();const d=t.dataset.type,p=t.dataset.subType||null;if(d==="deco"&&!p){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô","warning");return}Ve(d,p);break}case"del-selected-fav":{if(!k)return;const{type:d,subType:p,code:f}=k.dataset;a("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î",`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${f}"?`,()=>{he(d,f,p)&&(J=!0,k.remove(),k=null,me(),S("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"),ze(f,d,p),document.querySelector(".fav-manager-item")||ne(d,p))});break}case"edit-selected-fav":{if(!k)return;const{type:d,subType:p,code:f,price:_}=k.dataset,w=await Ge({code:f,price:_});if(w){if(!w.newCode){S("‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á","error");return}Fe(d,f,w.newCode,w.newPrice,p)?(J=!0,S("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"),ne(d,p),Xe(f,w,d,p)):S("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏à‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô","error")}break}case"add-new-fav-form":{const{type:d,subType:p}=document.getElementById("favManagerTitle").dataset,f=await Ye();if(f){if(!f.newCode){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™","error");return}if(f.newPrice<=0){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤","error");return}Ae(d,f.newCode,f.newPrice,p)?(J=!0,S("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success"),ne(d,p)):S("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏à‡∏ã‡πâ‡∏≥","error")}break}}};function ct(){B=!B,ge()}function lt(){const e=document.querySelector(m.setTpl);if(!e)return;const t=e.content.querySelector('select[name="set_price_per_m"]'),o=e.content.querySelector('select[name="sheer_price_per_m"]'),r=n=>{let a='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return n.forEach(s=>{a+=`<option value="${s}">${s.toLocaleString("th-TH")}</option>`}),a};t&&(t.innerHTML=r(se.fabric)),o&&(o.innerHTML=r(se.sheer))}function it(){lt(),ve();const e=document.querySelector(m.orderForm),t=document.querySelector(m.fileImporter),o=document.querySelector(m.menuDropdown),r=document.querySelector(m.quickNavDropdown),n=document.querySelector("#pageBreakBuffer"),a=document.querySelector("#pageBreakBufferValue");n&&a&&n.addEventListener("input",()=>{a.textContent=n.value}),e.addEventListener("input",et),e.addEventListener("change",tt),document.addEventListener("click",st),e.addEventListener("blur",rt,!0),e.addEventListener("focusin",ot);const s=c=>{const i=c.target.closest(m.room);i&&Se(i)};e.addEventListener("click",s),e.addEventListener("focusin",s),document.body.addEventListener("click",c=>{c.target.closest("summary")&&setTimeout(V,50)}),document.querySelector(m.lockBtn).addEventListener("click",ct),document.querySelector(m.toggleAllRoomsBtn).addEventListener("click",Ue),document.querySelector(m.quickNavBtn).addEventListener("click",c=>{c.stopPropagation(),o.classList.remove("show"),r.classList.toggle("show")}),document.querySelector(m.quickNavRoomList).addEventListener("click",c=>{const i=c.target.closest("a[data-jump-to]");if(i){c.preventDefault();const u=i.dataset.jumpTo,d=document.getElementById(u);d&&(document.body.classList.add("disable-animations"),d.open=!0,d.scrollIntoView({behavior:"auto",block:"start"}),d.classList.add("scrolling-jump"),setTimeout(()=>{d.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),V()},1e3)),r.classList.remove("show")}});const l=document.querySelector("#addRoomQuickNavBtn");if(l){const c=Ee(ae,700);l.addEventListener("click",i=>{i.stopPropagation(),c(),r.classList.remove("show")})}document.querySelector(m.menuBtn).addEventListener("click",c=>{c.stopPropagation(),r.classList.remove("show"),o.classList.toggle("show")}),document.querySelector("#themeToggleBtn").addEventListener("click",c=>{c.preventDefault(),He()}),document.querySelector("#overviewBtn").addEventListener("click",async c=>{c.preventDefault(),o.classList.remove("show");const i=j(),u=Me(i),d=document.querySelector("#overviewModalBody");d&&(d.innerHTML=u,H("#overviewModal",()=>{}))}),document.querySelector(m.exportPdfBtn).addEventListener("click",async c=>{c.preventDefault(),o.classList.remove("show");const i=await We();if(!i)return;const u=j(),d=i.vatOption==="include"?I.baseVatRate:0,p=Ne(u,{vatRate:d,pageBreakBuffer:i.pageBreakBuffer});if(!p){S("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}i.exportMethod==="html"?at(p):nt(p,i.exportMethod)}),document.querySelector(m.importBtn).addEventListener("click",c=>{c.preventDefault(),o.classList.remove("show"),t.click()}),t.addEventListener("change",c=>{var d;const i=(d=c.target.files)==null?void 0:d[0];if(!i)return;const u=new FileReader;u.onload=p=>{try{const f=JSON.parse(p.target.result);fe(f)}catch{S("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error")}},u.readAsText(i),c.target.value=null}),document.querySelector(m.exportBtn).addEventListener("click",c=>{c.preventDefault(),o.classList.remove("show");try{const i=j(),u=JSON.stringify(i,null,4),d=new Blob([u],{type:"application/json"}),p=URL.createObjectURL(d),f=document.createElement("a"),_=new Date,w=`${_.getFullYear()}${(_.getMonth()+1).toString().padStart(2,"0")}${_.getDate().toString().padStart(2,"0")}`,g=(i.customer_name||"data").trim().replace(/\s+/g,"-");f.href=p,f.download=`MTR-${g}-${w}.json`,f.click(),URL.revokeObjectURL(p),S("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{S("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(m.submitBtn).addEventListener("click",async c=>{if(c.preventDefault(),o.classList.remove("show"),await oe("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const i=j();if(!i.customer_name&&!i.customer_phone){S("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}S("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const u=await fetch(Te,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});u.ok?S("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):S(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${u.status}`,"error")}catch{S("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(m.copyTextBtn).addEventListener("click",async c=>{c.preventDefault(),o.classList.remove("show");const i=document.querySelector(m.copyOptionsModal);if(i.querySelector('input[name="copy_option"][value="customer"]').checked=!0,await H(m.copyOptionsModal)){const u=i.querySelector('input[name="copy_option"]:checked').value,d=Be(j(),u);try{await navigator.clipboard.writeText(d),S("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{S("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(m.clearItemsBtn).addEventListener("click",async c=>{c.preventDefault(),o.classList.remove("show"),await oe("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")&&(document.querySelectorAll(m.room).forEach(i=>{i.querySelector(m.setsContainer).innerHTML="",i.querySelector(m.decorationsContainer).innerHTML="",i.querySelector(m.wallpapersContainer).innerHTML=""}),R(),F(),S("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))}),document.querySelector(m.clearAllBtn).addEventListener("click",async c=>{c.preventDefault(),o.classList.remove("show"),await oe("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ")&&(localStorage.removeItem(re),localStorage.removeItem("marnthara.theme"),Oe(),window.location.reload())}),window.addEventListener("click",c=>{c.target.closest(".menu-container")||(o.classList.remove("show"),r.classList.remove("show")),c.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(i=>i.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(i=>i.classList.remove("overflow-visible"))),c.target.closest(".form-group-with-favorites")||K()});try{const c=localStorage.getItem(re);if(c)fe(JSON.parse(c));else{ae();const i=document.querySelector("#customerDetailsCard");i&&(i.open=!0)}}catch{localStorage.removeItem(re),ae()}R(),ge(),V(),Y()}document.addEventListener("DOMContentLoaded",it);
