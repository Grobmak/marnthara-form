(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const et="input-ui/5.7.0",tt="https://your-make-webhook-url.com/your-unique-path",ve="marnthara.input.v5",rt=500,F={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"./assets/logo.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},ot=1.19599,$e={ROLL_WIDTH_M:.53,ROLL_LENGTH_M:10,STRIPS_PER_ROLL_UNDER_2_5M:3},_e={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},g={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",wallTpl:"#wallTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",allItemsContainer:"[data-all-items]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",sheerCodeWrap:"[data-sheer-code-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn"},h=e=>{typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return Number.isFinite(t)?t:0},Z=e=>{const t=h(e);return t>0?t.toFixed(2):""},D=(e,t=2,n=!1)=>Number.isFinite(e)?e.toLocaleString("en-US",{minimumFractionDigits:n?2:t,maximumFractionDigits:n?2:t}):"0",T=(e,t=0)=>Number.isFinite(e)?e.toLocaleString("th-TH",{minimumFractionDigits:t,maximumFractionDigits:t}):"0",nt=(e,t=150)=>{let n;return(...o)=>{clearTimeout(n),n=setTimeout(()=>e(...o),t)}},at=(e,t=700)=>{let n=!1;return(...o)=>{if(!n){n=!0;try{return e(...o)}finally{setTimeout(()=>{n=!1},t)}}}},q=e=>typeof e!="string"?"":e.replace(/[&<>"']/g,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}}),Ve=e=>typeof e!="string"?"":e.replace(/[\\/?%*:|"<>\x00-\x1f]/g,"").trim()||"file";function st(e){let t=h(e);if(isNaN(t))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";if(t===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const n=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"],o=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];let a=Math.floor(t),s=Math.round((t-a)*100);const r=c=>{if(c===0)return"";let i="";const m=String(c);for(let u=0;u<m.length;u++){const v=m[u];m.length-1;const y=m.length-u-1;v!=="0"&&(y===1&&v==="1"?i+=o[y]:y===1&&v==="2"?i+="‡∏¢‡∏µ‡πà"+o[y]:y===0&&v==="1"&&m.length>1?i+="‡πÄ‡∏≠‡πá‡∏î":i+=n[parseInt(v)]+o[y])}return i};let l="";if(a>0){const c=Math.floor(a/1e6),i=a%1e6;c>0&&(l+=r(c)+"‡∏•‡πâ‡∏≤‡∏ô"),l+=r(i),l+="‡∏ö‡∏≤‡∏ó"}let d="";return s>0?d=r(s)+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":l+="‡∏ñ‡πâ‡∏ß‡∏ô",(l+d).trim()}const Ie="marnthara.favorites.v4",ye={fabric:[],sheer:[],wallpaper:[],wooden_blind:[],roller_blind:[],vertical_blind:[],partition:[],pleated_screen:[],aluminum_blind:[]};function X(){try{const e=localStorage.getItem(Ie);return e?{...ye,...JSON.parse(e)}:ye}catch(e){return console.error("Failed to parse favorites from localStorage",e),ye}}function Se(e){try{localStorage.setItem(Ie,JSON.stringify(e))}catch(t){console.error("Failed to save favorites to localStorage",t)}}function Oe(e){if(!e||typeof e!="object")return console.error("Invalid favorites data for import."),!1;const t={...ye,...e};return Se(t),!0}function Ye(e){if(!e||typeof e!="object")return console.error("Invalid favorites data for merge."),0;const t=X();let n=0;for(const o in e)Object.hasOwnProperty.call(e,o)&&Array.isArray(e[o])&&(t[o]||(t[o]=[]),e[o].forEach(a=>{!t[o].some(r=>r.code===a.code)&&a.code&&(t[o].push(a),n++)}),t[o].sort((a,s)=>a.code.localeCompare(s.code)));return n>0&&Se(t),n}function lt(e,t,n){const o=X();o[e]||(o[e]=[]);const a=o[e],s=a.find(r=>r.code===t);return s?s.price=n:a.push({code:t,price:n}),a.sort((r,l)=>r.code.localeCompare(l.code)),Se(o),!0}function Te(e,t){const n=X();if(!n[e])return!1;const o=n[e].findIndex(a=>a.code===t);return o>-1?(n[e].splice(o,1),Se(n),!0):!1}function Ce(e,t){if(!e||!t)return;const n=X(),o=t.trim();return(n[e]||[]).find(s=>s.code===o)}function ct(e,t){return!!Ce(e,t)}function qe(e,t,n){const o=Ce(e,t);return o&&o.price===n?(Te(e,t),!1):(lt(e,t,n),!0)}function it(){localStorage.removeItem(Ie),console.log("All favorites have been cleared.")}function O(){var n,o,a,s,r,l;const e=X(),t={app_version:et,customer_name:((n=document.querySelector('[name="customer_name"]'))==null?void 0:n.value)||"",customer_phone:((o=document.querySelector('[name="customer_phone"]'))==null?void 0:o.value)||"",customer_address:((a=document.querySelector('[name="customer_address"]'))==null?void 0:a.value)||"",customer_card_open:(s=document.querySelector("#customerDetailsCard"))==null?void 0:s.open,discount:{type:((r=document.querySelector("#discount_type"))==null?void 0:r.value)||"amount",value:h((l=document.querySelector("#discount_value"))==null?void 0:l.value)},rooms:[],favorites:e};return document.querySelectorAll(g.room).forEach(d=>{var i,m;const c={id:d.id,room_name:((i=d.querySelector(g.roomNameInput))==null?void 0:i.value)||"",is_suspended:d.classList.contains("is-suspended"),is_open:d.open,items:[]};(m=d.querySelector(g.allItemsContainer))==null||m.childNodes.forEach(u=>{var f,p,_,S,x,$,b,k,E,B,N,L,I,A,U,R,Y,z,oe,H,pe,Fe,Pe,Re;if(u.nodeType!==1||!u.matches(".item-card"))return;const v=u.dataset.type;if(!v)return;let y={type:v,is_suspended:u.classList.contains("is-suspended")};v==="set"?Object.assign(y,{width_m:h((f=u.querySelector('input[name="width_m"]'))==null?void 0:f.value),height_m:h((p=u.querySelector('input[name="height_m"]'))==null?void 0:p.value),style:((_=u.querySelector('select[name="set_style"]'))==null?void 0:_.value)||"",fabric_variant:((S=u.querySelector('select[name="fabric_variant"]'))==null?void 0:S.value)||"",price_per_m_raw:h((x=u.querySelector('select[name="set_price_per_m"]'))==null?void 0:x.value),sheer_price_per_m:h(($=u.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:$.value),fabric_code:((b=u.querySelector('input[name="fabric_code"]'))==null?void 0:b.value)||"",sheer_fabric_code:((k=u.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:k.value)||"",opening_style:((E=u.querySelector('select[name="opening_style"]'))==null?void 0:E.value)||"",track_color:((B=u.querySelector('input[name="track_color"]'))==null?void 0:B.value)||"‡∏Ç‡∏≤‡∏ß",bracket_color:((N=u.querySelector('input[name="bracket_color"]'))==null?void 0:N.value)||"‡∏Ç‡∏≤‡∏ß",finial_color:((L=u.querySelector('input[name="finial_color"]'))==null?void 0:L.value)||"‡∏Ç‡∏≤‡∏ß",grommet_color:((I=u.querySelector('input[name="grommet_color"]'))==null?void 0:I.value)||"‡πÄ‡∏á‡∏¥‡∏ô",notes:((A=u.querySelector('input[name="notes"]'))==null?void 0:A.value)||""}):v==="wallpaper"?Object.assign(y,{height_m:h((U=u.querySelector('[name="wallpaper_height_m"]'))==null?void 0:U.value),wallpaper_code:((R=u.querySelector('[name="wallpaper_code"]'))==null?void 0:R.value)||"",price_per_roll:h((Y=u.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:Y.value),install_cost_per_roll:h((z=u.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:z.value),notes:((oe=u.querySelector('[name="wallpaper_notes"]'))==null?void 0:oe.value)||"",widths:Array.from(u.querySelectorAll('[name="wall_width_m"]')).map(Ze=>h(Ze.value))}):u.matches(".area-based-item")&&Object.assign(y,{width_m:h((H=u.querySelector('[name="area_width_m"]'))==null?void 0:H.value),height_m:h((pe=u.querySelector('[name="area_height_m"]'))==null?void 0:pe.value),price_sqyd:h((Fe=u.querySelector('[name="area_price_sqyd"]'))==null?void 0:Fe.value),code:((Pe=u.querySelector('[name="area_code"]'))==null?void 0:Pe.value)||"",notes:((Re=u.querySelector('[name="area_notes"]'))==null?void 0:Re.value)||""}),c.items.push(y)}),t.rooms.push(c)}),t}function C(){try{localStorage.setItem(ve,JSON.stringify(O()))}catch(e){console.error("Failed to save data to localStorage:",e)}}const M={stylePlus:e=>_e.style_surcharge[e]??0,heightPlus:e=>{const t=[..._e.height].sort((n,o)=>o.threshold-n.threshold);for(const n of t)if(e>n.threshold)return n.add_per_m;return 0},fabricYardage:(e,t)=>{const n=h(t);return n<=0||!e?0:e==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||e==="‡∏à‡∏µ‡∏ö"?(n*2+.6)/.9:e==="‡∏•‡∏≠‡∏ô"?(n*2.6+.6)/.9:0},calculateGrommets:e=>{const t=h(e);if(t<=0)return 0;const a=Math.ceil(t/.3)*.3/.15;return Math.round(a)},wallpaperRolls:(e,t)=>{const n=h(e),o=h(t);if(n<=0||o<=0)return 0;const a=o>2.5?Math.floor($e.ROLL_LENGTH_M/o):$e.STRIPS_PER_ROLL_UNDER_2_5M;if(a<=0)return 0;const s=Math.ceil(n/$e.ROLL_WIDTH_M);return Math.ceil(s/a)},calculateSetPrice:function(e){var r,l;if(!e||e.is_suspended||h(e.width_m)<=0)return{total:0,opaque:0,sheer:0};const t=this.stylePlus(e.style),n=this.heightPlus(h(e.height_m)),o=h(e.width_m),a=(r=e.fabric_variant)!=null&&r.includes("‡∏ó‡∏∂‡∏ö")&&h(e.price_per_m_raw)>0?(h(e.price_per_m_raw)+t+n)*o:0,s=(l=e.fabric_variant)!=null&&l.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&h(e.sheer_price_per_m)>0?(h(e.sheer_price_per_m)+t+n)*o:0;return{total:Math.round(a+s),opaque:Math.round(a),sheer:Math.round(s)}},calculateDecoPrice:function(e){if(!e||e.is_suspended||h(e.width_m)<=0||h(e.height_m)<=0)return{total:0,sqm:0,sqyd:0};const t=h(e.width_m)*h(e.height_m),n=t*ot,o=n*h(e.price_sqyd);return{total:Math.round(o),sqm:t,sqyd:n}},calculateWallpaperPrice:function(e){var r;if(!e||e.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const t=((r=e.widths)==null?void 0:r.reduce((l,d)=>l+h(d),0))||0;if(t<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const n=h(e.height_m),o=this.wallpaperRolls(t,n),a=o*h(e.price_per_roll),s=o*h(e.install_cost_per_roll??300);return{total:Math.round(a+s),material:Math.round(a),install:Math.round(s),rolls:o,sqm:t*n}}},ee={set:"‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô",wallpaper:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå",wooden_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ",roller_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô",vertical_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á",partition:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á",pleated_screen:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö",aluminum_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°"};function ae(e){const{width:t=0,height:n=0}=e,o=15,a=100-o*2,s=100-o*2,r=t>0&&n>0?Math.min(a/t,s/n):1,l=t*r,d=n*r,c=(100-l)/2,i=(100-d)/2,m=`
        <line x1="${c}" y1="${i+d+5}" x2="${c+l}" y2="${i+d+5}" class="dimension-line" />
        <line x1="${c}" y1="${i+d+3}" x2="${c}" y2="${i+d+7}" class="dimension-tick" />
        <line x1="${c+l}" y1="${i+d+3}" x2="${c+l}" y2="${i+d+7}" class="dimension-tick" />
        <text x="50" y="${i+d+14}" class="dimension-text">${t.toFixed(2)} ‡∏°.</text>

        <line x1="${c-5}" y1="${i}" x2="${c-5}" y2="${i+d}" class="dimension-line" />
        <line x1="${c-7}" y1="${i}" x2="${c-3}" y2="${i}" class="dimension-tick" />
        <line x1="${c-7}" y1="${i+d}" x2="${c-3}" y2="${i+d}" class="dimension-tick" />
        <text x="${c-9}" y="50" class="dimension-text" transform="rotate(-90, ${c-9}, 50)">${n.toFixed(2)} ‡∏°.</text>
    `;return{x:c,y:i,svgWidth:l,svgHeight:d,lines:m}}function dt(e){const t=h(e.width_m),n=h(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:o,y:a,svgWidth:s,svgHeight:r,lines:l}=ae({width:t,height:n});let d="";const c=e.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á"),i=e.fabric_variant.includes("‡∏ó‡∏∂‡∏ö"),m=(f,p)=>e.opening_style==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?`
                <rect x="${o}" y="${a+p}" width="${s/2-1}" height="${r}" class="${f}" />
                <rect x="${o+s/2+1}" y="${a+p}" width="${s/2-1}" height="${r}" class="${f}" />
            `:`<rect x="${o}" y="${a+p}" width="${s}" height="${r}" class="${f}" />`;c&&(d+=m("curtain-panel-sheer",0)),i&&(d+=m("curtain-panel-opaque",c?-2:0));let u="";if(e.style==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"){const f=Math.max(8,Math.floor(s/8));for(let p=0;p<f;p++){const _=o+s/(f-1)*p;u+=`<circle cx="${_}" cy="${a}" r="2" class="style-grommet" />`}}else if(e.style==="‡∏•‡∏≠‡∏ô"){const f=Math.max(4,Math.floor(s/10));let p=`M ${o},${a}`;for(let _=0;_<f;_++)p+=" q 5,-4 10,0";u=`<path d="${p}" class="style-ripplefold-path" />`}else e.style==="‡∏à‡∏µ‡∏ö"&&(u=`<text x="${o+2}" y="${a+5}" class="style-pleat-text">||| ||| ||| ||| |||</text>`);const v=e.opening_style==="‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á"?"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á":t>n?"‚Üí":"‚Üì",y=`<text x="50" y="${a+r/2}" class="opening-text">${v}</text>`;return`<svg viewBox="0 0 100 100">${d}${u}${y}${l}</svg>`}function He(e,t=!1){const n=h(e.width_m),o=h(e.height_m);if(n<=0||o<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:a,y:s,svgWidth:r,svgHeight:l,lines:d}=ae({width:n,height:o});let c=`<rect x="${a}" y="${s}" width="${r}" height="${l}" class="blind-frame" />`;if(t){const i=Math.max(4,Math.floor(r/8)),m=r/i;for(let u=0;u<i;u++)c+=`<rect x="${a+u*m+1}" y="${s}" width="${m-2}" height="${l}" class="blind-slat" />`}else{const i=Math.max(3,Math.floor(l/10)),m=l/i;for(let u=0;u<i;u++)c+=`<rect x="${a}" y="${s+u*m+.5}" width="${r}" height="${m-1}" class="blind-slat" />`}return`<svg viewBox="0 0 100 100">${c}${d}</svg>`}function ut(e){const t=h(e.width_m),n=h(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:o,y:a,svgWidth:s,svgHeight:r,lines:l}=ae({width:t,height:n});let d=`<rect x="${o}" y="${a}" width="${s}" height="${r}" class="blind-frame" />`;const c=Math.max(3,Math.floor(r/8)),i=r/c;for(let f=0;f<c;f++)d+=`<rect x="${o+1}" y="${a+f*i}" width="${s-2}" height="${i-1.5}" rx="0.5" class="wooden-blind-slat" />`;const m=Math.max(2,s*.05),u=o+s*.25-m/2,v=o+s*.75-m/2,y=`
        <rect x="${u}" y="${a}" width="${m}" height="${r}" class="wooden-blind-strip" />
        <rect x="${v}" y="${a}" width="${m}" height="${r}" class="wooden-blind-strip" />
    `;return`<svg viewBox="0 0 100 100">${d}${y}${l}</svg>`}function mt(e){const t=h(e.width_m),n=h(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:o,y:a,svgWidth:s,svgHeight:r,lines:l}=ae({width:t,height:n});return`<svg viewBox="0 0 100 100">${`
        <rect x="${o}" y="${a}" width="${s}" height="${r}" class="roller-fabric" />
        <rect x="${o-1}" y="${a-4}" width="${s+2}" height="5" rx="2" class="roller-roll" />
        <line x1="${o}" y1="${a+r}" x2="${o+s}" y2="${a+r}" class="roller-bar" />
    `}${l}</svg>`}function De(e,t=!1){const n=h(e.width_m),o=h(e.height_m);if(n<=0||o<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:a,y:s,svgWidth:r,svgHeight:l,lines:d}=ae({width:n,height:o});let c="";if(t)c=`
            <defs>
                <pattern id="pleated-mesh" width="6" height="6" patternUnits="userSpaceOnUse">
                    <path d="M -1 1 L 1 -1 M 0 6 L 6 0" class="pleated-screen-mesh" />
                </pattern>
            </defs>
            <rect x="${a}" y="${s}" width="${r}" height="${l}" class="blind-frame" />
            <rect x="${a}" y="${s}" width="${r}" height="${l}" fill="url(#pleated-mesh)" />
        `;else{const m=r/4;for(let u=0;u<4;u++)c+=`<rect x="${a+u*m}" y="${s}" width="${m}" height="${l}" class="partition-panel" />`,u>0&&(c+=`<line x1="${a+u*m}" y1="${s}" x2="${a+u*m}" y2="${s+l}" class="partition-hinge" />`)}return`<svg viewBox="0 0 100 100">${c}${d}</svg>`}function pt(e){const t=(e.widths||[]).reduce((u,v)=>u+h(v),0),n=h(e.height_m);if(t<=0||n<=0)return'<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î</text></svg>';const{x:o,y:a,svgWidth:s,svgHeight:r,lines:l}=ae({width:t,height:n});let d="";const c=Math.floor(s/10),i=Math.floor(r/10);for(let u=0;u<i;u++)for(let v=0;v<c;v++)d+=`<circle cx="${o+v*10+5}" cy="${a+u*10+5}" r="1.5" class="wallpaper-pattern" />`;return`<svg viewBox="0 0 100 100">${`<rect x="${o}" y="${a}" width="${s}" height="${r}" class="blind-frame" /> ${d}`}${l}</svg>`}function ft(e){switch(e.type){case"set":return dt(e);case"wooden_blind":return ut(e);case"aluminum_blind":return He(e,!1);case"vertical_blind":return He(e,!0);case"roller_blind":return mt(e);case"partition":return De(e,!1);case"pleated_screen":return De(e,!0);case"wallpaper":return pt(e);default:const t=ee[e.type]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";return`<svg viewBox="0 0 100 100"><text x="50" y="50" class="fallback-text">${q(t)}</text></svg>`}}function je(e){let t=`
üìÉ *‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤*
`,n=!1;return e.rooms.forEach(o=>{if(o.is_suspended||!o.items)return;const a=o.items.filter(r=>r.is_suspended?!1:r.type==="wallpaper"?(r.widths||[]).reduce((l,d)=>l+h(d),0)>0:h(r.width_m)>0);if(a.length===0)return;n=!0,t+=`
*üö™ ‡∏´‡πâ‡∏≠‡∏á: ${o.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let s=0;a.forEach(r=>{s++;const l=ee[r.type]||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";r.type==="set"?t+=` ${s}) ${l} ${r.style} (${r.fabric_variant})
`:t+=` ${s}) ${l}
`})}),n?t+`------------------------------
`:""}function Je(e){return e.rooms.reduce((t,n)=>{var a;if(n.is_suspended)return t;const o=((a=n.items)==null?void 0:a.reduce((s,r)=>{if(r.is_suspended)return s;switch(r.type){case"set":return s+M.calculateSetPrice(r).total;case"wallpaper":return s+M.calculateWallpaperPrice(r).total;default:return s+M.calculateDecoPrice(r).total}},0))||0;return t+o},0)}function ht(e,t){const n=Je(e);let o=0,a="";e.discount&&e.discount.value>0&&(e.discount.type==="percent"?(o=n*(e.discount.value/100),a=`üè∑Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (${e.discount.value}%): -${T(o)} ‡∏ö‡∏≤‡∏ó
`):(o=e.discount.value,a=`üè∑Ô∏è ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: -${T(o)} ‡∏ö‡∏≤‡∏ó
`));const s=n-o;let r=`üóìÔ∏è ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"short",year:"2-digit"})})
`;if(r+=`üë§ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${e.customer_name||"-"}
`,(t==="customer"||t==="owner")&&(r+=`üìû ‡πÇ‡∏ó‡∏£: ${e.customer_phone||"-"}
`,r+=`üè† ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${e.customer_address||"-"}
`),r+=`------------------------------
`,t==="customer")return r+=je(e),o>0&&(r+=`
‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(n)} ‡∏ö‡∏≤‡∏ó
`,r+=a),r+=`
üí∞ *‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${T(s)} ‡∏ö‡∏≤‡∏ó*
`,r+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏∞
${F.name}
‡πÇ‡∏ó‡∏£: ${F.phone}`,r;if(t==="purchase_order"||t==="owner"){t==="owner"&&(r+=je(e));const l={opaqueFabrics:[],sheerFabrics:[],decorations:{},wallpapers:[],allSets:[]};e.rooms.forEach(f=>{f.is_suspended||!f.items||f.items.forEach(p=>{const _=p.type==="set"||p.type.includes("_blind")||p.type==="partition"||p.type==="pleated_screen";if(!(p.is_suspended||_&&h(p.width_m)<=0))switch(p.type){case"set":l.allSets.push(p),p.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&l.opaqueFabrics.push({code:p.fabric_code||"??",yards:M.fabricYardage(p.style,p.width_m)}),p.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&l.sheerFabrics.push({code:p.sheer_fabric_code||"??",yards:M.fabricYardage(p.style,p.width_m)});break;case"wallpaper":const S=(p.widths||[]).reduce(($,b)=>$+h(b),0);if(S>0){const $=M.wallpaperRolls(S,p.height_m);$>0&&l.wallpapers.push({code:p.wallpaper_code||"xxx",rolls:$})}break;default:const x=ee[p.type]||p.type;l.decorations[x]||(l.decorations[x]=[]),l.decorations[x].push({code:p.code||"xxx",width:p.width_m,height:p.height_m});break}})});const d={};if([...l.opaqueFabrics,...l.sheerFabrics].forEach(f=>{d[f.code]=(d[f.code]||0)+f.yards}),Object.keys(d).length>0){r+=`‚úÇÔ∏è *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (‡∏ú‡πâ‡∏≤)*
`,r+=`------------------------------
`,l.opaqueFabrics.length>0&&l.opaqueFabrics.forEach(f=>{r+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain)
`,r+=`  ‡∏£‡∏´‡∏±‡∏™: #${f.code||"??"}
`,r+=`  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${f.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),l.sheerFabrics.length>0&&l.sheerFabrics.forEach(f=>{r+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer)
`,r+=`  ‡∏£‡∏´‡∏±‡∏™: #${f.code||"??"}
`,r+=`  ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${f.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),r+=`------------------------------
`,r+=`üìä *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ú‡πâ‡∏≤ (‡∏ï‡∏≤‡∏°‡∏£‡∏´‡∏±‡∏™)*
`,r+=`------------------------------
`;for(const[f,p]of Object.entries(d))r+=`  - ‡∏£‡∏´‡∏±‡∏™ #${f}: ${p.toFixed(2)} ‡∏´‡∏•‡∏≤
`;r+=`
`}const c=l.allSets.filter(f=>f.style==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"),i=l.allSets.filter(f=>f.style!=="‡∏ï‡∏≤‡πÑ‡∏Å‡πà");if(i.length>0){r+=`------------------------------
`,r+=`üìè *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á (‡∏•‡∏≠‡∏ô/‡∏à‡∏µ‡∏ö)*
`,r+=`------------------------------

`;let f=1;i.forEach(p=>{r+=`(${f++}) ‡∏£‡∏≤‡∏á ${p.style}, ‡∏™‡∏µ: ${p.track_color}
`,p.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${Number(p.width_m).toFixed(2)} ‡∏°.
`),p.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${Number(p.width_m).toFixed(2)} ‡∏°.
`),p.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"&&(r+=`  (‚ùóÔ∏è‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô)
`),p.notes&&t==="owner"&&(r+=`  üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${p.notes}
`),r+=`
`})}if(c.length>0){r+=`------------------------------
`,r+=`üìè *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á (‡∏ï‡∏≤‡πÑ‡∏Å‡πà)*
`,r+=`------------------------------

`;let f=1;c.forEach(b=>{r+=`(${f++}) ‡∏£‡∏≤‡∏á ${b.style}, ‡∏™‡∏µ: ${b.track_color}
`,b.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${Number(b.width_m).toFixed(2)} ‡∏°.
`),b.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${Number(b.width_m).toFixed(2)} ‡∏°.
`),b.notes&&t==="owner"&&(r+=`  üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ${b.notes}
`),r+=`
`}),r+=`--- ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡πÑ‡∏Å‡πà ---
`;const p=[];c.forEach(b=>{b.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&p.push(Number(b.width_m)),b.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&p.push(Number(b.width_m))});const _=6;p.sort((b,k)=>k-b);const S=[];for(const b of p){let k=!1;for(let E=0;E<S.length;E++)if(S[E]>=b-.001){S[E]-=b,k=!0;break}k||S.push(_-b)}r+=`‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏° (6 ‡∏°.) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: *${S.length} ‡πÄ‡∏™‡πâ‡∏ô*

`;const x=p.reduce((b,k)=>{const E=k.toFixed(2);return b[E]=(b[E]||0)+1,b},{}),$=Object.entries(x).sort((b,k)=>parseFloat(k[0])-parseFloat(b[0]));if($.length>0){r+=`*‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î:*
`;for(const[b,k]of $)r+=`  - ‡∏Ç‡∏ô‡∏≤‡∏î ${b} ‡∏°. = ${k} ‡πÄ‡∏™‡πâ‡∏ô
`;r+=`
`}}const m={};c.forEach(f=>{const p=f.track_color||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏",_=f.grommet_color||"‡πÄ‡∏á‡∏¥‡∏ô",S=`${p}|${_}`;m[S]||(m[S]={trackColor:p,grommetColor:_,grommets:0,brackets:0,finials:0}),m[S].grommets+=M.calculateGrommets(f.width_m),m[S].brackets+=h(f.width_m)>=1.6?3:2,m[S].finials+=f.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"?4:2});const u=l.allSets.length*2;(Object.keys(m).length>0||u>0)&&(r+=`------------------------------
`,r+=`üî© *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (Hardware)*
`,r+=`------------------------------

`,Object.values(m).forEach(f=>{f.grommets>0&&(r+=`  - ‡∏ï‡∏≤‡πÑ‡∏Å‡πà (‡∏™‡∏µ${f.grommetColor}): ${f.grommets} ‡∏ï‡∏±‡∏ß
`),f.brackets>0&&(r+=`  - ‡∏Ç‡∏≤‡∏à‡∏±‡∏ö (‡∏™‡∏µ${f.trackColor}): ${f.brackets} ‡∏ï‡∏±‡∏ß
`),f.finials>0&&(r+=`  - ‡∏´‡∏±‡∏ß‡∏£‡∏≤‡∏á (‡∏™‡∏µ${f.trackColor}): ${f.finials} ‡∏ï‡∏±‡∏ß
`)}),u>0&&(r+=`  - ‡∏ï‡∏∞‡∏Ç‡∏≠‡∏£‡∏ß‡∏ö‡∏°‡πà‡∏≤‡∏ô: ${u} ‡∏ï‡∏±‡∏ß
`),r+=`
`);const v=l.decorations;Object.keys(v).length>0&&Object.entries(v).forEach(([f,p])=>{r+=`------------------------------
`,r+=`üì¶ *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ${f}*
`,r+=`------------------------------

`,p.forEach(_=>{r+=`- ‡∏£‡∏´‡∏±‡∏™: #${_.code||"xxx"}
  ‡∏Ç‡∏ô‡∏≤‡∏î: ${_.width.toFixed(2)} x ${_.height.toFixed(2)} m.

`})});const y={};if(l.wallpapers.forEach(f=>{y[f.code]=(y[f.code]||0)+f.rolls}),Object.keys(y).length>0){r+=`------------------------------
`,r+=`üé® *‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Wallpaper)*
`,r+=`------------------------------

`;for(const[f,p]of Object.entries(y))r+=`  - ‡∏£‡∏´‡∏±‡∏™ #${f}: ${p} ‡∏°‡πâ‡∏ß‡∏ô
`;r+=`
`}if(t==="purchase_order")return r+=`------------------------------
`,r}if(t==="seamstress"||t==="owner"){r+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏¢‡πá‡∏ö‡∏ú‡πâ‡∏≤*
`;let l=0;if(e.rooms.forEach(d=>{if(d.is_suspended||!d.items)return;const c=d.items.filter(i=>i.type==="set"&&!i.is_suspended&&h(i.width_m)>0);c.length!==0&&(l>0&&(r+=`==============================
`),r+=`
*üö™ ‡∏´‡πâ‡∏≠‡∏á: ${d.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*

`,c.forEach((i,m)=>{m>0&&(r+=`--------------------
`),r+=`*‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà ${m+1}/${c.length}: ${i.style} ${i.fabric_variant}*
`,r+=`  - ‡∏Ç‡∏ô‡∏≤‡∏î: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${Number(i.width_m).toFixed(2)} x ‡∏™‡∏π‡∏á ${Number(i.height_m).toFixed(2)} ‡∏°.
`,r+=`  - ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${i.opening_style}
`,i.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: #${i.fabric_code||"-"}
`),i.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: #${i.sheer_fabric_code||"-"}
`)}),r+=`
`,l++)}),l>0?r+=`==============================
`:r+=`‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á
------------------------------
`,t==="seamstress")return r}return t==="owner"&&(r+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${T(s)} ‡∏ö‡∏≤‡∏ó*
`),r}function vt(e){if(!e.rooms||e.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let t="";const n={};e.rooms.forEach(r=>{r.is_suspended||!r.items||r.items.forEach(l=>{if(l.is_suspended)return;let d=null,c=0;switch(l.type){case"set":c=M.calculateSetPrice(l).total,c>0&&(d=l.type);break;case"wallpaper":c=M.calculateWallpaperPrice(l).total,c>0&&(d=l.type);break;default:c=M.calculateDecoPrice(l).total,c>0&&(d=l.type);break}d&&(n[d]=(n[d]||0)+1)})});const o=Object.entries(n).map(([r,l])=>{const d=ee[r]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";return`
            <span class="summary-tag" data-filter-type="${q(r)}" title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ">
                ${q(d)} <strong>${l}</strong>
            </span>`}).join("");o&&(t+=`
            <div class="overview-summary-group">
                <h4><i class="ph ph-stack"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h4>
                <div class="summary-tags-container">
                    ${o}
                </div>
            </div>`);let a="",s=0;return e.rooms.forEach(r=>{if(r.is_suspended||!r.items)return;const l={};let d=0;if(r.items.forEach(c=>{if(c.is_suspended)return;let i=null,m=0;switch(c.type){case"set":m=M.calculateSetPrice(c).total,m>0&&(i=c.type);break;case"wallpaper":m=M.calculateWallpaperPrice(c).total,m>0&&(i=c.type);break;default:m=M.calculateDecoPrice(c).total,m>0&&(i=c.type);break}i&&(l[i]=(l[i]||0)+1,d++)}),d>0){s+=d;const c=Object.entries(l).map(([i,m])=>`
                    <div class="overview-item">
                        <span>${q(ee[i]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á")}</span>
                        <span>${m}</span>
                    </div>`).join("");a+=`
                <details class="overview-room-card">
                    <summary class="overview-room-summary">
                        <span class="room-name">${q(r.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</span>
                        <div class="summary-tags">
                            <span class="room-item-count">${d} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                            <i class="ph ph-caret-down expand-icon"></i>
                        </div>
                    </summary>
                    <div class="overview-room-items">${c}</div>
                </details>`}}),a&&(t+=`
            <div class="overview-breakdown-group">
                <h4><i class="ph ph-map-pin-line"></i> ‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏ï‡∏≤‡∏°‡∏´‡πâ‡∏≠‡∏á</h4>
                ${a}
            </div>`),s===0?'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>':t}function yt(e,t){const{vatRate:n,pageBreakBuffer:o=3}=t,a=[];e.rooms.forEach(B=>{if(B.is_suspended||!B.items)return;const N=[];B.items.forEach(L=>{if(L.is_suspended)return;let I,A,U,R;const Y=ee[L.type]||"‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";switch(L.type){case"set":A=M.calculateSetPrice(L).total,A>0&&(U=h(L.width_m),R=h(L.height_m),I=`${Y} ${q(L.style)} (${q(L.fabric_variant)}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${U.toFixed(2)} x ${R.toFixed(2)} ‡∏°.${L.notes?` - ${q(L.notes)}`:""}</small>`,N.push({description:I,total:A,units:I.includes("<br>")?1.5:1}));break;case"wallpaper":if(A=M.calculateWallpaperPrice(L).total,A>0){const z=(L.widths||[]).reduce((H,pe)=>H+h(pe),0),oe=M.wallpaperRolls(z,L.height_m);R=h(L.height_m),I=`${Y} <br><small>‡∏£‡∏´‡∏±‡∏™: ${q(L.wallpaper_code)||"-"}, ‡∏™‡∏π‡∏á ${R.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${oe} ‡∏°‡πâ‡∏ß‡∏ô)</small>`,N.push({description:I,total:A,units:I.includes("<br>")?1.5:1})}break;default:A=M.calculateDecoPrice(L).total,A>0&&(U=h(L.width_m),R=h(L.height_m),I=`${Y} <br><small>‡∏£‡∏´‡∏±‡∏™: ${q(L.code)||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${U.toFixed(2)} x ${R.toFixed(2)} ‡∏°.</small>`,N.push({description:I,total:A,units:I.includes("<br>")?1.5:1}));break}}),N.length>0&&(a.push({isRoomHeader:!0,roomName:q(B.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),a.push(...N))});const s=a.reduce((B,N)=>B+(N.total||0),0);if(s===0)return null;let r=0,l="",d=s;e.discount&&e.discount.value>0&&(e.discount.type==="percent"?(r=s*(e.discount.value/100),l=`<tr><td class="pdf-label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î (${e.discount.value}%)</td><td class="pdf-amount">-${D(r,2,!0)}</td></tr>`):(r=e.discount.value,l=`<tr><td class="pdf-label">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td><td class="pdf-amount">-${D(r,2,!0)}</td></tr>`),d=s-r,l+=`<tr><td class="pdf-label">‡∏¢‡∏≠‡∏î‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</td><td class="pdf-amount">${D(d,2,!0)}</td></tr>`);const c=d*n,i=d+c,m=17,u=23,v=[];let y=[],f=0;a.forEach((B,N)=>{const L=v.length===0?m:u,I=f+B.units>L;let A=!1;if(!I&&N<a.length-1){const U=L-(f+B.units);U>0&&U<o&&(A=!0)}(I||A)&&y.length>0&&(v.push(y),y=[],f=0),y.push(B),f+=B.units}),y.length>0&&v.push(y);const p=new Date,_=p.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),S=`QT-${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`;let x="",$=0,b=1;v.forEach((B,N)=>{const L=N===0,I=N===v.length-1,A=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${F.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong><i class="ph ph-github-logo"></i> ${q(F.name)}</strong><br>
                            ${q(F.address).replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${q(F.phone)} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${q(F.taxId)}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${v.length>1?L?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${S}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${_}</td></tr>
                        </table>
                    </div>
                </div>
                ${L?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${q(e.customer_name)||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${q(e.customer_address).replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${q(e.customer_phone)||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${q(F.pdf.paymentTerms)}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${q(F.pdf.priceValidity)}
                    </div>
                </section>`:""}
            </div>`,U=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span><i class="ph ph-github-logo"></i> ${q(F.name)} | ‡πÇ‡∏ó‡∏£: ${q(F.phone)}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${N+1} / ${v.length}</span>
                </div>
            </div>`;let R="";L||(R+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${D($,2,!0)}</td></tr>`),B.forEach(H=>{H.isRoomHeader?R+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${H.roomName}</td></tr>`:(R+=`<tr><td class="pdf-text-center">${b++}</td><td>${H.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${D(H.total,2,!0)}</td><td class="pdf-text-right">${D(H.total,2,!0)}</td></tr>`,$+=H.total)});let Y="";I||(Y=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${D($,2,!0)}</td></tr></tfoot>`);let z="";F.pdf.notes&&F.pdf.notes.length>0&&(z=`
                <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                <ul>${F.pdf.notes.map(H=>`<li>${q(H)}</li>`).join("")}</ul>
            `);const oe=I?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        ${z}
                        <div class="pdf-amount-text">( ${st(i)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${D(s,2,!0)}</td></tr>
                            ${l}
                            ${n>0?`<tr><td class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(n*100).toFixed(0)}%</td><td class="pdf-amount">${D(c,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${D(i,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(<i class="ph ph-github-logo"></i> ${q(F.name)})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${_}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";x+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${A}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${R}</tbody>
                            ${Y}
                        </table>
                        ${oe}
                    </div>
                    ${U}
                </div>
            </div>`});const k=e.customer_name||"quote",E=Ve(k);return{html:`<div id="quotation-template">${x}</div>`,fileName:`${S}_${E}`}}function gt(e){var l;const t=Je(e);let n=0;((l=e.discount)==null?void 0:l.value)>0&&(n=e.discount.type==="percent"?t*(e.discount.value/100):e.discount.value);const o=t-n;let a=!1,s=e.rooms.map(d=>{if(d.is_suspended)return"";const c=d.items.filter(m=>!m.is_suspended&&(h(m.width_m)>0||m.type==="wallpaper"&&(m.widths||[]).reduce((u,v)=>u+h(v),0)>0));if(c.length===0)return"";const i=c.map(m=>{let u="",v="";if(m.type!=="set"){const y=ee[m.type]||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á";v=`<h5 class="lookbook-item-title">${q(y)}</h5>`}switch(m.type){case"set":u=`
                        <tr><td>‡πÅ‡∏ö‡∏ö</td><td>${q(m.style)} (${q(m.fabric_variant)})</td></tr>
                        ${m.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")?`<tr><td>‡∏ó‡∏∂‡∏ö</td><td>#${q(m.fabric_code)||"-"}</td></tr>`:""}
                        ${m.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")?`<tr><td>‡πÇ‡∏õ‡∏£‡πà‡∏á</td><td>#${q(m.sheer_fabric_code)||"-"}</td></tr>`:""}
                        <tr><td>‡∏Ç‡∏ô‡∏≤‡∏î</td><td>${h(m.width_m).toFixed(2)} x ${h(m.height_m).toFixed(2)} ‡∏°.</td></tr>
                    `;break;case"wallpaper":const y=(m.widths||[]).reduce((p,_)=>p+h(_),0),f=M.wallpaperRolls(y,m.height_m);u=`
                        <tr><td>‡∏£‡∏´‡∏±‡∏™</td><td>#${q(m.wallpaper_code)||"-"}</td></tr>
                        <tr><td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</td><td>${f} ‡∏°‡πâ‡∏ß‡∏ô</td></tr>
                        <tr><td>‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏£‡∏ß‡∏°</td><td>${y.toFixed(2)} ‡∏°.</td></tr>
                        <tr><td>‡∏™‡∏π‡∏á</td><td>${h(m.height_m).toFixed(2)} ‡∏°.</td></tr>
                    `;break;default:u=`
                        <tr><td>‡∏£‡∏´‡∏±‡∏™</td><td>#${q(m.code)||"-"}</td></tr>
                        <tr><td>‡∏Ç‡∏ô‡∏≤‡∏î</td><td>${h(m.width_m).toFixed(2)} x ${h(m.height_m).toFixed(2)} ‡∏°.</td></tr>
                    `;break}return u&&(a=!0),`
                 <div class="lookbook-details">
                    <div class="visual-placeholder">
                        ${ft(m)}
                    </div>
                    <div class="spec-table-wrapper">
                        ${v}
                        <table class="spec-table">
                            ${u}
                        </table>
                    </div>
                </div>
            `}).join('<hr class="lookbook-hr">');return i.trim()?`
            <div class="lookbook-room">
                <h4><i class="ph ph-map-pin"></i> ${q(d.room_name)}</h4>
                ${i}
            </div>
        `:""}).join("");return a?`
        <div class="lookbook-summary">
            <div class="lookbook-customer-info">
                <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${q(e.customer_name)||"-"}<br/>
                <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${q(e.customer_address)||"-"}
            </div>
            <div class="lookbook-totals">
                <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î): ${T(t)} ‡∏ö‡∏≤‡∏ó</span>
                ${n>0?`<span>‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î: -${T(n)} ‡∏ö‡∏≤‡∏ó</span>`:""}
                <span class="grand-total">‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥: ${T(o)} ‡∏ö‡∏≤‡∏ó</span>
            </div>
        </div>
    `+s:'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>'}const le=[],_t=10;function te(e){le.push(e),le.length>_t&&le.shift()}function bt(){return le.pop()}function St(){return le.length>0}let V=!1,be=null,P=null,fe=null,ce=!1,j=null,xe=null,ke=!1;const We=document.querySelector("#undoBtn"),he={};function wt(e){if(he[e])return he[e];const t=new Promise((n,o)=>{const a=document.createElement("script");a.src=e,a.onload=()=>{console.log(`${e} loaded successfully.`),n()},a.onerror=()=>{console.error(`Script load error for ${e}`),delete he[e],o(new Error(`Script load error for ${e}`))},document.head.appendChild(a)});return he[e]=t,t}const Q={set:{templateId:"#setTpl",name:"‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô",detailsTemplateId:"#setDetailsTpl"},wallpaper:{templateId:"#wallpaperTpl",name:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå",detailsTemplateId:"#wallpaperDetailsTpl"},wooden_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ",detailsTemplateId:"#areaBasedDetailsTpl"},roller_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô",detailsTemplateId:"#areaBasedDetailsTpl"},vertical_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á",detailsTemplateId:"#areaBasedDetailsTpl"},partition:{templateId:"#areaBasedTpl",name:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á",detailsTemplateId:"#areaBasedDetailsTpl"},pleated_screen:{templateId:"#areaBasedTpl",name:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö",detailsTemplateId:"#areaBasedDetailsTpl"},aluminum_blind:{templateId:"#areaBasedTpl",name:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°",detailsTemplateId:"#areaBasedDetailsTpl"}},$t={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"wooden_blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"roller_blind",‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"vertical_blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"pleated_screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"aluminum_blind"},Me="marnthara.theme";function Ke(){const e=localStorage.getItem(Me),t=document.querySelector("#themeToggleBtn");if(!t)return;const n=t.querySelector("i"),o=t.querySelector("span");switch(document.body.classList.remove("dark-theme","neutral-theme"),e){case"dark":document.body.classList.add("dark-theme"),n&&(n.className="ph-fill ph-sun"),o&&(o.textContent=" ‡∏™‡∏ß‡πà‡∏≤‡∏á");break;case"neutral":document.body.classList.add("neutral-theme"),n&&(n.className="ph-fill ph-moon"),o&&(o.textContent=" ‡∏°‡∏∑‡∏î");break;default:n&&(n.className="ph-fill ph-palette"),o&&(o.textContent=" ‡∏Å‡∏•‡∏≤‡∏á");break}}function qt(){const e=localStorage.getItem(Me);let t;!e||e==="light"?t="neutral":e==="neutral"?t="dark":t="light",localStorage.setItem(Me,t),Ke()}function K(){We&&(We.disabled=!St())}function xt(){const e=bt();e&&(Ee(e,!1),w("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏•‡πâ‡∏ß","success")),K()}function kt(e,t){if(!e)return;const n=document.getElementById("filterStatusBar");n&&(n.innerHTML=`
            <span>‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞: <strong>${q(t)}</strong></span>
            <button type="button" class="btn-chip" data-act="clear-filter" title="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á">
                <i class="ph ph-x"></i>&nbsp;‡∏õ‡∏¥‡∏î
            </button>
        `,n.classList.add("is-visible"),n.dataset.filterType=e),document.querySelectorAll(g.room).forEach(o=>{let a=0;o.querySelectorAll(".item-card").forEach(s=>{const r=s.dataset.type===e;s.classList.toggle("item-hidden",!r),r&&a++}),o.classList.toggle("item-hidden",a===0)}),re(),J()}function Lt(){const e=document.getElementById("filterStatusBar");e&&(e.classList.remove("is-visible"),e.innerHTML="",e.removeAttribute("data-filter-type")),document.querySelectorAll(".item-hidden").forEach(t=>t.classList.remove("item-hidden")),re(),J()}function we(){document.querySelectorAll(".favorite-chips-container.show").forEach(e=>{e.classList.remove("show")}),document.querySelectorAll(".item-card.overflow-visible").forEach(e=>{e.classList.remove("overflow-visible")})}function Qe(e){var d;const t=e.dataset.favoriteType,n=(d=e.closest(".form-group-with-favorites"))==null?void 0:d.querySelector(".favorite-chips-container");if(!t||!n)return;we();const o=e.closest(".item-card"),s=X()[t]||[];let l=Array.from(s.reduce((c,i)=>{const m=i.code.trim();return m&&!c.has(m.toLowerCase())&&c.set(m.toLowerCase(),i),c},new Map).values()).map(c=>`<button type="button" class="btn-chip" data-code="${q(c.code)}" data-price="${c.price}">${q(c.code)}</button>`).join("");l+=`<button type="button" class="btn-manage-favorites" data-act="manage-favorites" data-type="${t}"><i class="ph ph-pencil-simple"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î</button>`,n.innerHTML=l,n.classList.add("show"),o&&o.classList.add("overflow-visible")}function Tt(e){const t=e.closest(".form-group-with-favorites"),n=e.closest(".item-card");if(!t||!n)return;const o=e.dataset.code,a=h(e.dataset.price),s=t.querySelector("input[data-favorite-type]");s&&(s.value=o,s.classList.add("input-highlight"),setTimeout(()=>s.classList.remove("input-highlight"),1200));const r=s.dataset.favoriteType;let l;r==="fabric"?l="set_price_per_m":r==="sheer"?l="sheer_price_per_m":r==="wallpaper"?l="wallpaper_price_roll":l="area_price_sqyd";const d=n.querySelector(`[name="${l}"]`);d&&a>0&&(d.tagName==="SELECT"?d.value=a:d.value=T(a),d.classList.add("input-highlight"),setTimeout(()=>d.classList.remove("input-highlight"),1200)),me(s),ne(n),C(),we()}function ge(e){const t=document.querySelector("#favManagerBody"),n=document.querySelector("#favManagerItemTpl"),a=X()[e]||[];!t||!n||(a.length===0?t.innerHTML='<p class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</p>':t.innerHTML=a.map(s=>n.innerHTML.replace(/{CODE}/g,q(s.code)).replace(/{PRICE}/g,T(s.price)).replace(/{RAW_PRICE}/g,s.price)).join(""),Be(null))}function Be(e){const t=document.querySelector('[data-act="edit-selected-fav"]'),n=document.querySelector('[data-act="del-selected-fav"]');!t||!n||(e?(t.disabled=!1,n.disabled=!1,j={code:e.dataset.code,price:h(e.dataset.price)}):(t.disabled=!0,n.disabled=!0,j=null))}async function Mt(e){const t=document.querySelector("#favManagerModal");if(!t||!e)return;const n={fabric:"‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö",sheer:"‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á",wallpaper:"‡∏ß‡∏≠‡∏•‡∏•‡πå‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå",wooden_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ",roller_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô",vertical_blind:"‡∏°‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á",partition:"‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á",pleated_screen:"‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö",aluminum_blind:"‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°",deco:"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"};t.dataset.currentType=e,ce=!1,j=null,document.querySelector("#favManagerTitle").textContent=`‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ '${n[e]||e}'`,ge(e),await W("#favManagerModal",()=>{ce&&be&&Qe(be)})}function w(e,t="default"){const n=document.querySelector(g.toastContainer);if(!n)return;const o={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},a=document.createElement("div");a.className=`toast toast-${t}`,a.innerHTML=`<i class="${o[t]||o.default}"></i> ${e}`,n.appendChild(a),setTimeout(()=>a.classList.add("show"),10),setTimeout(()=>{a.classList.remove("show"),a.addEventListener("transitionend",()=>a.remove())},3e3)}function W(e,t){return new Promise(n=>{const o=document.querySelector(e);if(!o){n(null);return}const a=document.querySelector(".modal-wrapper.visible");a&&a.classList.add("is-underlay"),o.classList.add("visible");const s=o.querySelector('[id$="Confirm"]'),r=o.querySelector('[id$="Cancel"], [data-act="close-modal"]'),l=Array.from(o.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(u=>!u.disabled&&u.offsetParent!==null),d=l[0],c=l[l.length-1];setTimeout(()=>d==null?void 0:d.focus(),50);const i=u=>{if(u.key==="Escape"&&!o.classList.contains("is-underlay")){m({cancelled:!0});return}if(u.key==="Tab"){if(l.length<=1){u.preventDefault();return}u.shiftKey?document.activeElement===d&&(c.focus(),u.preventDefault()):document.activeElement===c&&(d.focus(),u.preventDefault())}},m=u=>{o.classList.remove("visible"),document.removeEventListener("keydown",i),s&&(s.onclick=null),r&&(r.onclick=null),a&&a.classList.remove("is-underlay"),typeof u=="object"&&u.cancelled&&t&&t(),n(u)};s&&(s.onclick=()=>m(!0)),r&&(r.onclick=()=>{o.classList.contains("is-underlay")||m({cancelled:!0})}),document.addEventListener("keydown",i)})}async function ie(e,t){const n=document.querySelector(g.modal);return n?(n.querySelector(g.modalTitle).textContent=e,n.querySelector(g.modalBody).textContent=t,await W(g.modal)===!0):!0}async function Bt(){var n,o,a;const e=document.querySelector(g.exportOptionsModal);if(!e)return null;const t=await W(g.exportOptionsModal);return!t||t.cancelled?null:{vatOption:((n=e.querySelector('input[name="vat_option"]:checked'))==null?void 0:n.value)||"include",exportMethod:((o=e.querySelector("#exportMethod"))==null?void 0:o.value)||"direct",pageBreakBuffer:parseInt((a=e.querySelector("#pageBreakBuffer"))==null?void 0:a.value,10)||3}}async function Et(){const e=document.querySelector("#discountModal");if(!e)return;const t=e.querySelector("#discountSubtotal"),n=e.querySelector("#discountPercent"),o=e.querySelector("#discountAmount"),a=e.querySelector("#discountFinalTotal"),s=document.querySelector("#discount_type"),r=document.querySelector("#discount_value"),l=h(document.querySelector("#originalTotal").dataset.rawTotal||document.querySelector("#grandTotal").textContent);t.textContent=T(l);const d=u=>{if(ke)return;ke=!0;let v=0;if(u==="percent"){const y=h(n.value);v=l*((y>=0?y:0)/100),o.value=v>0?T(Math.round(v)):""}else v=h(o.value);if(v=v>=0?Math.min(v,l):0,u!=="percent"){const y=l>0?v/l*100:0;n.value=y>0&&isFinite(y)?D(y,2):""}a.textContent=T(l-v),setTimeout(()=>{ke=!1},20)};n.addEventListener("input",()=>d("percent")),o.addEventListener("input",()=>d("amount")),o.addEventListener("focus",u=>{h(u.target.value)>0&&(u.target.value=h(u.target.value))}),o.addEventListener("blur",u=>{h(u.target.value)>0&&(u.target.value=T(h(u.target.value))),d("amount")});const c=s.value,i=h(r.value);n.value="",o.value="",i>0?c==="percent"?(n.value=i,d("percent")):(o.value=T(i),d("amount")):d();const m=await W("#discountModal");if(m&&!m.cancelled){const u=h(n.value),v=h(o.value);document.activeElement===n&&u>0?(s.value="percent",r.value=u):v>0?(s.value="amount",r.value=v):(s.value="amount",r.value=0),G(),C()}}async function It(){var o,a,s,r,l;if(!P)return;const e=document.querySelector("#hardwareModal"),t=((o=P.querySelector('[name="set_style"]'))==null?void 0:o.value)==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà";e.querySelector('[name="modal_track_color"]').value=((a=P.querySelector('[name="track_color"]'))==null?void 0:a.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_bracket_color"]').value=((s=P.querySelector('[name="bracket_color"]'))==null?void 0:s.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_finial_color"]').value=((r=P.querySelector('[name="finial_color"]'))==null?void 0:r.value)||"‡∏Ç‡∏≤‡∏ß",e.querySelector('[name="modal_grommet_color"]').value=((l=P.querySelector('[name="grommet_color"]'))==null?void 0:l.value)||"‡πÄ‡∏á‡∏¥‡∏ô",e.querySelector("#grommetColorGroup").style.display=t?"":"none";const n=await W("#hardwareModal");n&&!n.cancelled&&(P.querySelector('[name="track_color"]').value=e.querySelector('[name="modal_track_color"]').value,P.querySelector('[name="bracket_color"]').value=e.querySelector('[name="modal_bracket_color"]').value,P.querySelector('[name="finial_color"]').value=e.querySelector('[name="modal_finial_color"]').value,t&&(P.querySelector('[name="grommet_color"]').value=e.querySelector('[name="modal_grommet_color"]').value),C(),w("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß","success")),P=null}function Le(e,t,n){e&&(te(O()),K(),e.classList.add("item-removing"),e.addEventListener("animationend",()=>{e.remove(),t&&w(t),n&&n(),de(),re(),G(),C(),ue()},{once:!0}))}function re(){document.querySelectorAll(g.room).forEach(e=>{const t=e.querySelectorAll(".item-card:not(.is-suspended):not(.item-hidden)"),n=t.length;t.forEach((a,s)=>{const r=a.querySelector("[data-item-title]");r&&(r.textContent=`${s+1}/${n}`)}),e.querySelectorAll(".item-card.is-suspended, .item-card.item-hidden").forEach(a=>{const s=a.querySelector("[data-item-title]");s&&(s.textContent="-")})})}function Xe(){const e=document.querySelector(g.orderForm),t=document.querySelector(g.lockBtn);!e||!t||(e.classList.toggle("is-locked",V),t.classList.toggle("is-locked",V),t.querySelector("i").className=V?"ph-bold ph-lock-key":"ph ph-paw-print",e.querySelectorAll("input, select, textarea, button").forEach(n=>{n.closest(".summary-footer")||n.closest(".main-header")||n.closest(".modal-wrapper")||n.dataset.act==="toggle-more-details"||n.dataset.act==="collapse-room"||(n.disabled=V)}),w(V?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",V?"warning":"success"))}function J(){const e=document.querySelectorAll(g.room);if(e.length===0)return;const t=[...e].some(o=>o.open),n=document.querySelector(g.toggleAllRoomsBtn);n&&(n.querySelector("i").className="ph ph-rows",n.querySelector("span").textContent=t?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}function Ct(){const e=document.querySelectorAll(g.room),t=[...e].some(n=>n.open);e.forEach(n=>{n.open=!t}),setTimeout(()=>{J(),C()},50)}function de(){const e=document.querySelector(g.quickNavRoomList);e&&(e.innerHTML="",document.querySelectorAll(g.room).forEach(t=>{var a;const n=((a=t.querySelector(g.roomNameInput))==null?void 0:a.value)||"‡∏´‡πâ‡∏≠‡∏á",o=document.createElement("a");o.href=`#${t.id}`,o.dataset.jumpTo=t.id,o.innerHTML=`<i class="ph ph-share-fat"></i> ${n}`,e.appendChild(o)}))}function ze(e){var n;const t=document.getElementById("quickNavBtnText");t&&(e?t.textContent=((n=e.querySelector('input[name="room_name"]'))==null?void 0:n.value)||"...":t.textContent="‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á")}function ue(){if(fe&&fe.disconnect(),!document.getElementById("quickNavBtnText"))return;const e={root:null,rootMargin:"-60px 0px -150px 0px",threshold:0},t=n=>{const o=n.filter(a=>a.isIntersecting).sort((a,s)=>a.target.getBoundingClientRect().top-s.target.getBoundingClientRect().top);o.length>0&&ze(o[0].target)};fe=new IntersectionObserver(t,e),document.querySelectorAll(g.room).forEach(n=>fe.observe(n))}function me(e){if(!e)return;const t=e.closest(".form-group-with-favorites").querySelector(".btn-favorite");if(!t)return;const n=e.dataset.favoriteType,o=e.value;t.classList.toggle("is-favorite",ct(n,o))}function Ae(e,t){const n=Q[e];if(!n)return null;const o=document.querySelector(n.templateId);if(!o||!t)return null;const a=o.content.cloneNode(!0),s=a.firstElementChild;s.dataset.type=e,s.classList.add(`${e.replace(/_/g,"-")}-item`);const r=s.querySelector(".item-type-display");if(r&&(r.textContent=n.name),n.templateId==="#areaBasedTpl"){const l=s.querySelector("input[data-favorite-type]"),d=s.querySelector(".btn-favorite");l&&(l.dataset.favoriteType=e),d&&(d.dataset.type=e)}return t.appendChild(a),s}function At(e,t){var a;if(!t)return;const n=t.querySelector(g.allItemsContainer);if(!n)return;te(O()),K(),we();const o=Ae(e,n);if(o){if(e==="wallpaper"){const s=Ne(o.querySelector('[data-act="add-wall"]'));s&&((a=s.querySelector("input"))==null||a.focus())}else{const s=o.querySelector('input:not([type="hidden"]), select, textarea');s&&s.focus()}o.classList.add("item-created"),o.scrollIntoView({behavior:"smooth",block:"center"}),re(),G(),C()}}async function Ue(e,t=null){const n=document.querySelector("#itemTypeModal");if(!n)return null;n.querySelector("#itemTypeModalTitle").textContent=e;let o=t;t&&!Q[t]&&(o="wooden_blind");const a=n.querySelector(`input[name="item_type_option"][value="${o||"set"}"]`);a&&(a.checked=!0);const s=await W("#itemTypeModal");if(!s||s.cancelled)return null;const r=n.querySelector('input[name="item_type_option"]:checked');return r?r.value:null}function Nt(e,t){if(!Q[t])return;const o=e.parentElement;o&&(te(O()),K(),e.classList.add("item-removing"),e.addEventListener("animationend",()=>{var s;const a=Ae(t,o);a&&(e.replaceWith(a),a.classList.add("item-created"),a.scrollIntoView({behavior:"smooth",block:"center"}),(s=a.querySelector('input:not([type="hidden"]), select, textarea'))==null||s.focus(),re(),G(),C(),w("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))},{once:!0}))}function se(){te(O()),K();const e=document.querySelector(g.roomsContainer);if(!e)return;const t=document.querySelector("#roomTpl");if(!t)return;const n=Array.from(document.querySelectorAll(g.roomNameInput)).map(d=>parseInt(d.value.replace(/[^0-9]/g,""),10)).filter(d=>!isNaN(d)),s=`‡∏´‡πâ‡∏≠‡∏á ${(n.length>0?Math.max(...n):0)+1}`,l=t.content.cloneNode(!0).firstElementChild;if(l){l.id=`room-${Date.now()}`;const d=l.querySelector('input[name="room_name"]'),c=l.querySelector(".room-header-controls .form-group > label");if(d&&c){const m=`room_name_${l.id}`;d.id=m,c.setAttribute("for",m)}d&&(d.value=s);const i=l.querySelector("[data-room-name-display]");i&&(i.textContent=s),l.open=!0,e.appendChild(l),l.classList.add("item-created"),l.scrollIntoView({behavior:"smooth",block:"center"})}de(),J(),ue(),C()}function Ne(e){var n;const t=(n=e==null?void 0:e.closest(".walls-section"))==null?void 0:n.querySelector(g.wallsContainer);if(t){const o=document.querySelector(g.wallTpl);if(!o)return null;const a=o.content.cloneNode(!0),s=a.querySelector(".wall-input-row");if(!s)return null;const r=s.querySelector("input"),l=s.querySelector("label");if(r&&l){const d=`wall-input-${Date.now()}-${Math.random().toString(36).substring(2,7)}`;r.id=d,l.setAttribute("for",d)}return t.appendChild(a),requestAnimationFrame(()=>{s.classList.add("item-created")}),ne(e),s}return null}function ne(e){var r,l,d,c,i,m,u,v,y,f,p,_;if(!e)return;const t=e.closest(".item-card");if(!t){G();return}const n=t.dataset.type;let o,a,s;switch(n){case"set":o=t.querySelector("[data-set-summary]"),a={width_m:(r=t.querySelector('input[name="width_m"]'))==null?void 0:r.value,height_m:(l=t.querySelector('input[name="height_m"]'))==null?void 0:l.value,style:(d=t.querySelector('select[name="set_style"]'))==null?void 0:d.value,fabric_variant:(c=t.querySelector('select[name="fabric_variant"]'))==null?void 0:c.value,price_per_m_raw:(i=t.querySelector('select[name="set_price_per_m"]'))==null?void 0:i.value,sheer_price_per_m:(m=t.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:m.value},s=M.calculateSetPrice(a),t.dataset.totalPrice=s.total;let S=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(s.total)}</b> ‡∏ö.`;s.opaque>0&&s.sheer>0&&(S+=` <small>(‡∏ó‡∏∂‡∏ö: ${T(s.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${T(s.sheer)})</small>`),o&&(o.innerHTML=S);break;case"wallpaper":o=t.querySelector("[data-wallpaper-summary]"),a={height_m:(u=t.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:u.value,price_per_roll:(v=t.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:v.value,install_cost_per_roll:(y=t.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:y.value,widths:Array.from(t.querySelectorAll('input[name="wall_width_m"]')).map(b=>b.value)},s=M.calculateWallpaperPrice(a),t.dataset.totalPrice=s.total;let x=`‡∏£‡∏ß‡∏°: <b>${T(s.total)}</b> ‡∏ö. `;(s.material>0||s.install>0)&&(x+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${T(s.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${T(s.install)})</small>`),s.rolls>0&&(x+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${D(s.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${s.rolls} ‡∏°‡πâ‡∏ß‡∏ô`),o&&(o.innerHTML=x);break;default:o=t.querySelector("[data-area-summary]"),a={width_m:(f=t.querySelector('input[name="area_width_m"]'))==null?void 0:f.value,height_m:(p=t.querySelector('input[name="area_height_m"]'))==null?void 0:p.value,price_sqyd:(_=t.querySelector('input[name="area_price_sqyd"]'))==null?void 0:_.value},s=M.calculateDecoPrice(a),t.dataset.totalPrice=s.total;let $="";s.sqyd>0&&($=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${D(s.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`),o&&(o.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${T(s.total)}</b> ‡∏ö.${$}`);break}G()}function G(){let e=0;document.querySelectorAll(g.room).forEach(r=>{let l=0,d=0;const c=r.classList.contains("is-suspended");r.querySelectorAll(".item-card").forEach(m=>{const u=h(m.dataset.totalPrice),v=m.classList.contains("is-suspended");!c&&!v&&(l+=u,u>0&&d++)});const i=r.querySelector("[data-room-brief]");i&&(c?i.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":d>0?i.innerHTML=`<span>${d}</span> &bull; ${T(l)} ‡∏ö‡∏≤‡∏ó`:i.innerHTML="<span>0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"),c||(e+=l)});const t=document.querySelector("#discount_type").value,n=h(document.querySelector("#discount_value").value);let o=0;n>0&&(o=t==="percent"?e*(n/100):n);const a=e-o;document.querySelector("#grandTotal").textContent=T(a);const s=document.querySelector("#originalTotal");o>0?(s.textContent=T(e),s.dataset.rawTotal=e,s.style.display="block"):(s.style.display="none",s.dataset.rawTotal="")}async function Ee(e,t=!1){if(e!=null&&e.favorites)if(t){const s=document.querySelector("#favoritesConflictModal");if(s){const r=await W("#favoritesConflictModal");if(!r||r.cancelled){w("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤","warning");return}switch(s.querySelector('input[name="fav_conflict_option"]:checked').value){case"overwrite":Oe(e.favorites)&&w("‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success");break;case"merge":const d=Ye(e.favorites);w(`‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÄ‡∏û‡∏¥‡πà‡∏° ${d} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà)`,"success");break}}}else Oe(e.favorites);if(!(e!=null&&e.rooms)||!Array.isArray(e.rooms)){e.favorites||w("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå","error");return}const n=document.querySelector(g.roomsContainer);if(!n)return;n.innerHTML="",document.querySelector("#customer_name").value=e.customer_name||"",document.querySelector("#customer_phone").value=e.customer_phone||"",document.querySelector("#customer_address").value=e.customer_address||"",e.discount&&(document.querySelector("#discount_type").value=e.discount.type||"amount",document.querySelector("#discount_value").value=e.discount.value||0),document.querySelector("#customerDetailsCard").open=e.customer_card_open??!0;let o=0;const a=()=>{if(o>=e.rooms.length){document.querySelectorAll("input[data-favorite-type]").forEach(me),G(),re(),de(),J(),ue(),t&&w("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success");return}const s=e.rooms[o],r=document.querySelector("#roomTpl");if(!r){console.error("Room template not found.");return}const d=r.content.cloneNode(!0).firstElementChild;if(n.appendChild(d),d){d.id=s.id||`room-${Date.now()}`,s.is_suspended&&d.classList.add("is-suspended"),d.open=s.is_open===!0;const c=s.room_name||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)",i=d.querySelector('input[name="room_name"]'),m=d.querySelector(".room-header-controls .form-group > label");if(i&&m){const y=`room_name_${d.id}`;i.id=y,m.setAttribute("for",y)}i&&(i.value=c);const u=d.querySelector("[data-room-name-display]");u&&(u.textContent=c);const v=d.querySelector(g.allItemsContainer);if(v&&s.items){const y=document.createDocumentFragment();s.items.forEach(f=>{var _,S,x;f.type==="deco"&&f.deco_type?(f.type=$t[f.deco_type]||"wooden_blind",f.code=f.deco_code,f.width_m=f.deco_width_m,f.height_m=f.deco_height_m,f.price_sqyd=f.deco_price_sqyd,f.notes=f.deco_notes):f.type==="deco"&&(f.type="wooden_blind",f.code=f.deco_code);const p=Ae(f.type,y);if(p){switch(f.is_suspended&&p.classList.add("is-suspended"),f.type){case"set":p.querySelector('input[name="width_m"]').value=Z(f.width_m),p.querySelector('input[name="height_m"]').value=Z(f.height_m),p.querySelector('select[name="set_style"]').value=f.style||f.set_style||"‡∏•‡∏≠‡∏ô",p.querySelector('select[name="fabric_variant"]').value=f.fabric_variant||"‡∏ó‡∏∂‡∏ö";const $=(f.fabric_variant||"").includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");(_=p.querySelector(g.sheerWrap))==null||_.classList.toggle("hidden",!$),(S=p.querySelector(g.sheerCodeWrap))==null||S.classList.toggle("hidden",!$);break;case"wallpaper":p.querySelector('input[name="wallpaper_height_m"]').value=Z(f.height_m||f.wallpaper_height_m),f.widths&&f.widths.forEach(b=>{const k=Ne(p.querySelector('[data-act="add-wall"]'));k&&(k.querySelector('input[name="wall_width_m"]').value=Z(b))});break;default:((x=Q[f.type])==null?void 0:x.templateId)==="#areaBasedTpl"&&(p.querySelector('input[name="area_width_m"]').value=Z(f.width_m),p.querySelector('input[name="area_height_m"]').value=Z(f.height_m));break}ne(p)}}),v.appendChild(y)}}o++,requestAnimationFrame(a)};requestAnimationFrame(a)}function Ft(e){if(document.getElementById("loading-overlay"))return;const t=document.createElement("div");t.id="loading-overlay",t.innerHTML=`<div class="loading-spinner"></div><p>${e}</p>`,document.body.appendChild(t),document.body.style.overflow="hidden"}function Pt(){const e=document.getElementById("loading-overlay");e&&e.remove(),document.body.style.overflow=""}async function Rt(e,t){var o,a;const n=document.querySelector(g.printableContent);if(!n||!e||!e.html){w("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","error");return}if(t==="direct"){Ft("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...");try{typeof html2pdf>"u"&&(w("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ PDF...","default"),await wt("https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"));const s=document.createElement("div");s.style.position="fixed",s.style.left="-300mm",s.style.top="0",s.style.width="210mm",s.style.background="#fff",s.innerHTML=e.html,document.body.appendChild(s),await new Promise(l=>setTimeout(l,500));const r={margin:0,filename:`${e.fileName}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1,width:((o=s.querySelector(".pdf-page"))==null?void 0:o.scrollWidth)||210*3.77,windowWidth:((a=s.querySelector(".pdf-page"))==null?void 0:a.scrollWidth)||210*3.77},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await window.html2pdf().from(s).set(r).save(),w("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success"),document.body.contains(s)&&document.body.removeChild(s)}catch(s){console.error("PDF Generation Error:",s),w("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß, ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 (‡∏û‡∏¥‡∏°‡∏û‡πå)","error")}finally{Pt()}}t==="print"&&(n.innerHTML=e.html,setTimeout(()=>{window.print(),setTimeout(()=>{n.innerHTML=""},1e3)},rt))}function Ot(e){if(!e||!e.html){w("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML","error");return}try{const t=`
            <!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${e.fileName}</title>
                <link rel="stylesheet" href="https://grobmak.github.io/marnthara-form/src/style.css">
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@phosphor-icons/web@2.1.1/src/bold/style.css">
                <style>#printable-content { display: block !important; } .pdf-page { border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: 10mm auto; } i.ph { vertical-align: middle; }</style>
            </head>
            <body>${e.html}</body></html>`,n=new Blob([t],{type:"text/html;charset=utf-8"}),o=URL.createObjectURL(n),a=document.createElement("a");a.href=o,a.download=`${e.fileName}.html`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(o),w("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch(t){console.error("HTML Export Error:",t),w("‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}function Ht(e){if(!e)return;const t=e.closest(".item-card");if(!t)return;const n=h(e.value);let o,a;const s=e.getAttribute("name");if(s==="set_price_per_m"?(o=t.querySelector('input[name="fabric_code"]'),a="fabric"):s==="sheer_price_per_m"?(o=t.querySelector('input[name="sheer_fabric_code"]'),a="sheer"):s==="wallpaper_price_roll"?(o=t.querySelector('input[name="wallpaper_code"]'),a="wallpaper"):s==="area_price_sqyd"&&(o=t.querySelector('input[name="area_code"]'),o&&(a=o.dataset.favoriteType)),o&&a&&o.value.trim()){const r=Ce(a,o.value);r&&r.price!==n&&(o.value="",me(o))}}const Dt=nt(e=>{e.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_price_per_m"]')&&Ht(e),ne(e),C()},200);function Ge(e){var n,o,a;if(V){e.preventDefault();return}const t=e.target;if(t.matches('select[name="fabric_variant"]')){const s=t.closest(".set-item");if(s){const r=s.querySelector(".item-details-more"),l=(n=t.value)==null?void 0:n.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");r&&r.classList.contains("show")&&((o=r.querySelector(g.sheerWrap))==null||o.classList.toggle("hidden",!l),(a=r.querySelector(g.sheerCodeWrap))==null||a.classList.toggle("hidden",!l))}}if(t.matches(g.roomNameInput)){const s=t.closest(".room-card");if(s){const r=s.querySelector("[data-room-name-display]");r&&(r.textContent=t.value||"‡∏´‡πâ‡∏≠‡∏á")}de(),ue()}t.matches("input[data-favorite-type]")&&me(t),Dt(t)}function jt(e){const t=e.target;t.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_install_cost"]')?t.value=h(t.value)>0?T(h(t.value)):"":t.matches('input[name$="_m"], input[name$="width_m"]')&&(t.value=Z(t.value))}function Wt(e){const t=e.target;t.matches('[name$="_price_sqyd"], [name$="_price_roll"], [name$="_install_cost"]')&&h(t.value)>0&&(t.value=h(t.value)),t.matches("input[data-favorite-type]")&&(be=t,Qe(t))}const Ut=async e=>{var i,m,u,v;const t=e.target.closest(".summary-tag[data-filter-type]");if(t){const y=t.dataset.filterType,f=t.textContent.trim().replace(/\s*\d+\s*$/,""),p=document.querySelector("#overviewModal");p&&p.classList.remove("visible"),kt(y,f);return}const n=e.target.closest(".favorite-chips-container .btn-chip");if(n){Tt(n);return}const o=e.target.closest(".fav-manager-item");if(o){const y=o.parentElement.querySelector(".is-selected");y&&y.classList.remove("is-selected"),y!==o?(o.classList.add("is-selected"),Be(o)):Be(null);return}const a=e.target.closest("[data-act]");if(!a)return;const s=["toggle-more-details","show-discount-modal","collapse-room"];if(V&&!a.closest(".unlockable")&&!s.includes(a.dataset.act))return;const r=a.dataset.act,l=a.closest(g.room),d=a.closest(".item-card"),c=(y,f,p)=>ie(y,f).then(_=>_&&p());switch(r){case"add-room":se();break;case"add-item":{if(xe=a.closest(g.room),xe){const p=await Ue("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà");p&&At(p,xe)}break}case"collapse-room":l&&(e.preventDefault(),l.open=!1,(i=l.querySelector("summary"))==null||i.scrollIntoView({behavior:"smooth",block:"center"}));break;case"clear-filter":Lt();break;case"change-type":{const p=d==null?void 0:d.dataset.type;if(d&&p){const _=await Ue("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",p);_&&_!==p&&c("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á","‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?",()=>Nt(d,_))}break}case"add-wall":{const p=Ne(a);p&&((m=p.querySelector('input[name="wall_width_m"]'))==null||m.focus());break}case"show-discount-modal":Et();break;case"open-hardware-modal":{P=d,It();break}case"apply-hardware-to-room":{const p=a.closest("#hardwareModal"),_=P==null?void 0:P.closest(g.room);if(!p||!_)break;const S=p.querySelector('[name="modal_track_color"]').value,x=p.querySelector('[name="modal_bracket_color"]').value,$=p.querySelector('[name="modal_finial_color"]').value,b=p.querySelector('[name="modal_grommet_color"]').value;_.querySelectorAll(".set-item").forEach(k=>{k.querySelector('[name="track_color"]').value=S,k.querySelector('[name="bracket_color"]').value=x,k.querySelector('[name="finial_color"]').value=$,k.querySelector('[name="grommet_color"]').value=b}),C(),w("‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success");break}case"toggle-more-details":{const p=d==null?void 0:d.querySelector(".item-details-more");if(!p)break;if(p.classList.contains("show"))p.classList.remove("show"),a.classList.remove("expanded"),a.querySelector("i").className="ph ph-caret-down",a.querySelector("span").textContent="‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°",p.addEventListener("transitionend",()=>{p.classList.contains("show")||(p.innerHTML="")},{once:!0});else{if(p.innerHTML.trim()===""){const S=d.dataset.type,x=Q[S]||Q.wooden_blind,$=document.querySelector(x.detailsTemplateId);if($&&(p.appendChild($.content.cloneNode(!0)),p.querySelectorAll("input[data-favorite-type]").forEach(me),S==="set")){const k=d.querySelector('select[name="fabric_variant"]').value.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");p.querySelector("[data-sheer-wrap]").classList.toggle("hidden",!k),p.querySelector("[data-sheer-code-wrap]").classList.toggle("hidden",!k)}}requestAnimationFrame(()=>{p.classList.add("show"),a.classList.add("expanded"),a.querySelector("i").className="ph ph-caret-up",a.querySelector("span").textContent="‡∏¢‡πà‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á"})}break}case"toggle-favorite":{const p=a.closest(".form-group-with-favorites").querySelector("input[data-favorite-type]");if(!p||!d)break;const _=p.dataset.favoriteType,S=p.value;let x;_==="fabric"?x="set_price_per_m":_==="sheer"?x="sheer_price_per_m":_==="wallpaper"?x="wallpaper_price_roll":x="area_price_sqyd";const $=d.querySelector(`[name="${x}"]`),b=h($==null?void 0:$.value);if(!S.trim()){w("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");break}if(b<=0&&_!=="fabric"&&_!=="sheer"){w("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");break}const k=qe(_,S,b);a.classList.toggle("is-favorite",k),w(k?"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß":"‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î","success"),C();break}case"manage-favorites":{const p=a.dataset.type;be=a.closest(".form-group-with-favorites").querySelector("input[data-favorite-type]"),Mt(p);break}case"add-new-fav-form":{const _=a.closest("#favManagerModal").dataset.currentType;if(!_)break;const S=document.querySelector("#favAddModal"),x=((u=Object.values(Q).find(E=>{var B;return E.detailsTemplateId===((B=Q[_])==null?void 0:B.detailsTemplateId)}))==null?void 0:u.name)||_;S.querySelector("h3").textContent=`‡πÄ‡∏û‡∏¥‡πà‡∏° '${x}'`;const $=S.querySelector('[name="fav_code_add"]'),b=S.querySelector('[name="fav_price_add"]');$.value="",b.value="";const k=await W("#favAddModal");if(k&&!k.cancelled){const E=$.value.trim(),B=h(b.value);E&&(qe(_,E,B),ce=!0,ge(_),w("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"))}break}case"edit-selected-fav":{if(!j)break;const _=a.closest("#favManagerModal").dataset.currentType;if(!_)break;const S=document.querySelector("#favEditModal");S.querySelector("h3").textContent=`‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç '${j.code}'`;const x=S.querySelector('[name="fav_code_edit"]'),$=S.querySelector('[name="fav_price_edit"]');x.value=j.code,$.value=j.price>0?j.price:"";const b=await W("#favEditModal");if(b&&!b.cancelled){const k=x.value.trim(),E=h($.value);k&&(k!==j.code&&Te(_,j.code),qe(_,k,E),ce=!0,ge(_),w("‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"))}break}case"del-selected-fav":{if(!j)break;const _=a.closest("#favManagerModal").dataset.currentType;if(!_)break;await ie("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î",`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏´‡∏±‡∏™ "${j.code}"?`)&&(Te(_,j.code),ce=!0,ge(_),w("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"));break}case"del-room":c("‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>Le(l,"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-item":c("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?",()=>Le(d,"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wall":c("‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",()=>Le(a.closest(".wall-input-row"),"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß",()=>ne(d)));break;case"clear-room":c("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>{te(O()),K(),l.querySelector(g.allItemsContainer).innerHTML="",re(),G(),C(),w("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success")});break;case"toggle-room-menu":e.preventDefault();const y=a.nextElementSibling;if(!y||!l)return;const f=!y.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(p=>p.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(p=>p.classList.remove("overflow-visible")),f&&(y.classList.add("show"),l.classList.add("overflow-visible"));break;case"toggle-suspend-room":e.preventDefault(),l==null||l.classList.toggle("is-suspended"),G(),C(),(v=a.closest(".room-options-menu"))==null||v.classList.remove("show"),l==null||l.classList.remove("overflow-visible");break;case"toggle-suspend":e.preventDefault(),d==null||d.classList.toggle("is-suspended"),ne(a),C();break}};function Gt(){V=!V,Xe()}function Vt(e){if(!e||e.closest(".modal-wrapper"))return;const t=e.getAttribute("name"),n=e.closest(".item-card"),s=(r=>{const l=r[t];if(!l)return null;const d=n||document;let c=null;return typeof l=="string"?c=d.querySelector(`[name="${l}"]:not(:disabled)`):typeof l=="function"&&(c=l(e)),!c&&n&&typeof l=="string"&&(c=document.querySelector(`[name="${l}"]:not(:disabled)`)),c})({customer_name:"customer_phone",customer_phone:"customer_address",customer_address:()=>document.querySelector(".room-name-input"),room_name:r=>{var l;return(l=r.closest(".room-card"))==null?void 0:l.querySelector('[data-act="add-item"]')},width_m:"height_m",height_m:"set_price_per_m",set_price_per_m:r=>{var c;const l=r.closest(".set-item"),d=(c=l==null?void 0:l.querySelector('[name="fabric_variant"]'))==null?void 0:c.value;return d!=null&&d.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")?l==null?void 0:l.querySelector('[name="sheer_price_per_m"]'):l==null?void 0:l.querySelector('[data-act="toggle-more-details"]')},sheer_price_per_m:r=>{var l;return(l=r.closest(".item-card"))==null?void 0:l.querySelector('[data-act="toggle-more-details"]')},area_width_m:"area_height_m",area_height_m:"area_price_sqyd",area_price_sqyd:"area_code",wall_width_m:r=>{var d,c;const l=(d=r.closest(".wall-input-row"))==null?void 0:d.nextElementSibling;return l!=null&&l.matches(".wall-input-row")?l.querySelector("input"):(c=r.closest(".item-card"))==null?void 0:c.querySelector('[name="wallpaper_price_roll"]')},wallpaper_price_roll:"wallpaper_height_m",wallpaper_height_m:"wallpaper_code"});s&&(s.focus(),typeof s.select=="function"&&s.select())}function Yt(){const e=document.querySelector(g.setTpl);if(!e)return;const t=e.content.querySelector('select[name="set_price_per_m"]'),n=e.content.querySelector('select[name="sheer_price_per_m"]'),o=a=>{let s='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return Array.isArray(a)?(a.forEach(r=>{s+=`<option value="${r}">${r.toLocaleString("th-TH")}</option>`}),s):(console.error("Price data for dropdown is not available or not an array.",a),s)};t&&(t.innerHTML=o(_e.fabric)),n&&(n.innerHTML=o(_e.sheer))}function Jt(){Yt(),Ke();const e=document.querySelector(g.orderForm),t=document.querySelector(g.fileImporter),n=document.querySelector("#favImporter"),o=document.querySelector(g.menuDropdown),a=document.querySelector(g.quickNavDropdown),s=document.querySelector("#pageBreakBuffer"),r=document.querySelector("#pageBreakBufferValue");s&&r&&s.addEventListener("input",()=>{r.textContent=s.value}),e.addEventListener("input",Ge),e.addEventListener("change",Ge),document.addEventListener("click",Ut),e.addEventListener("blur",jt,!0),e.addEventListener("focusin",Wt,!0),e.addEventListener("keydown",c=>{const i=c.target;c.key==="Enter"&&!i.matches("textarea, button, [data-act]")&&(c.preventDefault(),Vt(i))});const l=c=>{const i=c.target.closest(g.room);i&&ze(i)};e.addEventListener("click",l),e.addEventListener("focusin",l),document.body.addEventListener("click",c=>{c.target.closest("summary")&&setTimeout(()=>{J(),C()},50)}),document.querySelector("#undoBtn").addEventListener("click",c=>{c.preventDefault(),xt()}),document.querySelector(g.lockBtn).addEventListener("click",Gt),document.querySelector(g.toggleAllRoomsBtn).addEventListener("click",Ct),document.querySelector(g.quickNavBtn).addEventListener("click",c=>{var m;c.stopPropagation(),o.classList.remove("show");const i=!a.classList.contains("show");a.classList.toggle("show"),c.currentTarget.setAttribute("aria-expanded",i),i&&((m=document.querySelector(g.menuBtn))==null||m.setAttribute("aria-expanded","false"))}),document.querySelector(g.quickNavRoomList).addEventListener("click",c=>{var m;const i=c.target.closest("a[data-jump-to]");if(i){c.preventDefault();const u=i.dataset.jumpTo,v=document.getElementById(u);v&&(document.body.classList.add("disable-animations"),v.open=!0,v.scrollIntoView({behavior:"auto",block:"start"}),v.classList.add("scrolling-jump"),setTimeout(()=>{v.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),J()},1e3)),a.classList.remove("show"),(m=document.querySelector(g.quickNavBtn))==null||m.setAttribute("aria-expanded","false")}});const d=document.querySelector("#addRoomQuickNavBtn");if(d){const c=at(se,700);d.addEventListener("click",i=>{var m;i.stopPropagation(),c(),a.classList.remove("show"),(m=document.querySelector(g.quickNavBtn))==null||m.setAttribute("aria-expanded","false")})}document.querySelector(g.menuBtn).addEventListener("click",c=>{var m;c.stopPropagation(),a.classList.remove("show");const i=!o.classList.contains("show");o.classList.toggle("show"),c.currentTarget.setAttribute("aria-expanded",i),i&&((m=document.querySelector(g.quickNavBtn))==null||m.setAttribute("aria-expanded","false"))}),document.querySelector("#themeToggleBtn").addEventListener("click",c=>{c.preventDefault(),qt()}),document.querySelector("#overviewBtn").addEventListener("click",async c=>{var v;c.preventDefault(),o.classList.remove("show"),(v=document.querySelector(g.menuBtn))==null||v.setAttribute("aria-expanded","false");const i=O(),m=document.querySelector("#overviewModalHeader"),u=document.querySelector("#overviewModalBody");if(m&&u){const y=i.rooms.reduce((_,S)=>{if(S.is_suspended)return _;const x=(S.items||[]).filter($=>{if($.is_suspended)return!1;let b=0;switch($.type){case"set":b=M.calculateSetPrice($).total;break;case"wallpaper":b=M.calculateWallpaperPrice($).total;break;default:b=M.calculateDecoPrice($).total;break}return b>0}).length;return _+x},0),f=document.querySelector(g.grandTotal).textContent||"0",p=i.rooms.filter(_=>!_.is_suspended&&_.items&&_.items.some(S=>!S.is_suspended)).length;m.innerHTML=`
                <div class="overview-stats-grid">
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-map-pin-line"></i>
                        <div class="stat-value">${p}</div>
                        <div class="stat-label">‡∏´‡πâ‡∏≠‡∏á</div>
                    </div>
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-stack"></i>
                        <div class="stat-value">${y}</div>
                        <div class="stat-label">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</div>
                    </div>
                    <div class="overview-stat-card">
                        <i class="ph-bold ph-coins"></i>
                        <div class="stat-value">${f}</div>
                        <div class="stat-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</div>
                    </div>
                </div>
            `,u.innerHTML=vt(i),W("#overviewModal")}}),document.querySelector(g.exportPdfBtn).addEventListener("click",async c=>{var v;c.preventDefault(),o.classList.remove("show"),(v=document.querySelector(g.menuBtn))==null||v.setAttribute("aria-expanded","false");const i=await Bt();if(!i)return;const m=O(),u=yt(m,{vatRate:i.vatOption==="include"?F.baseVatRate:0,pageBreakBuffer:i.pageBreakBuffer});if(!u){w("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}i.exportMethod==="html"?Ot(u):Rt(u,i.exportMethod)}),document.querySelector("#visualReportsBtn").addEventListener("click",async c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),W("#visualReportsModal")}),document.querySelector("#visualReportsConfirm").addEventListener("click",async c=>{var u;c.preventDefault();const i=document.querySelector("#visualReportsModal"),m=(u=i.querySelector('input[name="report_type_option"]:checked'))==null?void 0:u.value;if(!m){w("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô","warning");return}if(i.classList.remove("visible"),m==="lookbook"){const v=O(),y=gt(v),f=document.querySelector("#lookbookModalBody");y&&f?(f.innerHTML=y,W("#lookbookModal")):w("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô","warning")}else w(`‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó '${m}' ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô`,"default")}),document.querySelector(g.importBtn).addEventListener("click",c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),t.click()}),t.addEventListener("change",c=>{var u;const i=(u=c.target.files)==null?void 0:u[0];if(!i)return;const m=new FileReader;m.onload=async v=>{try{const y=JSON.parse(v.target.result);await Ee(y,!0)}catch(y){w("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error"),console.error("JSON Parse Error:",y)}},m.readAsText(i),c.target.value=null}),document.querySelector(g.exportBtn).addEventListener("click",c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false");try{const m=O(),u=JSON.stringify(m,null,4),v=new Blob([u],{type:"application/json"}),y=URL.createObjectURL(v),f=document.createElement("a"),p=new Date,_=`${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`,S=`${p.getHours().toString().padStart(2,"0")}${p.getMinutes().toString().padStart(2,"0")}`,x=Ve(m.customer_name||"data");f.href=y,f.download=`MTR-${_}${S}-${x}.json`,f.click(),URL.revokeObjectURL(y),w("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{w("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector("#importFavsBtn").addEventListener("click",c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),n.click()}),n.addEventListener("change",c=>{var u;const i=(u=c.target.files)==null?void 0:u[0];if(!i)return;const m=new FileReader;m.onload=v=>{try{const y=JSON.parse(v.target.result),f=Ye(y);f>0?w(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà ${f} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`,"success"):w("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°","default"),C()}catch(y){w("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error"),console.error("Favorites JSON Parse Error:",y)}},m.readAsText(i),c.target.value=null}),document.querySelector("#exportFavsBtn").addEventListener("click",c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false");try{const m=X(),u=JSON.stringify(m,null,4),v=new Blob([u],{type:"application/json"}),y=URL.createObjectURL(v),f=document.createElement("a"),p=new Date,_=`${p.getFullYear()}${(p.getMonth()+1).toString().padStart(2,"0")}${p.getDate().toString().padStart(2,"0")}`;f.href=y,f.download=`MTR-Favorites-${_}.json`,f.click(),URL.revokeObjectURL(y),w("Export ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{w("Export ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(g.submitBtn).addEventListener("click",async c=>{var i;if(c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ie("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const m=O();if(!m.customer_name&&!m.customer_phone){w("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}w("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const u=await fetch(tt,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});u.ok?w("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):w(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${u.status}`,"error")}catch{w("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(g.copyTextBtn).addEventListener("click",async c=>{var u;c.preventDefault(),o.classList.remove("show"),(u=document.querySelector(g.menuBtn))==null||u.setAttribute("aria-expanded","false");const i=document.querySelector(g.copyOptionsModal);i.querySelector('input[name="copy_option"][value="customer"]').checked=!0;const m=await W(g.copyOptionsModal);if(m&&!m.cancelled){const v=i.querySelector('input[name="copy_option"]:checked').value,y=ht(O(),v);try{await navigator.clipboard.writeText(y),w("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{w("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(g.clearItemsBtn).addEventListener("click",async c=>{var i;c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ie("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")&&(te(O()),K(),document.querySelectorAll(g.room).forEach(m=>{const u=m.querySelector(g.allItemsContainer);u&&(u.innerHTML="")}),G(),C(),w("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))}),document.querySelector(g.clearAllBtn).addEventListener("click",async c=>{var i;if(c.preventDefault(),o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false"),await ie("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",'‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô! ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡πÅ‡∏•‡∏∞ "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î" ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')){te(O()),K(),localStorage.removeItem(ve),it();const m=document.querySelector("#customer_name"),u=document.querySelector("#customer_phone"),v=document.querySelector("#customer_address");m&&(m.value=""),u&&(u.value=""),v&&(v.value="");const y=document.querySelector("#discount_type"),f=document.querySelector("#discount_value");y&&(y.value="amount"),f&&(f.value="0");const p=document.querySelector(g.roomsContainer);p&&(p.innerHTML=""),G(),de(),J(),se();const _=document.querySelector("#customerDetailsCard");_&&(_.open=!0),w("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà","success")}}),window.addEventListener("click",c=>{var i,m;c.target.closest(".modal-wrapper")||(c.target.closest(".menu-container")||(o.classList.contains("show")&&(o.classList.remove("show"),(i=document.querySelector(g.menuBtn))==null||i.setAttribute("aria-expanded","false")),a.classList.contains("show")&&(a.classList.remove("show"),(m=document.querySelector(g.quickNavBtn))==null||m.setAttribute("aria-expanded","false"))),c.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(u=>u.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(u=>u.classList.remove("overflow-visible"))),c.target.closest(".form-group-with-favorites")||we())}),window.addEventListener("beforeunload",C);try{const c=localStorage.getItem(ve);if(c&&c.length>2&&c!=="null")Ee(JSON.parse(c),!1);else{se();const i=document.querySelector("#customerDetailsCard");i&&(i.open=!0)}}catch(c){console.error("Failed to load data from localStorage:",c),localStorage.removeItem(ve),se()}G(),Xe(),J(),ue(),K()}document.addEventListener("DOMContentLoaded",Jt);
