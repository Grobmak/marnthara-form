(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const ue="input-ui/5.6.0-final",de="https://your-make-webhook-url.com/your-unique-path",Y="marnthara.input.v4",me=500,E={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"https://i.imgur.com/l7y85nI.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},pe=1.19599,te={ROLL_WIDTH_M:.53,ROLL_LENGTH_M:10,STRIPS_PER_ROLL_UNDER_2_5M:3},Q={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},i={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",setCount:"#setCount",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",set:"[data-set]",setsContainer:"[data-sets]",decorationsContainer:"[data-decorations]",decoItem:"[data-deco-item]",wallpapersContainer:"[data-wallpapers]",wallpaperItem:"[data-wallpaper-item]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn",allDetailsCards:'.card[id="customerDetailsCard"], .room-card'},y=e=>{typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return Number.isFinite(t)?t:0},A=e=>{const t=y(e);return t>0?t.toFixed(2):""},N=(e,t=2,a=!1)=>Number.isFinite(e)?e.toLocaleString("en-US",{minimumFractionDigits:a?2:t,maximumFractionDigits:a?2:t}):"0",k=(e,t=0)=>Number.isFinite(e)?e.toLocaleString("th-TH",{minimumFractionDigits:t,maximumFractionDigits:t}):"0",fe=(e,t=150)=>{let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>e(...r),t)}},he=(e,t=700)=>{let a=!1;return(...r)=>{if(!a){a=!0;try{return e(...r)}finally{setTimeout(()=>{a=!1},t)}}}};function _e(e){let t=y(e);if(isNaN(t))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";if(t===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const a=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"],r=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];let n=Math.floor(t),s=Math.round((t-n)*100);const c=d=>{if(d===0)return"";let u="";const m=String(d);for(let p=0;p<m.length;p++){const h=m[p];m.length-1;const g=m.length-p-1;h!=="0"&&(g===1&&h==="1"?u+=r[g]:g===1&&h==="2"?u+="‡∏¢‡∏µ‡πà"+r[g]:g===0&&h==="1"&&m.length>1?u+="‡πÄ‡∏≠‡πá‡∏î":u+=a[parseInt(h)]+r[g])}return u};let o="";if(n>0){const d=Math.floor(n/1e6),u=n%1e6;d>0&&(o+=c(d)+"‡∏•‡πâ‡∏≤‡∏ô"),o+=c(u),o+="‡∏ö‡∏≤‡∏ó"}let l="";return s>0?l=c(s)+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":o+="‡∏ñ‡πâ‡∏ß‡∏ô",(o+l).trim()}function O(){var t,a,r;const e={app_version:ue,customer_name:((t=document.querySelector('[name="customer_name"]'))==null?void 0:t.value)||"",customer_phone:((a=document.querySelector('[name="customer_phone"]'))==null?void 0:a.value)||"",customer_address:((r=document.querySelector('[name="customer_address"]'))==null?void 0:r.value)||"",rooms:[]};return document.querySelectorAll(i.room).forEach(n=>{var c;const s={id:n.id,room_name:((c=n.querySelector(i.roomNameInput))==null?void 0:c.value)||"",is_suspended:n.classList.contains("is-suspended"),sets:[],decorations:[],wallpapers:[]};n.querySelectorAll(i.set).forEach(o=>{var l,d,u,m,p,h,g,L,q,f,v;s.sets.push({width_m:y((l=o.querySelector('input[name="width_m"]'))==null?void 0:l.value),height_m:y((d=o.querySelector('input[name="height_m"]'))==null?void 0:d.value),style:((u=o.querySelector('select[name="set_style"]'))==null?void 0:u.value)||"",fabric_variant:((m=o.querySelector('select[name="fabric_variant"]'))==null?void 0:m.value)||"",price_per_m_raw:y((p=o.querySelector('select[name="set_price_per_m"]'))==null?void 0:p.value),sheer_price_per_m:y((h=o.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:h.value),fabric_code:((g=o.querySelector('input[name="fabric_code"]'))==null?void 0:g.value)||"",sheer_fabric_code:((L=o.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:L.value)||"",opening_style:((q=o.querySelector('select[name="opening_style"]'))==null?void 0:q.value)||"",track_color:((f=o.querySelector('select[name="track_color"]'))==null?void 0:f.value)||"",notes:((v=o.querySelector('input[name="notes"]'))==null?void 0:v.value)||"",is_suspended:o.classList.contains("is-suspended")})}),n.querySelectorAll(i.decoItem).forEach(o=>{var l,d,u,m,p,h;s.decorations.push({type:((l=o.querySelector('[name="deco_type"]'))==null?void 0:l.value)||"",width_m:y((d=o.querySelector('[name="deco_width_m"]'))==null?void 0:d.value),height_m:y((u=o.querySelector('[name="deco_height_m"]'))==null?void 0:u.value),price_sqyd:y((m=o.querySelector('[name="deco_price_sqyd"]'))==null?void 0:m.value),deco_code:((p=o.querySelector('[name="deco_code"]'))==null?void 0:p.value)||"",notes:((h=o.querySelector('[name="deco_notes"]'))==null?void 0:h.value)||"",is_suspended:o.classList.contains("is-suspended")})}),n.querySelectorAll(i.wallpaperItem).forEach(o=>{var l,d,u,m,p;s.wallpapers.push({height_m:y((l=o.querySelector('[name="wallpaper_height_m"]'))==null?void 0:l.value),wallpaper_code:((d=o.querySelector('[name="wallpaper_code"]'))==null?void 0:d.value)||"",price_per_roll:y((u=o.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:u.value),install_cost_per_roll:y((m=o.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:m.value),notes:((p=o.querySelector('[name="wallpaper_notes"]'))==null?void 0:p.value)||"",widths:Array.from(o.querySelectorAll('[name="wall_width_m"]')).map(h=>y(h.value)),is_suspended:o.classList.contains("is-suspended")})}),e.rooms.push(s)}),e}function R(){localStorage.setItem(Y,JSON.stringify(O()))}const b={stylePlus:e=>Q.style_surcharge[e]??0,heightPlus:e=>{const t=[...Q.height].sort((a,r)=>r.threshold-a.threshold);for(const a of t)if(e>a.threshold)return a.add_per_m;return 0},fabricYardage:(e,t)=>{const a=y(t);return a<=0||!e?0:e==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||e==="‡∏à‡∏µ‡∏ö"?(a*2+.6)/.9:e==="‡∏•‡∏≠‡∏ô"?(a*2.6+.6)/.9:0},wallpaperRolls:(e,t)=>{const a=y(e),r=y(t);if(a<=0||r<=0)return 0;const n=r>2.5?Math.floor(te.ROLL_LENGTH_M/r):te.STRIPS_PER_ROLL_UNDER_2_5M;if(n<=0)return 0;const s=Math.ceil(a/te.ROLL_WIDTH_M);return Math.ceil(s/n)},calculateSetPrice:function(e){var c,o;if(!e||e.is_suspended||y(e.width_m)<=0)return{total:0,opaque:0,sheer:0};const t=this.stylePlus(e.style),a=this.heightPlus(y(e.height_m)),r=y(e.width_m),n=(c=e.fabric_variant)!=null&&c.includes("‡∏ó‡∏∂‡∏ö")&&y(e.price_per_m_raw)>0?(y(e.price_per_m_raw)+t+a)*r:0,s=(o=e.fabric_variant)!=null&&o.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&y(e.sheer_price_per_m)>0?(y(e.sheer_price_per_m)+t+a)*r:0;return{total:Math.round(n+s),opaque:Math.round(n),sheer:Math.round(s)}},calculateDecoPrice:function(e){if(!e||e.is_suspended||y(e.width_m)<=0)return{total:0,sqm:0,sqyd:0};const t=y(e.width_m)*y(e.height_m),a=t*pe,r=a*y(e.price_sqyd);return{total:Math.round(r),sqm:t,sqyd:a}},calculateWallpaperPrice:function(e){var c;if(!e||e.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const t=((c=e.widths)==null?void 0:c.reduce((o,l)=>o+y(l),0))||0;if(t<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const a=y(e.height_m),r=this.wallpaperRolls(t,a),n=r*y(e.price_per_roll),s=r*(y(e.install_cost_per_roll)||0);return{total:Math.round(n+s),material:Math.round(n),install:Math.round(s),rolls:r,sqm:t*a}}};function ye(e){return e.rooms.reduce((t,a)=>{if(a.is_suspended)return t;const r=a.sets.reduce((c,o)=>c+b.calculateSetPrice(o).total,0),n=a.decorations.reduce((c,o)=>c+b.calculateDecoPrice(o).total,0),s=a.wallpapers.reduce((c,o)=>c+b.calculateWallpaperPrice(o).total,0);return t+r+n+s},0)}function ve(e,t){const a=ye(e);let r=`‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"numeric",year:"numeric"})})
`;if(r+=`‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${e.customer_name||"-"}
`,(t==="customer"||t==="owner")&&(r+=`‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${e.customer_phone||"-"}
`,r+=`‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${e.customer_address||"-"}
`),r+=`------------------------------
`,t==="customer")return r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
`,e.rooms.forEach(n=>{if(n.is_suspended||[...n.sets,...n.decorations,...n.wallpapers].filter(o=>o.is_suspended?!1:o.widths?o.widths.reduce((l,d)=>l+d,0)>0:o.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let c=0;n.sets.forEach(o=>{o.is_suspended||o.width_m<=0||(c++,r+=` ${c}) ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${o.style} (${o.fabric_variant})
`)}),n.decorations.forEach(o=>{o.is_suspended||o.width_m<=0||(c++,r+=` ${c}) ${o.type||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}
`)}),n.wallpapers.forEach(o=>{o.is_suspended||o.widths.reduce((l,d)=>l+d,0)<=0||(c++,r+=` ${c}) ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå
`)})}),r+=`------------------------------
`,r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${k(a)} ‡∏ö‡∏≤‡∏ó
`,r+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
${E.name}
‡πÇ‡∏ó‡∏£: ${E.phone}`,r;if(t==="purchase_order"||t==="owner"){const n={opaqueFabrics:[],sheerFabrics:[],decorations:[],wallpapers:[],allSets:[]};if(e.rooms.forEach(s=>{s.is_suspended||(s.sets.forEach(c=>{c.is_suspended||c.width_m<=0||(n.allSets.push(c),c.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&n.opaqueFabrics.push({code:c.fabric_code||"??",yards:b.fabricYardage(c.style,c.width_m)}),c.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&n.sheerFabrics.push({code:c.sheer_fabric_code||"??",yards:b.fabricYardage(c.style,c.width_m)}))}),s.decorations.forEach(c=>{c.is_suspended||!c.type||c.width_m<=0||n.decorations.push({type:c.type,code:c.deco_code||"xxx",width:c.width_m,height:c.height_m})}),s.wallpapers.forEach(c=>{if(c.is_suspended)return;const o=c.widths.reduce((l,d)=>l+d,0);if(o>0){const l=b.wallpaperRolls(o,c.height_m);l>0&&n.wallpapers.push({code:c.wallpaper_code||"xxx",rolls:l})}}))}),r+=`üìã *‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤*
`,r+=`------------------------------
`,n.opaqueFabrics.length>0&&n.opaqueFabrics.forEach(s=>{r+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),n.sheerFabrics.length>0&&n.sheerFabrics.forEach(s=>{r+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á*
`,r+=`------------------------------

`,n.allSets.length>0){let s=1;n.allSets.forEach(c=>{r+=`(${s++}) ‡∏£‡∏≤‡∏á‡∏°‡πà‡∏≤‡∏ô: ${c.style}, ‡∏™‡∏µ: ${c.track_color}
`,c.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${c.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),c.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${c.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),c.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"&&(r+=`  (‚ùóÔ∏è‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô)
`),r+=`
`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Blind*
`,r+=`------------------------------

`,n.decorations.length>0){const s={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"Wooden Blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"Roller Blind",‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"Vertical Blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"Partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"Pleated Insect Screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"Aluminium Blind"};n.decorations.forEach(c=>{const o=s[c.type]?` (${s[c.type]})`:"";r+=`- ${c.type}${o}
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${c.code||"xxx"}
`,r+=`‡∏Ç‡∏ô‡∏≤‡∏î: ${c.width.toFixed(2)} x ${c.height.toFixed(2)} m.
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: 1 ‡∏ä‡∏∏‡∏î

`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Wallpaper*
`,r+=`------------------------------

`,n.wallpapers.length>0&&n.wallpapers.forEach(s=>{r+=`- ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå -
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"xxx"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.rolls} ‡∏°‡πâ‡∏ß‡∏ô

`}),r+=`------------------------------
`,t==="purchase_order")return r}return(t==="seamstress"||t==="owner")&&(r+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á*
`,e.rooms.forEach(n=>{if(n.is_suspended||n.sets.filter(o=>!o.is_suspended&&o.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let c=1;n.sets.forEach(o=>{o.is_suspended||o.width_m<=0||(r+=`${c++}) *‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${o.style} ${o.fabric_variant}*
`,r+=`  ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${o.width_m} x ‡∏™‡∏π‡∏á ${o.height_m} ‡∏°.
`,r+=`  ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${o.opening_style}
`,o.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: ‡∏£‡∏´‡∏±‡∏™ ${o.fabric_code||"-"}
`),o.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: ‡∏£‡∏´‡∏±‡∏™ ${o.sheer_fabric_code||"-"}
`))})}),r+=`------------------------------
`,t==="seamstress")||t==="owner"&&(r+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${k(a)} ‡∏ö‡∏≤‡∏ó*
`),r}function ge(e){if(!e.rooms||e.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';const t={};let a=0,r="";if(e.rooms.forEach(c=>{if(c.is_suspended)return;const o={};c.sets.forEach(d=>{if(b.calculateSetPrice(d).total>0){const u="‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô";o[u]=(o[u]||0)+1,t[u]=(t[u]||0)+1}}),c.decorations.forEach(d=>{if(d.type&&b.calculateDecoPrice(d).total>0){const u=d.type;o[u]=(o[u]||0)+1,t[u]=(t[u]||0)+1}}),c.wallpapers.forEach(d=>{if(b.calculateWallpaperPrice(d).total>0){const u="‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå";o[u]=(o[u]||0)+1,t[u]=(t[u]||0)+1}});const l=Object.entries(o);l.length>0&&(r+=`<tr class="room-header-row"><td colspan="3">${c.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</td></tr>`,l.forEach(([d,u])=>{r+=`<tr><td></td><td class="item-type-cell">${d}</td><td class="pdf-text-center">${u}</td></tr>`,a+=u}))}),a===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let s=`<div id="detailed-material-summary">
        <h4><i class="ph ph-stack"></i> ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
        <ul><li class="summary-note">${Object.entries(t).map(([c,o])=>`${c}: ${o}`).join(" , ")}</li></ul>
    </div>`;return s+=`<table>
        <thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th class="pdf-text-center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th></tr></thead>
        <tbody>${r}</tbody>
    </table>`,s}function Se(e,t){const{vatRate:a,pageBreakBuffer:r=3}=t,n=[];e.rooms.forEach($=>{if($.is_suspended)return;const T=[];$.sets.forEach(S=>{const C=b.calculateSetPrice(S).total;if(C>0){let x=`‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${S.style} (${S.fabric_variant}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${S.width_m.toFixed(2)} x ${S.height_m.toFixed(2)} ‡∏°.${S.notes?` - ${S.notes}`:""}</small>`;T.push({description:x,total:C,units:x.includes("<br>")?1.5:1})}}),$.decorations.forEach(S=>{const C=b.calculateDecoPrice(S).total;if(C>0){let x=`${S.type||"‡∏á‡∏≤‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"} <br><small>‡∏£‡∏´‡∏±‡∏™: ${S.deco_code||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${S.width_m.toFixed(2)} x ${S.height_m.toFixed(2)} ‡∏°.</small>`;T.push({description:x,total:C,units:x.includes("<br>")?1.5:1})}}),$.wallpapers.forEach(S=>{const C=b.calculateWallpaperPrice(S).total;if(C>0){const x=S.widths.reduce((V,ee)=>V+ee,0),D=b.wallpaperRolls(x,S.height_m);let M=`‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå <br><small>‡∏£‡∏´‡∏±‡∏™: ${S.wallpaper_code||"-"}, ‡∏™‡∏π‡∏á ${S.height_m.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${D} ‡∏°‡πâ‡∏ß‡∏ô)</small>`;T.push({description:M,total:C,units:M.includes("<br>")?1.5:1})}}),T.length>0&&(n.push({isRoomHeader:!0,roomName:$.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),n.push(...T))});const s=n.reduce(($,T)=>$+(T.total||0),0);if(s===0)return null;const c=s*a,o=s+c,l=17,d=23,u=[];let m=[],p=0;n.forEach(($,T)=>{const S=u.length===0?l:d,C=p+$.units>S;let x=!1;if(!C&&T<n.length-1){const D=S-(p+$.units);D>0&&D<r&&(x=!0)}(C||x)&&m.length>0&&(u.push(m),m=[],p=0),m.push($),p+=$.units}),m.length>0&&u.push(m);const h=new Date,g=h.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),L=`QT-${h.getFullYear()}${(h.getMonth()+1).toString().padStart(2,"0")}${h.getDate().toString().padStart(2,"0")}`;let q="",f=0,v=1;u.forEach(($,T)=>{const S=T===0,C=T===u.length-1,x=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${E.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong>${E.name}</strong><br>
                            ${E.address.replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${E.phone} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${E.taxId}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${u.length>1?S?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${L}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${g}</td></tr>
                        </table>
                    </div>
                </div>
                ${S?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${e.customer_name||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${e.customer_address.replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${e.customer_phone||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${E.pdf.paymentTerms}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${E.pdf.priceValidity}
                    </div>
                </section>`:""}
            </div>`,D=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span>${E.name} | ‡πÇ‡∏ó‡∏£: ${E.phone}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${T+1} / ${u.length}</span>
                </div>
            </div>`;let M="";S||(M+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${N(f,2,!0)}</td></tr>`),$.forEach(P=>{P.isRoomHeader?M+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${P.roomName}</td></tr>`:(M+=`<tr><td class="pdf-text-center">${v++}</td><td>${P.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${N(P.total,2,!0)}</td><td class="pdf-text-right">${N(P.total,2,!0)}</td></tr>`,f+=P.total)});let V="";C||(V=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${N(f,2,!0)}</td></tr></tfoot>`);const ee=C?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                        <ul>${E.pdf.notes.map(P=>`<li>${P}</li>`).join("")}</ul>
                        <div class="pdf-amount-text">( ${_e(o)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td colspan="2" class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${N(s,2,!0)}</td></tr>
                            ${a>0?`<tr><td colspan="2" class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(a*100).toFixed(0)}%</td><td class="pdf-amount">${N(c,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td colspan="2" class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${N(o,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(${E.name})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${g}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";q+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${x}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${M}</tbody>
                            ${V}
                        </table>
                        ${ee}
                    </div>
                    ${D}
                </div>
            </div>`});const I=(e.customer_name||"quote").trim().replace(/\s+/g,"-");return{html:`<div id="quotation-template">${q}</div>`,fileName:`${L}_${I}`}}const se="marnthara.favorites.v1";function re(){try{const e=localStorage.getItem(se),t={fabric:[],sheer:[],deco:[],wallpaper:[]};return e?{...t,...JSON.parse(e)}:t}catch(e){return console.error("Failed to parse favorites from localStorage",e),{fabric:[],sheer:[],deco:[],wallpaper:[]}}}function we(e){try{localStorage.setItem(se,JSON.stringify(e))}catch(t){console.error("Failed to save favorites to localStorage",t)}}function qe(e,t){if(!e||!t||typeof t!="string"||t.trim()==="")return!1;const a=t.trim(),r=re();r[e]||(r[e]=[]);const n=r[e].indexOf(a);let s=!1;return n>-1?(r[e].splice(n,1),s=!1):(r[e].push(a),r[e].sort(),s=!0),we(r),s}function be(e,t){var r;return!e||!t?!1:((r=re()[e])==null?void 0:r.includes(t.trim()))??!1}let B=!1,oe=null;function w(e,t="default"){const a=document.querySelector(i.toastContainer);if(!a)return;const r={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},n=document.createElement("div");n.className=`toast toast-${t}`,n.innerHTML=`<i class="${r[t]||r.default}"></i> ${e}`,a.appendChild(n),setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),n.addEventListener("transitionend",()=>n.remove())},3e3)}function K(e,t){return new Promise(a=>{const r=document.querySelector(e);if(!r){a(null);return}r.classList.add("visible");const n=r.querySelector('[id$="Confirm"]'),s=r.querySelector('[id$="Cancel"]'),c=l=>{r.classList.remove("visible"),n&&(n.onclick=null),s&&(s.onclick=null),document.removeEventListener("keydown",o),!l&&t&&t(),a(l)},o=l=>{l.key==="Escape"&&c(!1)};n&&(n.onclick=()=>c(!0)),s&&(s.onclick=()=>c(!1)),document.addEventListener("keydown",o)})}async function G(e,t){const a=document.querySelector(i.modal);if(!a)return!0;const r=a.querySelector(i.modalTitle),n=a.querySelector(i.modalBody);return r&&(r.textContent=e),n&&(n.textContent=t),await K(i.modal)}async function Le(){const e=document.querySelector(i.exportOptionsModal);if(!e||!await K(i.exportOptionsModal))return null;const a=e.querySelector('input[name="vat_option"]:checked'),r=e.querySelector("#exportMethod"),n=e.querySelector("#pageBreakBuffer");return{vatOption:a?a.value:"include",exportMethod:r?r.value:"direct",pageBreakBuffer:n?parseInt(n.value,10):3}}function W(e,t){e&&(e.classList.add("item-removing"),e.addEventListener("animationend",()=>{e.remove(),t&&w(t),z(),X(),F(),R()},{once:!0}))}function X(){document.querySelectorAll(i.room).forEach(e=>{const t=e.querySelectorAll(".item-card"),a=t.length;t.forEach((r,n)=>{const s=r.querySelector("[data-item-title]");s&&(s.textContent=`${n+1}/${a}`)})})}function ce(){const e=document.querySelector(i.orderForm),t=document.querySelector(i.lockBtn);if(!e||!t)return;const a=e.querySelectorAll("input, select, textarea, button");e.classList.toggle("is-locked",B),t.classList.toggle("is-locked",B);const r=t.querySelector("i");r&&(r.className=B?"ph-bold ph-lock-key":"ph-bold ph-lock-key-open"),a.forEach(n=>{n.closest(".summary-footer")||n.closest(".main-header")||n.closest(".modal-wrapper")||(n.disabled=B)}),w(B?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",B?"warning":"success")}function H(){const e=document.querySelectorAll(i.allDetailsCards);if(e.length===0)return;const t=[...e].every(r=>r.open),a=document.querySelector(i.toggleAllRoomsBtn);if(a){const r=a.querySelector("i"),n=a.querySelector("span");r&&(r.className=t?"ph ph-rows-slash":"ph ph-rows"),n&&(n.textContent=t?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}}function $e(){const e=document.querySelectorAll(i.allDetailsCards),t=[...e].every(a=>a.open);e.forEach(a=>{a.open=!t}),setTimeout(H,50)}function z(){const e=document.querySelector(i.quickNavRoomList);if(!e)return;e.innerHTML="",document.querySelectorAll(i.room).forEach(a=>{const r=a.querySelector(i.roomNameInput),n=r?r.value:"‡∏´‡πâ‡∏≠‡∏á",s=document.createElement("a");s.href=`#${a.id}`,s.dataset.jumpTo=a.id,s.innerHTML=`<i class="ph ph-arrow-bend-left-up"></i> ${n||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)"}`,e.appendChild(s)})}function ne(){document.querySelectorAll(".favorite-chips-container.show").forEach(e=>{e.classList.remove("show")}),oe=null}function Z(e){if(!e)return;const t=e.nextElementSibling;if(!t||!t.matches(".btn-favorite"))return;const a=t.dataset.type,r=be(a,e.value);t.classList.toggle("is-favorite",r),t.querySelector("i").className=r?"ph-fill ph-star":"ph ph-star"}function Te(e){ne();const t=e.dataset.favoriteType;if(!t)return;const a=re()[t]||[];if(a.length===0)return;const r=e.closest(".form-group-with-favorites").querySelector(".favorite-chips-container");r&&(r.innerHTML="",a.forEach(n=>{const s=document.createElement("button");s.type="button",s.className="btn-chip",s.textContent=n,s.dataset.act="select-favorite",s.dataset.code=n,r.appendChild(s)}),r.classList.add("show"))}function U(e,t,a=!0){const r=document.querySelector(e);if(!r||!t)return null;const n=r.content.cloneNode(!0),s=n.firstElementChild;return t.appendChild(n),s.querySelectorAll("input[data-favorite-type]").forEach(Z),a&&s&&(s.classList.add("item-created"),s.scrollIntoView({behavior:"smooth",block:"center"})),X(),F(),R(),s}function J(){const e=document.querySelector(i.roomsContainer);if(!e)return;const t=document.querySelectorAll(i.roomNameInput);let a=0;t.forEach(s=>{const c=s.value.match(/\d+/g);if(c){const o=parseInt(c[c.length-1],10);o>a&&(a=o)}});const r=a+1,n=U("#roomTpl",e,!0);if(n){n.id=`room-${Date.now()}`;const s=n.querySelector(i.roomNameInput);s&&(s.value=`‡∏´‡πâ‡∏≠‡∏á ${r}`),n.open=!0}z(),H()}function ke(e){if(!e)return;const t=e.querySelector(i.setsContainer);t&&U("#setTpl",t)}function Ce(e){if(!e)return;const t=e.querySelector(i.decorationsContainer);t&&U("#decoTpl",t)}function Ee(e){if(!e)return;const t=e.querySelector(i.wallpapersContainer);if(t){const a=U("#wallpaperTpl",t);a&&le(a.querySelector('[data-act="add-wall"]'))}}function le(e){var a;const t=(a=e==null?void 0:e.closest(".walls-section"))==null?void 0:a.querySelector(i.wallsContainer);t&&(U("#wallTpl",t,!1),j(e))}function ie(e){var n,s;if(!e)return;const t=(n=e.querySelector('select[name="fabric_variant"]'))==null?void 0:n.value,a=t&&t.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");(s=e.querySelector(i.sheerWrap))==null||s.classList.toggle("hidden",!a);const r=e.querySelector('input[name="sheer_fabric_code"]');if(r){const c=r.closest(".form-group-with-favorites");c&&c.classList.toggle("hidden",!a)}}const xe=fe(e=>{j(e),R()});function Be(e){if(B){w("‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ","warning"),e.preventDefault();return}e.target.matches("input[data-favorite-type]")&&Z(e.target),xe(e.target)}function Ne(e){if(B)return;const t=e.target;if(t.matches('select[name="fabric_variant"]')&&ie(t.closest(i.set)),t.matches('select[name="deco_type"]')){const a=t.closest(i.decoItem),r=a==null?void 0:a.querySelector(".deco-type-display");r&&(r.textContent=t.value||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á")}t.matches(i.roomNameInput)&&z(),j(t),R()}function Ie(e){const t=e.target,a=t.matches('[name="deco_price_sqyd"], [name="wallpaper_price_roll"], [name="wallpaper_install_cost"]'),r=t.matches('input[name="width_m"], input[name="height_m"], input[name="deco_width_m"], input[name="deco_height_m"], input[name="wallpaper_height_m"], input[name="wall_width_m"]');if(a){const n=y(t.value);n>0?t.value=k(n):t.value=""}else r&&(t.value=A(t.value))}function Pe(e){const t=e.target;t.matches("input[data-favorite-type]")&&(oe=t,Te(t))}function j(e){var n,s,c,o,l,d,u,m,p,h,g,L;if(!e)return;const t=e.closest(i.set);if(t){const q=t.querySelector("[data-set-summary]");if(q){const f={width_m:(n=t.querySelector('input[name="width_m"]'))==null?void 0:n.value,height_m:(s=t.querySelector('input[name="height_m"]'))==null?void 0:s.value,style:(c=t.querySelector('select[name="set_style"]'))==null?void 0:c.value,fabric_variant:(o=t.querySelector('select[name="fabric_variant"]'))==null?void 0:o.value,price_per_m_raw:(l=t.querySelector('select[name="set_price_per_m"]'))==null?void 0:l.value,sheer_price_per_m:(d=t.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:d.value},v=b.calculateSetPrice(f);let _=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${k(v.total)}</b> ‡∏ö.`;v.opaque>0&&v.sheer>0&&(_+=` <small>(‡∏ó‡∏∂‡∏ö: ${k(v.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${k(v.sheer)})</small>`),q.innerHTML=_}}const a=e.closest(i.decoItem);if(a){const q=a.querySelector("[data-deco-summary]");if(q){const f={width_m:(u=a.querySelector('input[name="deco_width_m"]'))==null?void 0:u.value,height_m:(m=a.querySelector('input[name="deco_height_m"]'))==null?void 0:m.value,price_sqyd:(p=a.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:p.value},v=b.calculateDecoPrice(f);q.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${k(v.total)}</b> ‡∏ö. &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${N(v.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`}}const r=e.closest(i.wallpaperItem);if(r){const q=r.querySelector("[data-wallpaper-summary]");if(q){const f={height_m:(h=r.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:h.value,price_per_roll:(g=r.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:g.value,install_cost_per_roll:(L=r.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:L.value,widths:Array.from(r.querySelectorAll('input[name="wall_width_m"]')).map(I=>I.value)},v=b.calculateWallpaperPrice(f);let _=`‡∏£‡∏ß‡∏°: <b>${k(v.total)}</b> ‡∏ö. `;(v.material>0||v.install>0)&&(_+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${k(v.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${k(v.install)})</small>`),_+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${N(v.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${v.rolls} ‡∏°‡πâ‡∏ß‡∏ô`,q.innerHTML=_}}F()}function F(){let e=0,t=0;document.querySelectorAll(i.room).forEach(n=>{let s=0,c=0;const o=n.classList.contains("is-suspended");n.querySelectorAll(i.set).forEach(d=>{var m,p,h,g,L,q;const u=b.calculateSetPrice({is_suspended:o||d.classList.contains("is-suspended"),width_m:(m=d.querySelector('input[name="width_m"]'))==null?void 0:m.value,height_m:(p=d.querySelector('input[name="height_m"]'))==null?void 0:p.value,style:(h=d.querySelector('select[name="set_style"]'))==null?void 0:h.value,fabric_variant:(g=d.querySelector('select[name="fabric_variant"]'))==null?void 0:g.value,price_per_m_raw:(L=d.querySelector('select[name="set_price_per_m"]'))==null?void 0:L.value,sheer_price_per_m:(q=d.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:q.value}).total;s+=u,u>0&&(t++,c++)}),n.querySelectorAll(i.decoItem).forEach(d=>{var m,p,h;const u=b.calculateDecoPrice({is_suspended:o||d.classList.contains("is-suspended"),width_m:(m=d.querySelector('input[name="deco_width_m"]'))==null?void 0:m.value,height_m:(p=d.querySelector('input[name="deco_height_m"]'))==null?void 0:p.value,price_sqyd:(h=d.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:h.value}).total;s+=u,u>0&&(t++,c++)}),n.querySelectorAll(i.wallpaperItem).forEach(d=>{var m,p,h;const u=b.calculateWallpaperPrice({is_suspended:o||d.classList.contains("is-suspended"),height_m:(m=d.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:m.value,price_per_roll:(p=d.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:p.value,install_cost_per_roll:(h=d.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:h.value,widths:Array.from(d.querySelectorAll('input[name="wall_width_m"]')).map(g=>g.value)}).total;s+=u,u>0&&(t++,c++)});const l=n.querySelector("[data-room-brief]");l&&(o?l.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":c>0?l.innerHTML=`<span>${c}</span> &bull; ${k(s)} ‡∏ö‡∏≤‡∏ó`:l.textContent=""),e+=o?0:s});const a=document.querySelector(i.grandTotal),r=document.querySelector(i.setCount);a&&(a.textContent=k(e)),r&&(r.textContent=t)}function ae(e){if(!e||!e.rooms)return;const t=document.querySelector(i.roomsContainer);if(!t)return;t.innerHTML="";const a=document.querySelector("#customer_name"),r=document.querySelector("#customer_phone"),n=document.querySelector("#customer_address");a&&(a.value=e.customer_name||""),r&&(r.value=e.customer_phone||""),n&&(n.value=e.customer_address||""),e.rooms.forEach(s=>{const c=document.querySelector("#roomTpl");if(!c)return;const o=c.content.cloneNode(!0),l=o.querySelector(i.room);if(!l)return;l.id=s.id||`room-${Date.now()}`,s.is_suspended&&l.classList.add("is-suspended");const d=l.querySelector(i.roomNameInput);d&&(d.value=s.room_name||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)");const u=l.querySelector(i.setsContainer),m=l.querySelector(i.decorationsContainer),p=l.querySelector(i.wallpapersContainer),h=document.querySelector("#setTpl"),g=document.querySelector("#decoTpl"),L=document.querySelector("#wallpaperTpl"),q=document.querySelector("#wallTpl");u&&h&&s.sets&&s.sets.forEach(f=>{const v=h.content.cloneNode(!0),_=v.querySelector(i.set);f.is_suspended&&_.classList.add("is-suspended"),_.querySelector('input[name="width_m"]').value=A(f.width_m),_.querySelector('input[name="height_m"]').value=A(f.height_m),_.querySelector('select[name="set_style"]').value=f.style||"‡∏•‡∏≠‡∏ô",_.querySelector('select[name="fabric_variant"]').value=f.fabric_variant||"‡∏ó‡∏∂‡∏ö",_.querySelector('select[name="set_price_per_m"]').value=f.price_per_m_raw||"",_.querySelector('select[name="sheer_price_per_m"]').value=f.sheer_price_per_m||"",_.querySelector('select[name="opening_style"]').value=f.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á",_.querySelector('select[name="track_color"]').value=f.track_color||"‡∏Ç‡∏≤‡∏ß",_.querySelector('input[name="fabric_code"]').value=f.fabric_code||"",_.querySelector('input[name="sheer_fabric_code"]').value=f.sheer_fabric_code||"",_.querySelector('input[name="notes"]').value=f.notes||"",ie(_),u.appendChild(v)}),m&&g&&s.decorations&&s.decorations.forEach(f=>{const v=g.content.cloneNode(!0),_=v.querySelector(i.decoItem);f.is_suspended&&_.classList.add("is-suspended");const I=_.querySelector('select[name="deco_type"]');I.value=f.type||"",_.querySelector(".deco-type-display").textContent=f.type||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",_.querySelector('input[name="deco_width_m"]').value=A(f.width_m),_.querySelector('input[name="deco_height_m"]').value=A(f.height_m),_.querySelector('input[name="deco_price_sqyd"]').value=k(f.price_sqyd)||"",_.querySelector('input[name="deco_code"]').value=f.deco_code||"",_.querySelector('input[name="deco_notes"]').value=f.notes||"",m.appendChild(v)}),p&&L&&s.wallpapers&&s.wallpapers.forEach(f=>{const v=L.content.cloneNode(!0),_=v.querySelector(i.wallpaperItem);f.is_suspended&&_.classList.add("is-suspended"),_.querySelector('input[name="wallpaper_height_m"]').value=A(f.height_m),_.querySelector('input[name="wallpaper_code"]').value=f.wallpaper_code||"",_.querySelector('input[name="wallpaper_price_roll"]').value=k(f.price_per_roll)||"",_.querySelector('input[name="wallpaper_install_cost"]').value=f.hasOwnProperty("install_cost_per_roll")?k(f.install_cost_per_roll):"300",_.querySelector('input[name="wallpaper_notes"]').value=f.notes||"";const I=_.querySelector(i.wallsContainer);I&&q&&f.widths&&f.widths.forEach($=>{const T=q.content.cloneNode(!0);T.querySelector('input[name="wall_width_m"]').value=A($),I.appendChild(T)}),p.appendChild(v)}),t.appendChild(o)}),document.querySelectorAll("input[data-favorite-type]").forEach(Z),document.querySelectorAll(".item-card").forEach(s=>{j(s)}),X(),F(),z(),H(),w("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}function Re(e,t){const a=document.querySelector(i.printableContent);!a||!e||!e.html||(a.innerHTML=e.html,setTimeout(()=>{if(t==="direct"){const r=document.getElementById("quotation-template");r&&html2pdf().from(r).set({margin:[15,12,10,12],filename:`${e.fileName}.pdf`,pagebreak:{mode:["css","legacy"]},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).save().then(()=>{a.innerHTML=""})}else t==="print"&&(window.print(),a.innerHTML="")},me))}function Fe(e){if(!e||!e.html)return;const t=new Blob([e.html],{type:"text/html;charset=utf-8"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`${e.fileName}.html`,r.click(),URL.revokeObjectURL(a),w("Export ‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}const Me=e=>{var s,c;const t=e.target.closest("[data-act]");if(!t||B&&!t.closest(".unlockable")&&t.dataset.act!=="select-favorite")return;const a=t.dataset.act,r=t.closest(i.room),n=(o,l,d)=>{G(o,l).then(u=>{u&&d()})};switch(a){case"add-room":J();break;case"add-set":ke(r);break;case"add-deco":Ce(r);break;case"add-wallpaper":Ee(r);break;case"add-wall":le(t);break;case"del-room":n("‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>W(r,"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-set":n("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô?",()=>W(t.closest(i.set),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-deco":n("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á?",()=>W(t.closest(i.decoItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wallpaper":n("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå?",()=>W(t.closest(i.wallpaperItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wall":n("‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",()=>W(t.closest(".wall-input-row"),"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"clear-room":n("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>{r.querySelector(i.setsContainer).innerHTML="",r.querySelector(i.decorationsContainer).innerHTML="",r.querySelector(i.wallpapersContainer).innerHTML="",X(),F(),R(),w("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success")});break;case"toggle-room-menu":e.preventDefault();const o=t.nextElementSibling;if(!o||!r)return;const l=!o.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(p=>p.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(p=>p.classList.remove("overflow-visible")),l&&(o.classList.add("show"),r.classList.add("overflow-visible"));break;case"toggle-suspend-room":e.preventDefault(),r==null||r.classList.toggle("is-suspended"),F(),R(),(s=t.closest(".room-options-menu"))==null||s.classList.remove("show"),r==null||r.classList.remove("overflow-visible");break;case"toggle-suspend":e.preventDefault(),(c=t.closest(".item-card"))==null||c.classList.toggle("is-suspended"),j(t),R();break;case"toggle-favorite":const d=t.dataset.type,u=t.previousElementSibling,m=u.value;if(m&&m.trim()!==""){const p=qe(d,m);Z(u),w(p?"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß":"‡∏•‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success")}else w("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");break;case"select-favorite":{const p=t.dataset.code,h=t.closest(".form-group-with-favorites"),g=h?h.querySelector("input[data-favorite-type]"):oe;g&&(g.value=p,g.dispatchEvent(new Event("input",{bubbles:!0})),ne(),w(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î ${p} ‡πÅ‡∏•‡πâ‡∏ß`,"success"))}break}};function Ae(){B=!B,ce()}function De(){const e=document.querySelector(i.setTpl);if(!e)return;const t=e.content.querySelector('select[name="set_price_per_m"]'),a=e.content.querySelector('select[name="sheer_price_per_m"]'),r=n=>{let s='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return n.forEach(c=>{s+=`<option value="${c}">${c.toLocaleString("th-TH")}</option>`}),s};t&&(t.innerHTML=r(Q.fabric)),a&&(a.innerHTML=r(Q.sheer))}function Oe(){De();const e=document.querySelector(i.orderForm),t=document.querySelector(i.fileImporter),a=document.querySelector(i.menuDropdown),r=document.querySelector(i.quickNavDropdown),n=document.querySelector("#pageBreakBuffer"),s=document.querySelector("#pageBreakBufferValue");n&&s&&n.addEventListener("input",()=>{s.textContent=n.value}),e.addEventListener("input",Be),e.addEventListener("change",Ne),e.addEventListener("click",Me),e.addEventListener("blur",Ie,!0),e.addEventListener("focusin",Pe),document.body.addEventListener("click",o=>{o.target.closest("summary")&&setTimeout(H,50)}),document.querySelector(i.lockBtn).addEventListener("click",Ae),document.querySelector(i.toggleAllRoomsBtn).addEventListener("click",$e),document.querySelector(i.quickNavBtn).addEventListener("click",o=>{o.stopPropagation(),a.classList.remove("show"),r.classList.toggle("show")}),document.querySelector(i.quickNavRoomList).addEventListener("click",o=>{const l=o.target.closest("a[data-jump-to]");if(l){o.preventDefault();const d=l.dataset.jumpTo,u=document.getElementById(d);u&&(document.body.classList.add("disable-animations"),u.open=!0,u.scrollIntoView({behavior:"auto",block:"start"}),u.classList.add("scrolling-jump"),setTimeout(()=>{u.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),H()},1e3)),r.classList.remove("show")}});const c=document.querySelector("#addRoomQuickNavBtn");if(c){const o=he(J,700);c.addEventListener("click",l=>{l.stopPropagation(),o(),r.classList.remove("show")})}document.querySelector(i.menuBtn).addEventListener("click",o=>{o.stopPropagation(),r.classList.remove("show"),a.classList.toggle("show")}),document.querySelector("#overviewBtn").addEventListener("click",async o=>{o.preventDefault(),a.classList.remove("show");const l=O(),d=ge(l),u=document.querySelector("#overviewModalBody");u&&(u.innerHTML=d,K("#overviewModal",()=>{}))}),document.querySelector(i.exportPdfBtn).addEventListener("click",async o=>{o.preventDefault(),a.classList.remove("show");const l=await Le();if(!l)return;const d=O(),u=l.vatOption==="include"?E.baseVatRate:0,m=Se(d,{vatRate:u,pageBreakBuffer:l.pageBreakBuffer});if(!m){w("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}l.exportMethod==="html"?Fe(m):Re(m,l.exportMethod)}),document.querySelector(i.importBtn).addEventListener("click",o=>{o.preventDefault(),a.classList.remove("show"),t.click()}),t.addEventListener("change",o=>{var u;const l=(u=o.target.files)==null?void 0:u[0];if(!l)return;const d=new FileReader;d.onload=m=>{try{const p=JSON.parse(m.target.result);ae(p)}catch{w("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error")}},d.readAsText(l),o.target.value=null}),document.querySelector(i.exportBtn).addEventListener("click",o=>{o.preventDefault(),a.classList.remove("show");try{const l=O(),d=JSON.stringify(l,null,4),u=new Blob([d],{type:"application/json"}),m=URL.createObjectURL(u),p=document.createElement("a"),h=new Date,g=`${h.getFullYear()}${(h.getMonth()+1).toString().padStart(2,"0")}${h.getDate().toString().padStart(2,"0")}`,L=(l.customer_name||"data").trim().replace(/\s+/g,"-");p.href=m,p.download=`MTR-${L}-${g}.json`,p.click(),URL.revokeObjectURL(m),w("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{w("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(i.submitBtn).addEventListener("click",async o=>{if(o.preventDefault(),a.classList.remove("show"),await G("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const l=O();if(!l.customer_name&&!l.customer_phone){w("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}w("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const d=await fetch(de,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});d.ok?w("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):w(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${d.status}`,"error")}catch{w("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(i.copyTextBtn).addEventListener("click",async o=>{o.preventDefault(),a.classList.remove("show");const l=document.querySelector(i.copyOptionsModal);if(l.querySelector('input[name="copy_option"][value="customer"]').checked=!0,await K(i.copyOptionsModal)){const d=l.querySelector('input[name="copy_option"]:checked').value,u=ve(O(),d);try{await navigator.clipboard.writeText(u),w("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{w("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(i.clearItemsBtn).addEventListener("click",async o=>{o.preventDefault(),a.classList.remove("show"),await G("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")&&(document.querySelectorAll(i.room).forEach(l=>{l.querySelector(i.setsContainer).innerHTML="",l.querySelector(i.decorationsContainer).innerHTML="",l.querySelector(i.wallpapersContainer).innerHTML=""}),F(),R(),w("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))}),document.querySelector(i.clearAllBtn).addEventListener("click",async o=>{o.preventDefault(),a.classList.remove("show"),await G("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ")&&(localStorage.removeItem(Y),window.location.reload())}),window.addEventListener("click",o=>{o.target.closest(".menu-container")||(a.classList.remove("show"),r.classList.remove("show")),o.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(l=>l.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(l=>l.classList.remove("overflow-visible"))),o.target.closest(".form-group-with-favorites")||ne()});try{const o=localStorage.getItem(Y);if(o)ae(JSON.parse(o));else{J();const l=document.querySelector("#customerDetailsCard");l&&(l.open=!0)}}catch{localStorage.removeItem(Y),J()}F(),ce(),H()}document.addEventListener("DOMContentLoaded",Oe);
