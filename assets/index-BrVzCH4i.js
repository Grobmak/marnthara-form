(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const Ee="input-ui/5.6.0-final",Be="https://your-make-webhook-url.com/your-unique-path",le="marnthara.input.v4",Me=500,C={name:"‡∏°‡πà‡∏≤‡∏ô‡∏ò‡∏≤‡∏£‡∏≤ ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",address:"65/8 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡∏ó‡πà‡∏≤‡∏®‡∏≤‡∏•‡∏≤ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡∏•‡∏û‡∏ö‡∏∏‡∏£‡∏µ 15000",phone:"092-985-9395, 082-552-5595",taxId:"1234567890123",logoUrl:"https://i.imgur.com/l7y85nI.png",baseVatRate:.07,pdf:{paymentTerms:"‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50%",priceValidity:"30 ‡∏ß‡∏±‡∏ô",notes:["‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß","‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 50% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ú‡∏•‡∏¥‡∏ï‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤","‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏ 30 ‡∏ß‡∏±‡∏ô ‡∏ô‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤"]}},Ae=1.19599,pe={ROLL_WIDTH_M:.53,ROLL_LENGTH_M:10,STRIPS_PER_ROLL_UNDER_2_5M:3},de={fabric:[1e3,1100,1200,1300,1400,1500,1600,1700,1800,1900,2e3,2100,2200],sheer:[1e3,1100,1200,1300,1400,1500],style_surcharge:{‡∏•‡∏≠‡∏ô:200,‡∏ï‡∏≤‡πÑ‡∏Å‡πà:0,‡∏à‡∏µ‡∏ö:0},height:[{threshold:3.2,add_per_m:300},{threshold:2.8,add_per_m:200},{threshold:2.5,add_per_m:100}]},m={orderForm:"#orderForm",roomsContainer:"#rooms",setTpl:"#setTpl",clearAllBtn:"#clearAllBtn",lockBtn:"#lockBtn",grandTotal:"#grandTotal",setCount:"#setCount",modal:"#confirmationModal",modalTitle:"#modalTitle",modalBody:"#modalBody",room:"[data-room]",set:"[data-set]",setsContainer:"[data-sets]",decorationsContainer:"[data-decorations]",decoItem:"[data-deco-item]",wallpapersContainer:"[data-wallpapers]",wallpaperItem:"[data-wallpaper-item]",wallsContainer:"[data-walls-container]",sheerWrap:"[data-sheer-wrap]",roomNameInput:'input[name="room_name"]',toastContainer:"#toast-container",copyTextBtn:"#copyTextBtn",copyOptionsModal:"#copyOptionsModal",menuBtn:"#menuBtn",menuDropdown:"#menuDropdown",importBtn:"#importBtn",exportBtn:"#exportBtn",fileImporter:"#fileImporter",submitBtn:"#submitBtn",clearItemsBtn:"#clearItemsBtn",exportPdfBtn:"#exportPdfBtn",exportOptionsModal:"#exportOptionsModal",printableContent:"#printable-content",quickNavBtn:"#quickNavBtn",quickNavDropdown:"#quickNavDropdown",quickNavRoomList:"#quickNavRoomList",toggleAllRoomsBtn:"#toggleAllRoomsBtn"},g=t=>{typeof t=="string"&&(t=t.replace(/,/g,""));const e=parseFloat(t);return Number.isFinite(e)?e:0},U=t=>{const e=g(t);return e>0?e.toFixed(2):""},N=(t,e=2,o=!1)=>Number.isFinite(t)?t.toLocaleString("en-US",{minimumFractionDigits:o?2:e,maximumFractionDigits:o?2:e}):"0",I=(t,e=0)=>Number.isFinite(t)?t.toLocaleString("th-TH",{minimumFractionDigits:e,maximumFractionDigits:e}):"0",Pe=(t,e=150)=>{let o;return(...r)=>{clearTimeout(o),o=setTimeout(()=>t(...r),e)}},Ne=(t,e=700)=>{let o=!1;return(...r)=>{if(!o){o=!0;try{return t(...r)}finally{setTimeout(()=>{o=!1},e)}}}},L=t=>typeof t!="string"?"":t.replace(/[&<>"']/g,function(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";default:return"&#039;"}}),we=t=>typeof t!="string"?"":t.replace(/[\\/?%*:|"<>\x00-\x1f]/g,"").trim()||"file";function Fe(t){let e=g(t);if(isNaN(e))return"‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";if(e===0)return"‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏≤‡∏ó‡∏ñ‡πâ‡∏ß‡∏ô";const o=["","‡∏´‡∏ô‡∏∂‡πà‡∏á","‡∏™‡∏≠‡∏á","‡∏™‡∏≤‡∏°","‡∏™‡∏µ‡πà","‡∏´‡πâ‡∏≤","‡∏´‡∏Å","‡πÄ‡∏à‡πá‡∏î","‡πÅ‡∏õ‡∏î","‡πÄ‡∏Å‡πâ‡∏≤"],r=["","‡∏™‡∏¥‡∏ö","‡∏£‡πâ‡∏≠‡∏¢","‡∏û‡∏±‡∏ô","‡∏´‡∏°‡∏∑‡πà‡∏ô","‡πÅ‡∏™‡∏ô","‡∏•‡πâ‡∏≤‡∏ô"];let n=Math.floor(e),s=Math.round((e-n)*100);const a=c=>{if(c===0)return"";let i="";const d=String(c);for(let p=0;p<d.length;p++){const f=d[p];d.length-1;const h=d.length-p-1;f!=="0"&&(h===1&&f==="1"?i+=r[h]:h===1&&f==="2"?i+="‡∏¢‡∏µ‡πà"+r[h]:h===0&&f==="1"&&d.length>1?i+="‡πÄ‡∏≠‡πá‡∏î":i+=o[parseInt(f)]+r[h])}return i};let l="";if(n>0){const c=Math.floor(n/1e6),i=n%1e6;c>0&&(l+=a(c)+"‡∏•‡πâ‡∏≤‡∏ô"),l+=a(i),l+="‡∏ö‡∏≤‡∏ó"}let u="";return s>0?u=a(s)+"‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå":l+="‡∏ñ‡πâ‡∏ß‡∏ô",(l+u).trim()}const _e="marnthara.favorites.v3";function H(){try{const t=localStorage.getItem(_e),e={fabric:[],sheer:[],deco:{},wallpaper:[]};return t?{...e,...JSON.parse(t)}:e}catch(t){return console.error("Failed to parse favorites from localStorage",t),{fabric:[],sheer:[],deco:{},wallpaper:[]}}}function ee(t){try{localStorage.setItem(_e,JSON.stringify(t))}catch(e){console.error("Failed to save favorites to localStorage",e)}}function Re(t){if(!t||typeof t!="object")return console.error("Invalid favorites data for import."),!1;const o={...{fabric:[],sheer:[],deco:{},wallpaper:[]},...t};return ee(o),!0}function te(t,e,o){return e==="deco"?o?(t.deco[o]||(t.deco[o]=[]),t.deco[o]):null:(t[e]||(t[e]=[]),t[e])}function Oe(t,e,o,r=null){const n=H(),s=te(n,t,r);if(!s)return!1;const a=s.find(l=>l.code===e);return a?a.price=o:s.push({code:e,price:o}),s.sort((l,u)=>l.code.localeCompare(u.code)),ee(n),!0}function De(t,e,o,r=null){const n=H(),s=te(n,t,r);return!s||s.some(a=>a.code===e)?!1:(s.push({code:e,price:o}),s.sort((a,l)=>a.code.localeCompare(l.code)),ee(n),!0)}function He(t,e,o,r,n=null){const s=H(),a=te(s,t,n);if(!a||e!==o&&a.some(u=>u.code===o))return!1;const l=a.find(u=>u.code===e);return l?(l.code=o,l.price=r,a.sort((u,c)=>u.code.localeCompare(c.code)),ee(s),!0):!1}function qe(t,e,o=null){const r=H(),n=te(r,t,o);if(!n)return!1;const s=n.findIndex(a=>a.code===e);return s>-1?(n.splice(s,1),ee(r),!0):!1}function be(t,e,o=null){if(!t||!e)return;const r=H(),n=e.trim(),s=te(r,t,o);return s==null?void 0:s.find(a=>a.code===n)}function We(t,e,o,r=null){const n=be(t,e,r);return n&&n.price===o?(qe(t,e,r),!1):(Oe(t,e,o,r),!0)}function Ue(){localStorage.removeItem(_e),console.log("All favorites have been cleared.")}function V(){var o,r,n,s;const t=H(),e={app_version:Ee,customer_name:((o=document.querySelector('[name="customer_name"]'))==null?void 0:o.value)||"",customer_phone:((r=document.querySelector('[name="customer_phone"]'))==null?void 0:r.value)||"",customer_address:((n=document.querySelector('[name="customer_address"]'))==null?void 0:n.value)||"",customer_card_open:(s=document.querySelector("#customerDetailsCard"))==null?void 0:s.open,rooms:[],favorites:t};return document.querySelectorAll(m.room).forEach(a=>{var u;const l={id:a.id,room_name:((u=a.querySelector(m.roomNameInput))==null?void 0:u.value)||"",is_suspended:a.classList.contains("is-suspended"),is_open:a.open,sets:[],decorations:[],wallpapers:[]};a.querySelectorAll(m.set).forEach(c=>{var i,d,p,f,h,_,w,q,y,T,S;l.sets.push({width_m:g((i=c.querySelector('input[name="width_m"]'))==null?void 0:i.value),height_m:g((d=c.querySelector('input[name="height_m"]'))==null?void 0:d.value),style:((p=c.querySelector('select[name="set_style"]'))==null?void 0:p.value)||"",fabric_variant:((f=c.querySelector('select[name="fabric_variant"]'))==null?void 0:f.value)||"",price_per_m_raw:g((h=c.querySelector('select[name="set_price_per_m"]'))==null?void 0:h.value),sheer_price_per_m:g((_=c.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:_.value),fabric_code:((w=c.querySelector('input[name="fabric_code"]'))==null?void 0:w.value)||"",sheer_fabric_code:((q=c.querySelector('input[name="sheer_fabric_code"]'))==null?void 0:q.value)||"",opening_style:((y=c.querySelector('select[name="opening_style"]'))==null?void 0:y.value)||"",track_color:((T=c.querySelector('select[name="track_color"]'))==null?void 0:T.value)||"",notes:((S=c.querySelector('input[name="notes"]'))==null?void 0:S.value)||"",is_suspended:c.classList.contains("is-suspended")})}),a.querySelectorAll(m.decoItem).forEach(c=>{var i,d,p,f,h,_;l.decorations.push({type:((i=c.querySelector('[name="deco_type"]'))==null?void 0:i.value)||"",width_m:g((d=c.querySelector('[name="deco_width_m"]'))==null?void 0:d.value),height_m:g((p=c.querySelector('[name="deco_height_m"]'))==null?void 0:p.value),price_sqyd:g((f=c.querySelector('[name="deco_price_sqyd"]'))==null?void 0:f.value),deco_code:((h=c.querySelector('[name="deco_code"]'))==null?void 0:h.value)||"",notes:((_=c.querySelector('[name="deco_notes"]'))==null?void 0:_.value)||"",is_suspended:c.classList.contains("is-suspended")})}),a.querySelectorAll(m.wallpaperItem).forEach(c=>{var i,d,p,f,h;l.wallpapers.push({height_m:g((i=c.querySelector('[name="wallpaper_height_m"]'))==null?void 0:i.value),wallpaper_code:((d=c.querySelector('[name="wallpaper_code"]'))==null?void 0:d.value)||"",price_per_roll:g((p=c.querySelector('[name="wallpaper_price_roll"]'))==null?void 0:p.value),install_cost_per_roll:g((f=c.querySelector('[name="wallpaper_install_cost"]'))==null?void 0:f.value),notes:((h=c.querySelector('[name="wallpaper_notes"]'))==null?void 0:h.value)||"",widths:Array.from(c.querySelectorAll('[name="wall_width_m"]')).map(_=>g(_.value)),is_suspended:c.classList.contains("is-suspended")})}),e.rooms.push(l)}),e}function A(){localStorage.setItem(le,JSON.stringify(V()))}const x={stylePlus:t=>de.style_surcharge[t]??0,heightPlus:t=>{const e=[...de.height].sort((o,r)=>r.threshold-o.threshold);for(const o of e)if(t>o.threshold)return o.add_per_m;return 0},fabricYardage:(t,e)=>{const o=g(e);return o<=0||!t?0:t==="‡∏ï‡∏≤‡πÑ‡∏Å‡πà"||t==="‡∏à‡∏µ‡∏ö"?(o*2+.6)/.9:t==="‡∏•‡∏≠‡∏ô"?(o*2.6+.6)/.9:0},wallpaperRolls:(t,e)=>{const o=g(t),r=g(e);if(o<=0||r<=0)return 0;const n=r>2.5?Math.floor(pe.ROLL_LENGTH_M/r):pe.STRIPS_PER_ROLL_UNDER_2_5M;if(n<=0)return 0;const s=Math.ceil(o/pe.ROLL_WIDTH_M);return Math.ceil(s/n)},calculateSetPrice:function(t){var a,l;if(!t||t.is_suspended||g(t.width_m)<=0)return{total:0,opaque:0,sheer:0};const e=this.stylePlus(t.style),o=this.heightPlus(g(t.height_m)),r=g(t.width_m),n=(a=t.fabric_variant)!=null&&a.includes("‡∏ó‡∏∂‡∏ö")&&g(t.price_per_m_raw)>0?(g(t.price_per_m_raw)+e+o)*r:0,s=(l=t.fabric_variant)!=null&&l.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&g(t.sheer_price_per_m)>0?(g(t.sheer_price_per_m)+e+o)*r:0;return{total:Math.round(n+s),opaque:Math.round(n),sheer:Math.round(s)}},calculateDecoPrice:function(t){if(!t||t.is_suspended||g(t.width_m)<=0)return{total:0,sqm:0,sqyd:0};const e=g(t.width_m)*g(t.height_m),o=e*Ae,r=o*g(t.price_sqyd);return{total:Math.round(r),sqm:e,sqyd:o}},calculateWallpaperPrice:function(t){var a;if(!t||t.is_suspended)return{total:0,material:0,install:0,rolls:0,sqm:0};const e=((a=t.widths)==null?void 0:a.reduce((l,u)=>l+g(u),0))||0;if(e<=0)return{total:0,material:0,install:0,rolls:0,sqm:0};const o=g(t.height_m),r=this.wallpaperRolls(e,o),n=r*g(t.price_per_roll),s=r*g(t.install_cost_per_roll??300);return{total:Math.round(n+s),material:Math.round(n),install:Math.round(s),rolls:r,sqm:e*o}}};function je(t){return t.rooms.reduce((e,o)=>{if(o.is_suspended)return e;const r=o.sets.reduce((a,l)=>a+x.calculateSetPrice(l).total,0),n=o.decorations.reduce((a,l)=>a+x.calculateDecoPrice(l).total,0),s=o.wallpapers.reduce((a,l)=>a+x.calculateWallpaperPrice(l).total,0);return e+r+n+s},0)}function Ve(t,e){const o=je(t);let r=`‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${new Date().toLocaleDateString("th-TH",{day:"numeric",month:"numeric",year:"numeric"})})
`;if(r+=`‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${t.customer_name||"-"}
`,(e==="customer"||e==="owner")&&(r+=`‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${t.customer_phone||"-"}
`,r+=`‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${t.customer_address||"-"}
`),r+=`------------------------------
`,e==="customer")return r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
`,t.rooms.forEach(n=>{if(n.is_suspended||[...n.sets,...n.decorations,...n.wallpapers].filter(l=>l.is_suspended?!1:l.widths?l.widths.reduce((u,c)=>u+c,0)>0:l.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let a=0;n.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(a++,r+=` ${a}) ‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} (${l.fabric_variant})
`)}),n.decorations.forEach(l=>{l.is_suspended||l.width_m<=0||(a++,r+=` ${a}) ${l.type||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}
`)}),n.wallpapers.forEach(l=>{l.is_suspended||l.widths.reduce((u,c)=>u+c,0)<=0||(a++,r+=` ${a}) ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå
`)})}),r+=`------------------------------
`,r+=`
‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${I(o)} ‡∏ö‡∏≤‡∏ó
`,r+=`
‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
${C.name}
‡πÇ‡∏ó‡∏£: ${C.phone}`,r;if(e==="purchase_order"||e==="owner"){const n={opaqueFabrics:[],sheerFabrics:[],decorations:[],wallpapers:[],allSets:[]};if(t.rooms.forEach(s=>{s.is_suspended||(s.sets.forEach(a=>{a.is_suspended||a.width_m<=0||(n.allSets.push(a),a.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&n.opaqueFabrics.push({code:a.fabric_code||"??",yards:x.fabricYardage(a.style,a.width_m)}),a.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&n.sheerFabrics.push({code:a.sheer_fabric_code||"??",yards:x.fabricYardage(a.style,a.width_m)}))}),s.decorations.forEach(a=>{a.is_suspended||!a.type||a.width_m<=0||n.decorations.push({type:a.type,code:a.deco_code||"xxx",width:a.width_m,height:a.height_m})}),s.wallpapers.forEach(a=>{if(a.is_suspended)return;const l=a.widths.reduce((u,c)=>u+c,0);if(l>0){const u=x.wallpaperRolls(l,a.height_m);u>0&&n.wallpapers.push({code:a.wallpaper_code||"xxx",rolls:u})}}))}),r+=`üìã *‡∏™‡∏£‡∏∏‡∏õ‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤*
`,r+=`------------------------------
`,n.opaqueFabrics.length>0&&n.opaqueFabrics.forEach(s=>{r+=`- ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö (Curtain Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),n.sheerFabrics.length>0&&n.sheerFabrics.forEach(s=>{r+=`- ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á (Sheer Fabric)
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"??"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.yards.toFixed(2)} ‡∏´‡∏•‡∏≤

`}),r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏£‡∏≤‡∏á*
`,r+=`------------------------------

`,n.allSets.length>0){let s=1;n.allSets.forEach(a=>{r+=`(${s++}) ‡∏£‡∏≤‡∏á‡∏°‡πà‡∏≤‡∏ô: ${a.style}, ‡∏™‡∏µ: ${a.track_color}
`,a.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  - ‡∏£‡∏≤‡∏á‡∏ó‡∏∂‡∏ö: ${a.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),a.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  - ‡∏£‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á: ${a.width_m.toFixed(2)} ‡∏°. (1 ‡πÄ‡∏™‡πâ‡∏ô)
`),a.fabric_variant==="‡∏ó‡∏∂‡∏ö&‡πÇ‡∏õ‡∏£‡πà‡∏á"&&(r+=`  (‚ùóÔ∏è‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡∏≤‡∏™‡∏≠‡∏á‡∏ä‡∏±‡πâ‡∏ô)
`),r+=`
`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Blind*
`,r+=`------------------------------

`,n.decorations.length>0){const s={‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡πÑ‡∏°‡πâ:"Wooden Blind",‡∏°‡πà‡∏≤‡∏ô‡∏°‡πâ‡∏ß‡∏ô:"Roller Blind",‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á:"Vertical Blind",‡∏â‡∏≤‡∏Å‡∏Å‡∏±‡πâ‡∏ô‡∏´‡πâ‡∏≠‡∏á:"Partition",‡∏°‡∏∏‡πâ‡∏á‡∏à‡∏µ‡∏ö:"Pleated Insect Screen",‡∏°‡∏π‡πà‡∏•‡∏µ‡πà‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°:"Aluminium Blind"};n.decorations.forEach(a=>{const l=s[a.type]?` (${s[a.type]})`:"";r+=`- ${a.type}${l}
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${a.code||"xxx"}
`,r+=`‡∏Ç‡∏ô‡∏≤‡∏î: ${a.width.toFixed(2)} x ${a.height.toFixed(2)} m.
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: 1 ‡∏ä‡∏∏‡∏î

`})}if(r+=`------------------------------
`,r+=`üìã *‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ Wallpaper*
`,r+=`------------------------------

`,n.wallpapers.length>0&&n.wallpapers.forEach(s=>{r+=`- ‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå -
`,r+=`‡∏£‡∏´‡∏±‡∏™: #${s.code||"xxx"}
`,r+=`‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.rolls} ‡∏°‡πâ‡∏ß‡∏ô

`}),r+=`------------------------------
`,e==="purchase_order")return r}return(e==="seamstress"||e==="owner")&&(r+=`
üßµ *‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≤‡∏á*
`,t.rooms.forEach(n=>{if(n.is_suspended||n.sets.filter(l=>!l.is_suspended&&l.width_m>0).length===0)return;r+=`
*‡∏´‡πâ‡∏≠‡∏á: ${n.room_name||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏"}*
`;let a=1;n.sets.forEach(l=>{l.is_suspended||l.width_m<=0||(r+=`${a++}) *‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${l.style} ${l.fabric_variant}*
`,r+=`  ‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${l.width_m} x ‡∏™‡∏π‡∏á ${l.height_m} ‡∏°.
`,r+=`  ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏õ‡∏¥‡∏î: ${l.opening_style}
`,l.fabric_variant.includes("‡∏ó‡∏∂‡∏ö")&&(r+=`  ‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö: ‡∏£‡∏´‡∏±‡∏™ ${l.fabric_code||"-"}
`),l.fabric_variant.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á")&&(r+=`  ‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á: ‡∏£‡∏´‡∏±‡∏™ ${l.sheer_fabric_code||"-"}
`))})}),r+=`------------------------------
`,e==="seamstress")||e==="owner"&&(r+=`
üí∞ *‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: ${I(o)} ‡∏ö‡∏≤‡∏ó*
`),r}function Ye(t){if(!t.rooms||t.rooms.length===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';const e={};let o=0,r="";if(t.rooms.forEach(a=>{if(a.is_suspended)return;const l={};a.sets.forEach(c=>{if(x.calculateSetPrice(c).total>0){const i="‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô";l[i]=(l[i]||0)+1,e[i]=(e[i]||0)+1}}),a.decorations.forEach(c=>{if(c.type&&x.calculateDecoPrice(c).total>0){const i=c.type;l[i]=(l[i]||0)+1,e[i]=(e[i]||0)+1}}),a.wallpapers.forEach(c=>{if(x.calculateWallpaperPrice(c).total>0){const i="‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå";l[i]=(l[i]||0)+1,e[i]=(e[i]||0)+1}});const u=Object.entries(l);u.length>0&&(r+=`<tr class="room-header-row"><td colspan="3">${L(a.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á"}</td></tr>`,u.forEach(([c,i])=>{r+=`<tr><td></td><td class="item-type-cell">${L(c)}</td><td class="pdf-text-center">${i}</td></tr>`,o+=i}))}),o===0)return'<p class="empty-summary">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</p>';let s=`<div id="detailed-material-summary">
        <h4><i class="ph ph-stack"></i> ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
        <ul><li class="summary-note">${Object.entries(e).map(([a,l])=>`${L(a)}: ${l}`).join(" , ")}</li></ul>
    </div>`;return s+=`<table>
        <thead><tr><th>‡∏´‡πâ‡∏≠‡∏á</th><th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th class="pdf-text-center">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th></tr></thead>
        <tbody>${r}</tbody>
    </table>`,s}function Ge(t,e){const{vatRate:o,pageBreakBuffer:r=3}=e,n=[];t.rooms.forEach($=>{if($.is_suspended)return;const k=[];$.sets.forEach(b=>{const B=x.calculateSetPrice(b).total;if(B>0){let M=`‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô ${L(b.style)} (${L(b.fabric_variant)}) <br><small>‡∏Ç‡∏ô‡∏≤‡∏î ${b.width_m.toFixed(2)} x ${b.height_m.toFixed(2)} ‡∏°.${b.notes?` - ${L(b.notes)}`:""}</small>`;k.push({description:M,total:B,units:M.includes("<br>")?1.5:1})}}),$.decorations.forEach(b=>{const B=x.calculateDecoPrice(b).total;if(B>0){let M=`${L(b.type)||"‡∏á‡∏≤‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"} <br><small>‡∏£‡∏´‡∏±‡∏™: ${L(b.deco_code)||"-"}, ‡∏Ç‡∏ô‡∏≤‡∏î ${b.width_m.toFixed(2)} x ${b.height_m.toFixed(2)} ‡∏°.</small>`;k.push({description:M,total:B,units:M.includes("<br>")?1.5:1})}}),$.wallpapers.forEach(b=>{const B=x.calculateWallpaperPrice(b).total;if(B>0){const M=b.widths.reduce((ae,se)=>ae+se,0),j=x.wallpaperRolls(M,b.height_m);let W=`‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå <br><small>‡∏£‡∏´‡∏±‡∏™: ${L(b.wallpaper_code)||"-"}, ‡∏™‡∏π‡∏á ${b.height_m.toFixed(2)} ‡∏°. (‡πÉ‡∏ä‡πâ ${j} ‡∏°‡πâ‡∏ß‡∏ô)</small>`;k.push({description:W,total:B,units:W.includes("<br>")?1.5:1})}}),k.length>0&&(n.push({isRoomHeader:!0,roomName:L($.room_name)||"‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á",units:1.2}),n.push(...k))});const s=n.reduce(($,k)=>$+(k.total||0),0);if(s===0)return null;const a=s*o,l=s+a,u=17,c=23,i=[];let d=[],p=0;n.forEach(($,k)=>{const b=i.length===0?u:c,B=p+$.units>b;let M=!1;if(!B&&k<n.length-1){const j=b-(p+$.units);j>0&&j<r&&(M=!0)}(B||M)&&d.length>0&&(i.push(d),d=[],p=0),d.push($),p+=$.units}),d.length>0&&i.push(d);const f=new Date,h=f.toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}),_=`QT-${f.getFullYear()}${(f.getMonth()+1).toString().padStart(2,"0")}${f.getDate().toString().padStart(2,"0")}`;let w="",q=0,y=1;i.forEach(($,k)=>{const b=k===0,B=k===i.length-1,M=`
            <div class="pdf-page-header">
                <div class="pdf-header">
                    <div class="pdf-shop-info">
                        ${`<img src="${C.logoUrl}" alt="Logo" class="pdf-logo">`}
                        <div class="pdf-shop-address">
                            <strong>${L(C.name)}</strong><br>
                            ${L(C.address).replace(/\n/g,"<br>")}<br>
                            ‡πÇ‡∏ó‡∏£: ${L(C.phone)} | ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ: ${L(C.taxId)}
                        </div>
                    </div>
                    <div class="pdf-quote-details">
                        <div class="pdf-title-box"><h1>‡πÉ‡∏ö‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤ ${i.length>1?b?"":"(‡∏ï‡πà‡∏≠)":""}</h1></div>
                        <table class="pdf-quote-meta">
                            <tr><td>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:</td><td>${_}</td></tr>
                            <tr><td>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</td><td>${h}</td></tr>
                        </table>
                    </div>
                </div>
                ${b?`
                <section class="pdf-customer-details">
                    <div class="pdf-customer-info">
                        <strong>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong> ${L(t.customer_name)||""}<br>
                        <strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${L(t.customer_address).replace(/\n/g,"<br>")||""}<br>
                        <strong>‡πÇ‡∏ó‡∏£:</strong> ${L(t.customer_phone)||""}
                    </div>
                    <div class="pdf-customer-meta">
                        <strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô:</strong> ${L(C.pdf.paymentTerms)}<br>
                        <strong>‡∏¢‡∏∑‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤:</strong> ${L(C.pdf.priceValidity)}
                    </div>
                </section>`:""}
            </div>`,j=`
            <div class="pdf-page-footer">
                <div class="pdf-footer-info">
                    <span>${L(C.name)} | ‡πÇ‡∏ó‡∏£: ${L(C.phone)}</span>
                    <span>‡∏´‡∏ô‡πâ‡∏≤ ${k+1} / ${i.length}</span>
                </div>
            </div>`;let W="";b||(W+=`<tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡∏°‡∏≤ (Brought Forward)</td><td class="pdf-text-right">${N(q,2,!0)}</td></tr>`),$.forEach(O=>{O.isRoomHeader?W+=`<tr class="pdf-room-header"><td colspan="5">‡∏´‡πâ‡∏≠‡∏á: ${O.roomName}</td></tr>`:(W+=`<tr><td class="pdf-text-center">${y++}</td><td>${O.description}</td><td class="pdf-text-center">1</td><td class="pdf-text-right">${N(O.total,2,!0)}</td><td class="pdf-text-right">${N(O.total,2,!0)}</td></tr>`,q+=O.total)});let ae="";B||(ae=`<tfoot><tr class="pdf-subtotal-row"><td colspan="4">‡∏¢‡∏≠‡∏î‡∏¢‡∏Å‡πÑ‡∏õ (Carried Forward)</td><td class="pdf-text-right">${N(q,2,!0)}</td></tr></tfoot>`);let se="";C.pdf.notes&&C.pdf.notes.length>0&&(se=`
                <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong>
                <ul>${C.pdf.notes.map(O=>`<li>${L(O)}</li>`).join("")}</ul>
            `);const ke=B?`
            <div class="pdf-summary-wrapper">
                <section class="pdf-summary-section">
                    <div class="pdf-amount-in-words">
                        ${se}
                        <div class="pdf-amount-text">( ${Fe(l)} )</div>
                    </div>
                    <div class="pdf-totals-block">
                        <table>
                            <tr><td class="pdf-label">‡∏£‡∏ß‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</td><td class="pdf-amount">${N(s,2,!0)}</td></tr>
                            ${o>0?`<tr><td class="pdf-label">‡∏†‡∏≤‡∏©‡∏µ‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° ${(o*100).toFixed(0)}%</td><td class="pdf-amount">${N(a,2,!0)}</td></tr>`:""}
                            <tr class="pdf-grand-total"><td class="pdf-label">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</td><td class="pdf-amount">${N(l,2,!0)}</td></tr>
                        </table>
                    </div>
                </section>
                <footer class="pdf-footer-section">
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ô‡∏≠‡∏£‡∏≤‡∏Ñ‡∏≤</p><p>(${L(C.name)})</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${h}</p></div>
                    <div class="pdf-signature-box"><p>.................................................</p><p>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏•‡∏á‡∏ô‡∏≤‡∏°</p><p>&nbsp;</p><p>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ......./......./............</p></div>
                </footer>
            </div>
        `:"";w+=`
            <div class="pdf-page">
                <div class="pdf-page-content">
                    ${M}
                    <div class="pdf-page-body">
                        <table class="pdf-items-table">
                            <thead><tr><th style="width:5%;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th><th style="width:50%;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th style="width:10%;">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th style="width:17.5%;">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th><th style="width:17.5%;">‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
                            <tbody>${W}</tbody>
                            ${ae}
                        </table>
                        ${ke}
                    </div>
                    ${j}
                </div>
            </div>`});const T=t.customer_name||"quote",S=we(T);return{html:`<div id="quotation-template">${w}</div>`,fileName:`${_}_${S}`}}let P=!1,X=null,ce=null,K=!1,E=null,J=null,fe=null;const he="marnthara.theme";function Le(){const t=localStorage.getItem(he),e=document.querySelector("#themeToggleBtn");if(!e)return;const o=e.querySelector("i"),r=e.querySelector("span");switch(document.body.classList.remove("dark-theme","neutral-theme"),t){case"dark":document.body.classList.add("dark-theme"),o&&(o.className="ph-fill ph-sun"),r&&(r.textContent=" ‡∏™‡∏ß‡πà‡∏≤‡∏á");break;case"neutral":document.body.classList.add("neutral-theme"),o&&(o.className="ph-fill ph-palette"),r&&(r.textContent=" ‡∏°‡∏∑‡∏î");break;default:o&&(o.className="ph-fill ph-moon"),r&&(r.textContent=" ‡∏Å‡∏•‡∏≤‡∏á");break}}function Je(){const t=localStorage.getItem(he);let e;!t||t==="light"?e="neutral":t==="neutral"?e="dark":e="light",localStorage.setItem(he,e),Le()}function v(t,e="default"){const o=document.querySelector(m.toastContainer);if(!o)return;const r={success:"ph-bold ph-check-circle",warning:"ph-bold ph-warning",error:"ph-bold ph-x-circle",default:"ph-bold ph-info"},n=document.createElement("div");n.className=`toast toast-${e}`,n.innerHTML=`<i class="${r[e]||r.default}"></i> ${t}`,o.appendChild(n),setTimeout(()=>n.classList.add("show"),10),setTimeout(()=>{n.classList.remove("show"),n.addEventListener("transitionend",()=>n.remove())},3e3)}function D(t,e){return new Promise(o=>{const r=document.querySelector(t);if(!r){o(null);return}const n=document.querySelector(".modal-wrapper.visible");n&&n.classList.add("is-underlay"),r.classList.add("visible");const s=r.querySelector('[id$="Confirm"]'),a=r.querySelector('[id$="Cancel"], [data-act="close-modal"]'),l=Array.from(r.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter(p=>!p.disabled&&p.offsetParent!==null),u=l[0],c=l[l.length-1];setTimeout(()=>u==null?void 0:u.focus(),50);const i=p=>{if(p.key==="Escape"&&!r.classList.contains("is-underlay")){d({cancelled:!0});return}if(p.key==="Tab"){if(l.length<=1){p.preventDefault();return}p.shiftKey?document.activeElement===u&&(c.focus(),p.preventDefault()):document.activeElement===c&&(u.focus(),p.preventDefault())}},d=p=>{r.classList.remove("visible"),document.removeEventListener("keydown",i),s&&(s.onclick=null),a&&(a.onclick=null),n&&n.classList.remove("is-underlay"),typeof p=="object"&&p.cancelled&&e&&e(),o(p)};s&&(s.onclick=()=>d(!0)),a&&(a.onclick=()=>{r.classList.contains("is-underlay")||d({cancelled:!0})}),document.addEventListener("keydown",i)})}async function z(t,e){const o=document.querySelector(m.modal);if(!o)return!0;const r=o.querySelector(m.modalTitle),n=o.querySelector(m.modalBody);return r&&(r.textContent=t),n&&(n.textContent=e),await D(m.modal)===!0}async function Qe(){const t=document.querySelector(m.exportOptionsModal);if(!t)return null;const e=await D(m.exportOptionsModal);if(!e||e.cancelled)return null;const o=t.querySelector('input[name="vat_option"]:checked'),r=t.querySelector("#exportMethod"),n=t.querySelector("#pageBreakBuffer");return{vatOption:o?o.value:"include",exportMethod:r?r.value:"direct",pageBreakBuffer:n?parseInt(n.value,10):3}}function Q(t,e){t&&(t.classList.add("item-removing"),t.addEventListener("animationend",()=>{t.remove(),e&&v(e),me(),re(),R(),A(),G()},{once:!0}))}function re(){document.querySelectorAll(m.room).forEach(t=>{const e=t.querySelectorAll(".item-card:not(.is-suspended)"),o=e.length;e.forEach((r,n)=>{const s=r.querySelector("[data-item-title]");s&&(s.textContent=`${n+1}/${o}`)})})}function Te(){const t=document.querySelector(m.orderForm),e=document.querySelector(m.lockBtn);if(!t||!e)return;const o=t.querySelectorAll("input, select, textarea, button");t.classList.toggle("is-locked",P),e.classList.toggle("is-locked",P);const r=e.querySelector("i");r&&(r.className=P?"ph-bold ph-lock-key":"ph-bold ph-lock-key-open"),o.forEach(n=>{n.closest(".summary-footer")||n.closest(".main-header")||n.closest(".modal-wrapper")||(n.disabled=P)}),v(P?"‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ":"‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Ñ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß",P?"warning":"success")}function Y(){const t=document.querySelectorAll(m.room);if(t.length===0)return;const e=[...t].some(r=>r.open),o=document.querySelector(m.toggleAllRoomsBtn);if(o){const r=o.querySelector("i"),n=o.querySelector("span");r&&(r.className=e?"ph ph-rows-slash":"ph ph-rows"),n&&(n.textContent=e?"‡∏¢‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î":"‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")}}function Ke(){const t=document.querySelectorAll(m.room),e=[...t].some(o=>o.open);t.forEach(o=>{o.open=!e}),setTimeout(()=>{Y(),A()},50)}function me(){const t=document.querySelector(m.quickNavRoomList);if(!t)return;t.innerHTML="",document.querySelectorAll(m.room).forEach(o=>{const r=o.querySelector(m.roomNameInput),n=r?r.value:"‡∏´‡πâ‡∏≠‡∏á",s=document.createElement("a");s.href=`#${o.id}`,s.dataset.jumpTo=o.id,s.innerHTML=`<i class="ph ph-arrow-bend-left-up"></i> ${n||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)"}`,t.appendChild(s)})}function $e(t){const e=document.getElementById("quickNavBtnText");if(e)if(t){const o=t.querySelector('input[name="room_name"]');o&&(e.textContent=o.value||"...")}else e.textContent="‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏´‡πâ‡∏≠‡∏á"}function G(){if(ce&&ce.disconnect(),!document.getElementById("quickNavBtnText"))return;const e={root:null,rootMargin:"-60px 0px -150px 0px",threshold:0},o=n=>{const s=n.filter(a=>a.isIntersecting).sort((a,l)=>a.target.getBoundingClientRect().top-l.target.getBoundingClientRect().top);s.length>0&&$e(s[0].target)};ce=new IntersectionObserver(o,e),document.querySelectorAll(m.room).forEach(n=>ce.observe(n))}function xe(){document.querySelectorAll("[data-favorite-type]").forEach(F)}function ye(){const t=document.querySelector('[data-act="edit-selected-fav"]'),e=document.querySelector('[data-act="del-selected-fav"]');if(t&&e){const o=E!==null;t.disabled=!o,e.disabled=!o}}function ie(t,e=null){const o=document.getElementById("favManagerBody");if(!o)return;const r=H();let n=[];if(t==="deco"?n=r.deco[e]||[]:n=r[t]||[],o.innerHTML="",n.length===0)o.innerHTML='<p class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ</p>';else{const s=document.getElementById("favManagerItemTpl").innerHTML;n.forEach(a=>{const l=s.replace(/{CODE}/g,a.code).replace(/{PRICE}/g,I(a.price)).replace(/{RAW_PRICE}/g,a.price),u=document.createElement("div");u.innerHTML=l;const c=u.firstElementChild;c.dataset.type=t,e&&(c.dataset.subType=e),o.appendChild(c)})}E=null,ye()}async function ze(t,e=null){K=!1,E=null;const o=document.getElementById("favManagerTitle");if(!o)return;let r="‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î";t==="deco"?r=`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î: ${e||"‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á"}`:r=`‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î: ${{fabric:"‡∏ú‡πâ‡∏≤‡∏ó‡∏∂‡∏ö",sheer:"‡∏ú‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πà‡∏á",wallpaper:"‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå"}[t]||t}`,o.textContent=r,o.dataset.type=t,o.dataset.subType=e||"",ie(t,e),await D("#favManagerModal"),K&&(xe(),X&&Ie(X))}async function Xe(){const t=document.querySelector("#favAddModal");if(!t)return null;const e=t.querySelector("#fav_code_add"),o=t.querySelector("#fav_price_add");e.value="",o.value="";const r=await D("#favAddModal");return r&&!r.cancelled?{newCode:e.value.trim(),newPrice:g(o.value)}:null}async function Ze(t){const e=document.querySelector("#favEditModal");if(!e)return null;const o=e.querySelector("#fav_code_edit"),r=e.querySelector("#fav_price_edit");o.value=t.code,r.value=t.price;const n=await D("#favEditModal");return n&&!n.cancelled?{newCode:o.value.trim(),newPrice:g(r.value)}:null}function Z(){document.querySelectorAll(".favorite-chips-container.show").forEach(t=>{t.classList.remove("show")}),document.querySelectorAll(".item-card.overflow-visible").forEach(t=>{t.classList.remove("overflow-visible")}),X=null}function F(t){var i;if(!t||!t.matches("[data-favorite-type]"))return;const e=t.nextElementSibling;if(!e||!e.matches(".btn-favorite"))return;const o=e.dataset.type,r=t.value;if(!r){e.classList.remove("is-favorite"),e.querySelector("i").className="ph ph-star";return}const n=t.closest(".item-card");if(!n)return;let s=null;o==="deco"&&(s=(i=n.querySelector('[name="deco_type"]'))==null?void 0:i.value);let a,l;o==="fabric"&&(a=n.querySelector('[name="set_price_per_m"]')),o==="sheer"&&(a=n.querySelector('[name="sheer_price_per_m"]')),o==="deco"&&(a=n.querySelector('[name="deco_price_sqyd"]')),o==="wallpaper"&&(a=n.querySelector('[name="wallpaper_price_roll"]')),l=g(a==null?void 0:a.value);const u=be(o,r,s),c=u&&u.price===l;e.classList.toggle("is-favorite",c),e.querySelector("i").className=c?"ph-fill ph-star":"ph ph-star"}function Ie(t){var u,c;Z();const e=t.dataset.favoriteType;if(!e)return;let o=null,r=[];const n=H();e==="deco"?(o=(c=(u=t.closest(".item-card"))==null?void 0:u.querySelector('[name="deco_type"]'))==null?void 0:c.value,o&&(r=n.deco[o]||[])):r=n[e]||[];const s=t.closest(".form-group-with-favorites").querySelector(".favorite-chips-container");if(!s)return;s.innerHTML="",r.length>0&&r.forEach(i=>{const d=document.createElement("button");d.type="button",d.className="btn-chip",d.textContent=i.code,d.dataset.act="select-favorite",d.dataset.code=i.code,d.dataset.price=i.price,s.appendChild(d)});const a=document.createElement("button");a.type="button",a.className="btn-manage-favorites",a.dataset.act="manage-favorites",a.dataset.type=e,o&&(a.dataset.subType=o),a.innerHTML='<i class="ph ph-pencil-simple"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç',s.appendChild(a),s.classList.add("show");const l=t.closest(".item-card");l&&l.classList.add("overflow-visible")}async function ge(t,e=null){const o=document.querySelector("#itemTypeModal");if(!o)return null;o.querySelector("#itemTypeModalTitle").textContent=t;const r=o.querySelector(`input[name="item_type_option"][value="${e||"set"}"]`);r&&(r.checked=!0);const n=await D("#itemTypeModal");if(!n||n.cancelled)return null;const s=o.querySelector('input[name="item_type_option"]:checked');return s?s.value:null}function et(t,e){const o=t.closest(m.room);if(!o)return;const r=Array.from(o.querySelectorAll(".item-card")),n=r.findIndex(f=>f===t);let s=0;if(n>-1)for(let f=0;f<n;f++){const h=r[f];(e==="set"&&h.matches(m.set)||e==="deco"&&h.matches(m.decoItem)||e==="wallpaper"&&h.matches(m.wallpaperItem))&&s++}const a={set:o.querySelector(m.setsContainer),deco:o.querySelector(m.decorationsContainer),wallpaper:o.querySelector(m.wallpapersContainer)},l={set:"#setTpl",deco:"#decoTpl",wallpaper:"#wallpaperTpl"},u=a[e],c=l[e];if(!u||!c)return;const p=document.querySelector(c).content.cloneNode(!0).firstElementChild;if(e==="wallpaper"){const f=p.querySelector('[data-act="add-wall"]');f&&ve(f)}t.classList.add("item-removing"),t.addEventListener("animationend",()=>{t.remove();const f=u.children[s]||null;u.insertBefore(p,f),p.classList.add("item-created"),p.scrollIntoView({behavior:"smooth",block:"center"});const h=p.querySelector('input:not([type="hidden"]), select, textarea');h&&h.focus(),re(),R(),A(),v("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success")},{once:!0})}function oe(t,e,o=!0){Z();const r=document.querySelector(t);if(!r||!e)return null;const n=r.content.cloneNode(!0),s=n.firstElementChild;e.appendChild(n),s.querySelectorAll("input[data-favorite-type]").forEach(F),o&&s&&(s.classList.add("item-created"),s.scrollIntoView({behavior:"smooth",block:"center"}));const a=s.querySelector('input:not([type="hidden"]), select, textarea');return a&&a.focus(),re(),R(),A(),s}function ue(){const t=document.querySelector(m.roomsContainer);if(!t)return;const e=document.querySelectorAll(m.roomNameInput);let o=0;e.forEach(s=>{const a=s.value.match(/\d+/g);if(a){const l=parseInt(a[a.length-1],10);l>o&&(o=l)}});const r=o+1,n=oe("#roomTpl",t,!0);if(n){n.id=`room-${Date.now()}`;const s=n.querySelector(m.roomNameInput);s&&(s.value=`‡∏´‡πâ‡∏≠‡∏á ${r}`),n.open=!0}me(),Y(),G()}function tt(t){if(!t)return;const e=t.querySelector(m.setsContainer);e&&oe("#setTpl",e)}function rt(t){if(!t)return;const e=t.querySelector(m.decorationsContainer);e&&oe("#decoTpl",e)}function ot(t){if(!t)return;const e=t.querySelector(m.wallpapersContainer);if(e){const o=oe("#wallpaperTpl",e);o&&ve(o.querySelector('[data-act="add-wall"]'))}}function ve(t){var o;const e=(o=t==null?void 0:t.closest(".walls-section"))==null?void 0:o.querySelector(m.wallsContainer);e&&(oe("#wallTpl",e,!0),ne(t))}function Ce(t){var n,s;if(!t)return;const e=(n=t.querySelector('select[name="fabric_variant"]'))==null?void 0:n.value,o=e&&e.includes("‡πÇ‡∏õ‡∏£‡πà‡∏á");(s=t.querySelector(m.sheerWrap))==null||s.classList.toggle("hidden",!o);const r=t.querySelector('input[name="sheer_fabric_code"]');if(r){const a=r.closest(".form-group-with-favorites");a&&a.classList.toggle("hidden",!o)}}function nt(t,e,o,r=null){let n=0;document.querySelectorAll(`
        [name="fabric_code"], 
        [name="sheer_fabric_code"], 
        [name="deco_code"], 
        [name="wallpaper_code"]
    `).forEach(a=>{var l;if(a.value.trim()===t){const u=a.closest(".item-card");if(!u)return;const c=a.dataset.favoriteType;let i=null;if(c===o){if(o==="deco"&&((l=u.querySelector('[name="deco_type"]'))==null?void 0:l.value)!==r)return;o==="fabric"&&(i=u.querySelector('[name="set_price_per_m"]')),o==="sheer"&&(i=u.querySelector('[name="sheer_price_per_m"]')),o==="deco"&&(i=u.querySelector('[name="deco_price_sqyd"]')),o==="wallpaper"&&(i=u.querySelector('[name="wallpaper_price_roll"]')),a.value=e.newCode,i&&(i.tagName==="SELECT"?i.value=e.newPrice:i.value=I(g(e.newPrice)),a.classList.add("input-highlight"),i.classList.add("input-highlight"),setTimeout(()=>{a.classList.remove("input-highlight"),i.classList.remove("input-highlight")},1500),i.dispatchEvent(new Event("change",{bubbles:!0}))),n++}}}),n>0&&v(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï ${n} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß`,"success")}function at(t,e,o=null){document.querySelectorAll(`input[data-favorite-type="${e}"]`).forEach(r=>{var n;if(r.value.trim()===t)if(e==="deco"){const s=r.closest(".item-card");((n=s==null?void 0:s.querySelector('[name="deco_type"]'))==null?void 0:n.value)===o&&F(r)}else F(r)})}const st=Pe(t=>{ne(t),A()});function ct(t){if(P){v("‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Ñ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ","warning"),t.preventDefault();return}t.target.matches("input[data-favorite-type]")&&F(t.target),t.target.matches(m.roomNameInput)&&G(),st(t.target)}function lt(t){if(P)return;const e=t.target;if(["set_price_per_m","sheer_price_per_m","deco_price_sqyd","wallpaper_price_roll"].includes(e.name)){const r=e.closest(".item-card");if(r){let n;e.name==="set_price_per_m"&&(n=r.querySelector('[name="fabric_code"]')),e.name==="sheer_price_per_m"&&(n=r.querySelector('[name="sheer_fabric_code"]')),e.name==="deco_price_sqyd"&&(n=r.querySelector('[name="deco_code"]')),e.name==="wallpaper_price_roll"&&(n=r.querySelector('[name="wallpaper_code"]')),n&&F(n)}}if(e.matches('select[name="fabric_variant"]')&&Ce(e.closest(m.set)),e.matches('select[name="deco_type"]')){const r=e.closest(m.decoItem);if(r){const n=r.querySelector(".item-type-changer .deco-type-display");n&&(n.textContent=e.value||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á");const s=r.querySelector('input[name="deco_code"]');s&&(s.value="",F(s));const a=r.querySelector('input[name="deco_price_sqyd"]');a&&(a.value="")}}e.matches(m.roomNameInput)&&(me(),G()),ne(e),A()}function it(t){const e=t.target,o=e.matches('[name="deco_price_sqyd"], [name="wallpaper_price_roll"], [name="wallpaper_install_cost"], [name="fav_price_edit"], [name="fav_price_add"]'),r=e.matches('input[name="width_m"], input[name="height_m"], input[name="deco_width_m"], input[name="deco_height_m"], input[name="wallpaper_height_m"], input[name="wall_width_m"]');if(o){const n=g(e.value);n>0?e.value=I(n):e.value=""}else r&&(e.value=U(e.value))}function ut(t){const e=t.target;if(e.matches('[name="deco_price_sqyd"], [name="wallpaper_price_roll"], [name="wallpaper_install_cost"], [name="fav_price_edit"], [name="fav_price_add"]')){const r=g(e.value);r>0&&(e.value=r)}e.matches("input[data-favorite-type]")&&(X=e,Ie(e))}function ne(t){var n,s,a,l,u,c,i,d,p,f,h,_;if(!t)return;const e=t.closest(m.set);if(e){const w=e.querySelector("[data-set-summary]");if(w){const q={width_m:(n=e.querySelector('input[name="width_m"]'))==null?void 0:n.value,height_m:(s=e.querySelector('input[name="height_m"]'))==null?void 0:s.value,style:(a=e.querySelector('select[name="set_style"]'))==null?void 0:a.value,fabric_variant:(l=e.querySelector('select[name="fabric_variant"]'))==null?void 0:l.value,price_per_m_raw:(u=e.querySelector('select[name="set_price_per_m"]'))==null?void 0:u.value,sheer_price_per_m:(c=e.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:c.value},y=x.calculateSetPrice(q);let T=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${I(y.total)}</b> ‡∏ö.`;y.opaque>0&&y.sheer>0&&(T+=` <small>(‡∏ó‡∏∂‡∏ö: ${I(y.opaque)}, ‡πÇ‡∏õ‡∏£‡πà‡∏á: ${I(y.sheer)})</small>`),w.innerHTML=T}}const o=t.closest(m.decoItem);if(o){const w=o.querySelector("[data-deco-summary]");if(w){const q={width_m:(i=o.querySelector('input[name="deco_width_m"]'))==null?void 0:i.value,height_m:(d=o.querySelector('input[name="deco_height_m"]'))==null?void 0:d.value,price_sqyd:(p=o.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:p.value},y=x.calculateDecoPrice(q);w.innerHTML=`‡∏£‡∏≤‡∏Ñ‡∏≤: <b>${I(y.total)}</b> ‡∏ö. &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${N(y.sqyd,2)} ‡∏ï‡∏£.‡∏´‡∏•‡∏≤`}}const r=t.closest(m.wallpaperItem);if(r){const w=r.querySelector("[data-wallpaper-summary]");if(w){const q={height_m:(f=r.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:f.value,price_per_roll:(h=r.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:h.value,install_cost_per_roll:(_=r.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:_.value,widths:Array.from(r.querySelectorAll('input[name="wall_width_m"]')).map(S=>S.value)},y=x.calculateWallpaperPrice(q);let T=`‡∏£‡∏ß‡∏°: <b>${I(y.total)}</b> ‡∏ö. `;(y.material>0||y.install>0)&&(T+=`<small>(‡∏ß‡∏≠‡∏•‡∏•‡πå: ${I(y.material)}, ‡∏Ñ‡πà‡∏≤‡∏ä‡πà‡∏≤‡∏á: ${I(y.install)})</small>`),T+=` &bull; ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà: ${N(y.sqm,2)} ‡∏ï‡∏£.‡∏°. &bull; ‡πÉ‡∏ä‡πâ: ${y.rolls} ‡∏°‡πâ‡∏ß‡∏ô`,w.innerHTML=T}}R()}function R(){let t=0,e=0;document.querySelectorAll(m.room).forEach(n=>{let s=0,a=0;const l=n.classList.contains("is-suspended");n.querySelectorAll(m.set).forEach(c=>{var d,p,f,h,_,w;const i=x.calculateSetPrice({is_suspended:l||c.classList.contains("is-suspended"),width_m:(d=c.querySelector('input[name="width_m"]'))==null?void 0:d.value,height_m:(p=c.querySelector('input[name="height_m"]'))==null?void 0:p.value,style:(f=c.querySelector('select[name="set_style"]'))==null?void 0:f.value,fabric_variant:(h=c.querySelector('select[name="fabric_variant"]'))==null?void 0:h.value,price_per_m_raw:(_=c.querySelector('select[name="set_price_per_m"]'))==null?void 0:_.value,sheer_price_per_m:(w=c.querySelector('select[name="sheer_price_per_m"]'))==null?void 0:w.value}).total;s+=i,i>0&&(e++,a++)}),n.querySelectorAll(m.decoItem).forEach(c=>{var d,p,f;const i=x.calculateDecoPrice({is_suspended:l||c.classList.contains("is-suspended"),width_m:(d=c.querySelector('input[name="deco_width_m"]'))==null?void 0:d.value,height_m:(p=c.querySelector('input[name="deco_height_m"]'))==null?void 0:p.value,price_sqyd:(f=c.querySelector('input[name="deco_price_sqyd"]'))==null?void 0:f.value}).total;s+=i,i>0&&(e++,a++)}),n.querySelectorAll(m.wallpaperItem).forEach(c=>{var d,p,f;const i=x.calculateWallpaperPrice({is_suspended:l||c.classList.contains("is-suspended"),height_m:(d=c.querySelector('input[name="wallpaper_height_m"]'))==null?void 0:d.value,price_per_roll:(p=c.querySelector('input[name="wallpaper_price_roll"]'))==null?void 0:p.value,install_cost_per_roll:(f=c.querySelector('input[name="wallpaper_install_cost"]'))==null?void 0:f.value,widths:Array.from(c.querySelectorAll('input[name="wall_width_m"]')).map(h=>h.value)}).total;s+=i,i>0&&(e++,a++)});const u=n.querySelector("[data-room-brief]");u&&(l?u.textContent="(‡∏£‡∏∞‡∏á‡∏±‡∏ö‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß)":a>0?u.innerHTML=`<span>${a}</span> &bull; ${I(s)} ‡∏ö‡∏≤‡∏ó`:u.innerHTML="<span>0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£"),t+=l?0:s});const o=document.querySelector(m.grandTotal),r=document.querySelector(m.setCount);o&&(o.textContent=I(t)),r&&(r.textContent=e)}function Se(t){if(t&&t.favorites&&(Re(t.favorites)?(v("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success"),xe()):v("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","warning")),!t||!t.rooms||!Array.isArray(t.rooms)){t.favorites||v("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå","error");return}const e=document.querySelector(m.roomsContainer);if(!e)return;e.innerHTML="";const o=document.querySelector("#customer_name"),r=document.querySelector("#customer_phone"),n=document.querySelector("#customer_address");o&&(o.value=t.customer_name||""),r&&(r.value=t.customer_phone||""),n&&(n.value=t.customer_address||"");const s=document.querySelector("#customerDetailsCard");s&&(s.open=t.customer_card_open??!0),t.rooms.forEach(a=>{const l=document.querySelector("#roomTpl");if(!l)return;const u=l.content.cloneNode(!0),c=u.querySelector(m.room);if(!c)return;c.id=a.id||`room-${Date.now()}`,a.is_suspended&&c.classList.add("is-suspended"),c.open=a.is_open===!0;const i=c.querySelector(m.roomNameInput);i&&(i.value=a.room_name||"‡∏´‡πâ‡∏≠‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠)");const d=c.querySelector(m.setsContainer),p=c.querySelector(m.decorationsContainer),f=c.querySelector(m.wallpapersContainer),h=document.querySelector("#setTpl"),_=document.querySelector("#decoTpl"),w=document.querySelector("#wallpaperTpl"),q=document.querySelector("#wallTpl");d&&h&&a.sets&&a.sets.forEach(y=>{const T=h.content.cloneNode(!0),S=T.querySelector(m.set);y.is_suspended&&S.classList.add("is-suspended"),S.querySelector('input[name="width_m"]').value=U(y.width_m),S.querySelector('input[name="height_m"]').value=U(y.height_m),S.querySelector('select[name="set_style"]').value=y.style||"‡∏•‡∏≠‡∏ô",S.querySelector('select[name="fabric_variant"]').value=y.fabric_variant||"‡∏ó‡∏∂‡∏ö",S.querySelector('select[name="set_price_per_m"]').value=y.price_per_m_raw||"",S.querySelector('select[name="sheer_price_per_m"]').value=y.sheer_price_per_m||"",S.querySelector('select[name="opening_style"]').value=y.opening_style||"‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡∏≤‡∏á",S.querySelector('select[name="track_color"]').value=y.track_color||"‡∏Ç‡∏≤‡∏ß",S.querySelector('input[name="fabric_code"]').value=y.fabric_code||"",S.querySelector('input[name="sheer_fabric_code"]').value=y.sheer_fabric_code||"",S.querySelector('input[name="notes"]').value=y.notes||"",Ce(S),d.appendChild(T)}),p&&_&&a.decorations&&a.decorations.forEach(y=>{const T=_.content.cloneNode(!0),S=T.querySelector(m.decoItem);y.is_suspended&&S.classList.add("is-suspended");const $=S.querySelector('select[name="deco_type"]');$.value=y.type||"",S.querySelector(".deco-type-display").textContent=y.type||"‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á",S.querySelector('input[name="deco_width_m"]').value=U(y.width_m),S.querySelector('input[name="deco_height_m"]').value=U(y.height_m),S.querySelector('input[name="deco_price_sqyd"]').value=I(y.price_sqyd)||"",S.querySelector('input[name="deco_code"]').value=y.deco_code||"",S.querySelector('input[name="deco_notes"]').value=y.notes||"",p.appendChild(T)}),f&&w&&a.wallpapers&&a.wallpapers.forEach(y=>{const T=w.content.cloneNode(!0),S=T.querySelector(m.wallpaperItem);y.is_suspended&&S.classList.add("is-suspended"),S.querySelector('input[name="wallpaper_height_m"]').value=U(y.height_m),S.querySelector('input[name="wallpaper_code"]').value=y.wallpaper_code||"",S.querySelector('input[name="wallpaper_price_roll"]').value=I(y.price_per_roll)||"",S.querySelector('input[name="wallpaper_install_cost"]').value=y.hasOwnProperty("install_cost_per_roll")?I(y.install_cost_per_roll):"300",S.querySelector('input[name="wallpaper_notes"]').value=y.notes||"";const $=S.querySelector(m.wallsContainer);$&&q&&y.widths&&y.widths.forEach(k=>{const b=q.content.cloneNode(!0);b.querySelector('input[name="wall_width_m"]').value=U(k),$.appendChild(b)}),f.appendChild(T)}),e.appendChild(u)}),document.querySelectorAll("input[data-favorite-type]").forEach(F),document.querySelectorAll(".item-card").forEach(a=>{ne(a)}),re(),R(),me(),Y(),G(),v("‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}function dt(t){if(document.getElementById("loading-overlay"))return;const e=document.createElement("div");e.id="loading-overlay",e.innerHTML=`<div class="loading-spinner"></div><p>${t}</p>`,document.body.appendChild(e),document.body.style.overflow="hidden"}function mt(){const t=document.getElementById("loading-overlay");t&&t.remove(),document.body.style.overflow=""}async function pt(t,e){const o=document.querySelector(m.printableContent);if(!o||!t||!t.html){v("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","error");return}if(e==="direct"){dt("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á PDF...");const r=document.createElement("div");r.style.position="fixed",r.style.left="-300mm",r.style.top="0",r.style.width="210mm",r.style.background="#fff",r.innerHTML=t.html,document.body.appendChild(r),await new Promise(n=>setTimeout(n,1e3));try{const n=r.querySelectorAll(".pdf-page");if(n.length===0)throw new Error("No pages found to generate.");const s={image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1,width:n[0].scrollWidth,windowWidth:n[0].scrollWidth},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}},a=await html2pdf().from(n[0]).set(s).toPdf().get("pdf");if(n.length>1)for(let l=1;l<n.length;l++){a.addPage();const c=(await html2canvas(n[l],s.html2canvas)).toDataURL(s.image.type,s.image.quality),i=a.internal.pageSize.getWidth(),d=a.internal.pageSize.getHeight();a.addImage(c,"JPEG",0,0,i,d)}a.save(`${t.fileName}.pdf`),v("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch(n){console.error("PDF Generation Error:",n),v("‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß, ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2 (‡∏û‡∏¥‡∏°‡∏û‡πå)","error")}finally{mt(),document.body.removeChild(r)}}e==="print"&&(o.innerHTML=t.html,setTimeout(()=>{window.print(),setTimeout(()=>{o.innerHTML=""},1e3)},Me))}function ft(t){if(!t||!t.html){v("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML","error");return}try{const e=`
            <!DOCTYPE html><html lang="th"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>${t.fileName}</title>
                <link rel="stylesheet" href="https://grobmak.github.io/marnthara-form/src/style.css">
                <style>#printable-content { display: block !important; } .pdf-page { border: 1px solid #eee; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: 10mm auto; }</style>
            </head>
            <body>${t.html}</body></html>`,o=new Blob([e],{type:"text/html;charset=utf-8"}),r=URL.createObjectURL(o),n=document.createElement("a");n.href=r,n.download=`${t.fileName}.html`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r),v("‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå HTML ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch(e){console.error("HTML Export Error:",e),v("‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå HTML ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}const ht=async t=>{var a,l,u;const e=t.target.closest("[data-act]"),o=t.target.closest(".fav-manager-item");if(o&&!e&&o.closest("#favManagerBody")){E===o?(E.classList.remove("is-selected"),E=null):(E&&E.classList.remove("is-selected"),o.classList.add("is-selected"),E=o),ye();return}if(!e||P&&!e.closest(".unlockable")&&!["select-favorite","manage-favorites","close-modal","add-new-fav-form","edit-selected-fav","del-selected-fav"].includes(e.dataset.act))return;const r=e.dataset.act,n=e.closest(m.room),s=(c,i,d)=>{z(c,i).then(p=>{p&&d()})};switch(r){case"add-room":ue();break;case"add-item":{if(J=e.closest(m.room),J){const d=await ge("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà");d==="set"&&tt(J),d==="deco"&&rt(J),d==="wallpaper"&&ot(J)}break}case"change-type":{fe=e.closest(".item-card");const d=e.dataset.currentType;if(fe){const p=await ge("‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£",d);p&&p!==d&&await z("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á","‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà ‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")&&et(fe,p)}break}case"add-wall":ve(e);break;case"toggle-more-details":{const d=e.closest(".item-card"),p=d==null?void 0:d.querySelector(".item-details-more");if(p){const f=p.classList.toggle("show");e.classList.toggle("expanded",f);const h=e.querySelector("i"),_=e.querySelector("span");h&&(h.className=f?"ph ph-caret-up":"ph ph-caret-down"),_&&(_.textContent=f?"‡∏¢‡πà‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á":"‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°")}break}case"del-room":s("‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>Q(n,"‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-set":s("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô?",()=>Q(e.closest(m.set),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏°‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-deco":s("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á?",()=>Q(e.closest(m.decoItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wallpaper":s("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå?",()=>Q(e.closest(m.wallpaperItem),"‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏≠‡∏•‡πÄ‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß"));break;case"del-wall":s("‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡∏ô‡∏µ‡πâ?",()=>Q(e.closest(".wall-input-row"),"‡∏•‡∏ö‡∏ú‡∏ô‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß"));break;case"clear-room":s("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ?",()=>{n.querySelector(m.setsContainer).innerHTML="",n.querySelector(m.decorationsContainer).innerHTML="",n.querySelector(m.wallpapersContainer).innerHTML="",re(),R(),A(),v("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß","success")});break;case"toggle-room-menu":t.preventDefault();const c=e.nextElementSibling;if(!c||!n)return;const i=!c.classList.contains("show");document.querySelectorAll(".room-options-menu.show").forEach(d=>d.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(d=>d.classList.remove("overflow-visible")),i&&(c.classList.add("show"),n.classList.add("overflow-visible"));break;case"toggle-suspend-room":t.preventDefault(),n==null||n.classList.toggle("is-suspended"),R(),A(),(a=e.closest(".room-options-menu"))==null||a.classList.remove("show"),n==null||n.classList.remove("overflow-visible");break;case"toggle-suspend":t.preventDefault(),(l=e.closest(".item-card"))==null||l.classList.toggle("is-suspended"),ne(e),A();break;case"toggle-favorite":{const d=e.dataset.type,p=e.previousElementSibling,f=p==null?void 0:p.value;if(!f||f.trim()===""){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");return}const h=e.closest(".item-card");if(!h)return;let _=0,w=null,q=null;if(d==="fabric"&&(w=h.querySelector('[name="set_price_per_m"]')),d==="sheer"&&(w=h.querySelector('[name="sheer_price_per_m"]')),d==="wallpaper"&&(w=h.querySelector('[name="wallpaper_price_roll"]')),d==="deco"&&(w=h.querySelector('[name="deco_price_sqyd"]'),q=(u=h.querySelector('[name="deco_type"]'))==null?void 0:u.value,!q)){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å","warning");return}if(w&&w.value&&(_=g(w.value)),_<=0){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î","warning");return}const y=We(d,f,_,q);F(p),v(y?"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß":"‡∏•‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success");break}case"select-favorite":{const d=e.dataset.code,p=e.dataset.price,f=e.closest(".form-group-with-favorites"),h=f?f.querySelector("input[data-favorite-type]"):X;if(h){h.value=d;const _=e.closest(".item-card");if(_&&p){const w=h.dataset.favoriteType;let q=null;w==="fabric"&&(q=_.querySelector('[name="set_price_per_m"]')),w==="sheer"&&(q=_.querySelector('[name="sheer_price_per_m"]')),w==="deco"&&(q=_.querySelector('[name="deco_price_sqyd"]')),w==="wallpaper"&&(q=_.querySelector('[name="wallpaper_price_roll"]')),q&&(q.tagName==="SELECT"?q.value=p:q.value=I(g(p)),q.classList.add("input-highlight"),setTimeout(()=>q.classList.remove("input-highlight"),1200),q.dispatchEvent(new Event("change",{bubbles:!0})))}h.dispatchEvent(new Event("input",{bubbles:!0})),Z(),v(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î ${d} ‡πÅ‡∏•‡πâ‡∏ß`,"success")}break}case"manage-favorites":{Z();const d=e.dataset.type,p=e.dataset.subType||null;if(d==="deco"&&!p){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏Å‡πà‡∏≠‡∏ô","warning");return}ze(d,p);break}case"del-selected-fav":{if(!E)return;const{type:d,subType:p,code:f}=E.dataset;s("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î",`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${f}"?`,()=>{qe(d,f,p)&&(K=!0,E.remove(),E=null,ye(),v("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏•‡πâ‡∏ß","success"),at(f,d,p),document.querySelector(".fav-manager-item")||ie(d,p))});break}case"edit-selected-fav":{if(!E)return;const{type:d,subType:p,code:f,price:h}=E.dataset,_=await Ze({code:f,price:h});if(_){if(!_.newCode){v("‡∏£‡∏´‡∏±‡∏™‡∏´‡πâ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á","error");return}He(d,f,_.newCode,_.newPrice,p)?(K=!0,v("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"),ie(d,p),nt(f,_,d,p)):v("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏à‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô","error")}break}case"add-new-fav-form":{const{type:d,subType:p}=document.getElementById("favManagerTitle").dataset,f=await Xe();if(f){if(!f.newCode){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™","error");return}if(f.newPrice<=0){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤","error");return}De(d,f.newCode,f.newPrice,p)?(K=!0,v("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success"),ie(d,p)):v("‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≤‡∏à‡∏ã‡πâ‡∏≥","error")}break}}};function yt(){P=!P,Te()}function _t(){const t=document.querySelector(m.setTpl);if(!t)return;const e=t.content.querySelector('select[name="set_price_per_m"]'),o=t.content.querySelector('select[name="sheer_price_per_m"]'),r=n=>{let s='<option value="" hidden>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤</option>';return n.forEach(a=>{s+=`<option value="${a}">${a.toLocaleString("th-TH")}</option>`}),s};e&&(e.innerHTML=r(de.fabric)),o&&(o.innerHTML=r(de.sheer))}function vt(){_t(),Le();const t=document.querySelector(m.orderForm),e=document.querySelector(m.fileImporter),o=document.querySelector(m.menuDropdown),r=document.querySelector(m.quickNavDropdown),n=document.querySelector("#pageBreakBuffer"),s=document.querySelector("#pageBreakBufferValue");n&&s&&n.addEventListener("input",()=>{s.textContent=n.value}),t.addEventListener("input",ct),t.addEventListener("change",lt),document.addEventListener("click",ht),t.addEventListener("blur",it,!0),t.addEventListener("focusin",ut,!0);const a=u=>{const c=u.target.closest(m.room);c&&$e(c)};t.addEventListener("click",a),t.addEventListener("focusin",a),document.body.addEventListener("click",u=>{u.target.closest("summary")&&setTimeout(()=>{Y(),A()},50)}),document.querySelector(m.lockBtn).addEventListener("click",yt),document.querySelector(m.toggleAllRoomsBtn).addEventListener("click",Ke),document.querySelector(m.quickNavBtn).addEventListener("click",u=>{var i;u.stopPropagation(),o.classList.remove("show");const c=!r.classList.contains("show");r.classList.toggle("show"),u.currentTarget.setAttribute("aria-expanded",c),c&&((i=document.querySelector(m.menuBtn))==null||i.setAttribute("aria-expanded","false"))}),document.querySelector(m.quickNavRoomList).addEventListener("click",u=>{var i;const c=u.target.closest("a[data-jump-to]");if(c){u.preventDefault();const d=c.dataset.jumpTo,p=document.getElementById(d);p&&(document.body.classList.add("disable-animations"),p.open=!0,p.scrollIntoView({behavior:"auto",block:"start"}),p.classList.add("scrolling-jump"),setTimeout(()=>{p.classList.remove("scrolling-jump"),document.body.classList.remove("disable-animations"),Y()},1e3)),r.classList.remove("show"),(i=document.querySelector(m.quickNavBtn))==null||i.setAttribute("aria-expanded","false")}});const l=document.querySelector("#addRoomQuickNavBtn");if(l){const u=Ne(ue,700);l.addEventListener("click",c=>{var i;c.stopPropagation(),u(),r.classList.remove("show"),(i=document.querySelector(m.quickNavBtn))==null||i.setAttribute("aria-expanded","false")})}document.querySelector(m.menuBtn).addEventListener("click",u=>{var i;u.stopPropagation(),r.classList.remove("show");const c=!o.classList.contains("show");o.classList.toggle("show"),u.currentTarget.setAttribute("aria-expanded",c),c&&((i=document.querySelector(m.quickNavBtn))==null||i.setAttribute("aria-expanded","false"))}),document.querySelector("#themeToggleBtn").addEventListener("click",u=>{u.preventDefault(),Je()}),document.querySelector("#overviewBtn").addEventListener("click",async u=>{var p;u.preventDefault(),o.classList.remove("show"),(p=document.querySelector(m.menuBtn))==null||p.setAttribute("aria-expanded","false");const c=V(),i=Ye(c),d=document.querySelector("#overviewModalBody");d&&(d.innerHTML=i,D("#overviewModal",()=>{}))}),document.querySelector(m.exportPdfBtn).addEventListener("click",async u=>{var f;u.preventDefault(),o.classList.remove("show"),(f=document.querySelector(m.menuBtn))==null||f.setAttribute("aria-expanded","false");const c=await Qe();if(!c)return;const i=V(),d=c.vatOption==="include"?C.baseVatRate:0,p=Ge(i,{vatRate:d,pageBreakBuffer:c.pageBreakBuffer});if(!p){v("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£","warning");return}c.exportMethod==="html"?ft(p):pt(p,c.exportMethod)}),document.querySelector(m.importBtn).addEventListener("click",u=>{var c;u.preventDefault(),o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false"),e.click()}),e.addEventListener("change",u=>{var d;const c=(d=u.target.files)==null?void 0:d[0];if(!c)return;const i=new FileReader;i.onload=p=>{try{const f=JSON.parse(p.target.result);Se(f)}catch(f){v("‡πÑ‡∏ü‡∏•‡πå JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á","error"),console.error("JSON Parse Error:",f)}},i.readAsText(c),u.target.value=null}),document.querySelector(m.exportBtn).addEventListener("click",u=>{var c;u.preventDefault(),o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false");try{const i=V(),d=JSON.stringify(i,null,4),p=new Blob([d],{type:"application/json"}),f=URL.createObjectURL(p),h=document.createElement("a"),_=new Date,w=`${_.getFullYear()}${(_.getMonth()+1).toString().padStart(2,"0")}${_.getDate().toString().padStart(2,"0")}`,q=`${_.getHours().toString().padStart(2,"0")}${_.getMinutes().toString().padStart(2,"0")}`,y=we(i.customer_name||"data");h.href=f,h.download=`MTR-${w}${q}-${y}.json`,h.click(),URL.revokeObjectURL(f),v("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à","success")}catch{v("Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}),document.querySelector(m.submitBtn).addEventListener("click",async u=>{var c;if(u.preventDefault(),o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false"),await z("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•","‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤?")){const i=V();if(!i.customer_name&&!i.customer_phone){v("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤","warning");return}v("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...","default");try{const d=await fetch(Be,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});d.ok?v("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success"):v(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${d.status}`,"error")}catch{v("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠","error")}}}),document.querySelector(m.copyTextBtn).addEventListener("click",async u=>{var d;u.preventDefault(),o.classList.remove("show"),(d=document.querySelector(m.menuBtn))==null||d.setAttribute("aria-expanded","false");const c=document.querySelector(m.copyOptionsModal);c.querySelector('input[name="copy_option"][value="customer"]').checked=!0;const i=await D(m.copyOptionsModal);if(i&&!i.cancelled){const p=c.querySelector('input[name="copy_option"]:checked').value,f=Ve(V(),p);try{await navigator.clipboard.writeText(f),v("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!","success")}catch{v("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß","error")}}}),document.querySelector(m.clearItemsBtn).addEventListener("click",async u=>{var c;u.preventDefault(),o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false"),await z("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£","‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏≠‡∏¢‡∏π‡πà)?")&&(document.querySelectorAll(m.room).forEach(i=>{i.querySelector(m.setsContainer).innerHTML="",i.querySelector(m.decorationsContainer).innerHTML="",i.querySelector(m.wallpapersContainer).innerHTML=""}),R(),A(),v("‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß","success"))}),document.querySelector(m.clearAllBtn).addEventListener("click",async u=>{var c;u.preventDefault(),o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false"),await z("‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î",'‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô! ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡πÅ‡∏•‡∏∞ "‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î" ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏≤‡∏ß‡∏£ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')&&(localStorage.removeItem(le),localStorage.removeItem("marnthara.theme"),Ue(),window.location.reload())}),window.addEventListener("click",u=>{var c,i;u.target.closest(".menu-container")||(o.classList.contains("show")&&(o.classList.remove("show"),(c=document.querySelector(m.menuBtn))==null||c.setAttribute("aria-expanded","false")),r.classList.contains("show")&&(r.classList.remove("show"),(i=document.querySelector(m.quickNavBtn))==null||i.setAttribute("aria-expanded","false"))),u.target.closest(".room-options-container")||(document.querySelectorAll(".room-options-menu.show").forEach(d=>d.classList.remove("show")),document.querySelectorAll(".card.overflow-visible").forEach(d=>d.classList.remove("overflow-visible"))),u.target.closest(".form-group-with-favorites")||Z()}),window.addEventListener("beforeunload",A);try{const u=localStorage.getItem(le);if(u&&u.length>2&&u!=="null")Se(JSON.parse(u));else{ue();const c=document.querySelector("#customerDetailsCard");c&&(c.open=!0)}}catch(u){console.error("Failed to load data from localStorage:",u),localStorage.removeItem(le),ue()}R(),Te(),Y(),G()}document.addEventListener("DOMContentLoaded",vt);
