<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Marnthara Input (M3)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header class="top-app-bar">
        <h1>Marnthara</h1>
        <div class="menu-container">
            <button class="icon-button" id="menuBtn"><span class="material-symbols-outlined">more_vert</span></button>
            <div class="menu-dropdown" id="menuDropdown">
                <button type="button" class="menu-item" id="lockBtn"><span class="material-symbols-outlined">lock</span><span class="lock-text">ล็อค</span></button>
                <button type="button" class="menu-item" id="importBtn"><span class="material-symbols-outlined">cloud_download</span>นำเข้า</button>
                <button type="button" class="menu-item" id="exportBtn"><span class="material-symbols-outlined">cloud_upload</span>ส่งออก</button>
                <button type="button" class="menu-item" id="clearBtn"><span class="material-symbols-outlined">clear_all</span>ล้างทั้งหมด</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <form id="orderForm" data-locked="false">
            <div class="form-section">
                <h2 class="title-large">ข้อมูลลูกค้า</h2>
                <div class="md-text-field">
                    <input name="customer_name" type="text" placeholder=" " required />
                    <label>ชื่อลูกค้า*</label>
                </div>
                <div class="md-text-field">
                    <input name="customer_address" type="text" placeholder=" " required />
                    <label>ที่อยู่*</label>
                </div>
                <div class="md-text-field">
                    <input name="customer_phone" type="tel" inputmode="numeric" placeholder=" " required />
                    <label>เบอร์โทรศัพท์*</label>
                </div>
                <div class="md-text-field md-multiline">
                    <textarea name="notes" placeholder=" "></textarea>
                    <label>หมายเหตุ</label>
                </div>
            </div>
            
            <div class="form-section">
                <h2 class="title-large">รายการสินค้า</h2>
                <div id="rooms-container"></div>
                <md-filled-button class="add-room-btn" id="addRoomBtn">
                    <span class="material-symbols-outlined">add</span>เพิ่มห้อง
                </md-filled-button>
            </div>
            
            <div class="form-section">
                <h2 class="title-large">สรุปราคา</h2>
                <div class="price-summary">
                    <div class="price-row">
                        <span class="price-label">ราคาผ้าม่านรวม</span>
                        <span class="price-value" id="fabricPriceTotal">0.00</span>
                    </div>
                    <div class="price-row">
                        <span class="price-label">ราคาวอลล์เปเปอร์รวม</span>
                        <span class="price-value" id="wallpaperPriceTotal">0.00</span>
                    </div>
                    <div class="price-row total">
                        <span class="price-label">ราคารวมทั้งหมด</span>
                        <span class="price-value" id="totalPrice">0.00</span>
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <input type="hidden" name="payload" id="payloadInput" />
                <md-filled-button type="submit">ส่งข้อมูล</md-filled-button>
            </div>
        </form>
    </main>

    <div id="toast-container"></div>
    <div id="dialog-container"></div>

    <button class="fab-extended" id="addRoomFab">
        <span class="material-symbols-outlined">add</span>
        <span class="fab-text">เพิ่มห้อง</span>
    </button>
    
    <template id="roomTpl">
        <div class="room-item">
            <div class="room-header">
                <h3 class="title-medium" data-room-title>ห้องที่ 1</h3>
                <button type="button" class="icon-button danger" data-act="del-room" title="ลบห้อง"><span class="material-symbols-outlined">delete</span></button>
            </div>
            
            <div class="md-tabs">
                <div class="md-tab md-tab-fabric active" data-product-type="fabric">ผ้าม่าน</div>
                <div class="md-tab md-tab-wallpaper" data-product-type="wallpaper">วอลล์เปเปอร์</div>
            </div>

            <div class="product-content fabric-content active" data-product-content="fabric">
                <div class="md-text-field">
                    <input name="fabric_style" type="text" list="style_options" placeholder=" " required />
                    <label>สไตล์*</label>
                    <datalist id="style_options">
                        <option value="ลอน"></option>
                        <option value="ตาไก่"></option>
                        <option value="จีบ"></option>
                    </datalist>
                </div>
                <div class="md-text-field">
                    <input name="fabric_price_sqm" type="number" step="10" min="0" placeholder=" " required />
                    <label>ราคา (บ./ตร.ม.)*</label>
                </div>
                <div class="md-text-field">
                    <input name="fabric_length_m" type="number" step="0.01" min="0" placeholder=" " required />
                    <label>ความยาว (ม.)*</label>
                </div>
                <div class="md-text-field">
                    <input name="fabric_height_m" type="number" step="0.01" min="0" placeholder=" " required />
                    <label>ความสูง (ม.)*</label>
                </div>
                <div class="item-summary" data-fabric-summary>
                    ราคา: <span class="price">0.00</span> บาท
                </div>
            </div>

            <div class="product-content wallpaper-content" data-product-content="wallpaper">
                <div class="md-text-field">
                    <input name="wallpaper_width_m" type="number" step="0.01" min="0" required placeholder=" "/>
                    <label>หน้ากว้างวอลล์เปเปอร์ (ม.)*</label>
                </div>
                <div class="md-text-field">
                    <input name="wallpaper_height_m" type="number" step="0.01" min="0" required placeholder=" "/>
                    <label>ความสูงห้อง (ม.)*</label>
                </div>
                <div class="md-text-field">
                    <input name="wallpaper_price_roll" type="text" inputmode="numeric" required placeholder=" " />
                    <label>ราคาต่อม้วน*</label>
                </div>
                <div class="walls-section">
                    <label class="input-label">ความกว้างผนัง (ใส่ทีละด้าน)</label>
                    <div data-walls-container></div>
                    <md-outlined-button type="button" class="add-wall-btn" data-act="add-wall">
                        <span class="material-symbols-outlined">add</span>เพิ่มผนัง
                    </md-outlined-button>
                </div>
                <div class="item-summary" data-wallpaper-summary>
                    ราคา: <span class="price">0</span> • พื้นที่: <span class="price">0.00</span> ตร.ม. • ใช้ <span class="price">0</span> ม้วน
                </div>
            </div>
        </div>
    </template>

    <template id="wallTpl">
        <div class="wall-input-row">
            <div class="md-text-field">
                <input name="wall_width_m" type="number" step="0.01" min="0" placeholder=" " required />
                <label>กว้าง (ม.)*</label>
            </div>
            <button type="button" class="icon-button danger" data-act="del-wall" title="ลบผนัง"><span class="material-symbols-outlined">delete</span></button>
        </div>
    </template>
    
    <script type="module" src="https://unpkg.com/@material/web@1.0.0/index.js"></script>
    <script src="script.js"></script>
</body>
</html>