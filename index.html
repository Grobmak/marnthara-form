<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Marnthara Input (M3)</title>
  <link rel="stylesheet" href="style01.css" />
</head>
<body>
  <!-- Top App Bar -->
  <header class="top-app-bar">
    <div class="app-bar-title">Marnthara</div>
    <div class="app-bar-actions">
      <button class="icon-btn" id="menuBtn" aria-label="เมนู">⋮</button>
    </div>
    <div class="menu-dropdown" id="menuDropdown">
      <button type="button" class="menu-item" id="importBtn">นำเข้า (JSON)</button>
      <button type="button" class="menu-item" id="exportBtn">ส่งออก (JSON)</button>
      <button type="button" class="menu-item" id="clearAllBtn">ล้างทั้งหมด</button>
    </div>
  </header>

  <!-- Form -->
  <form id="orderForm" method="post" target="hiddenFrame">
    <div class="card" id="customerInfo">
      <div class="row two-col">
        <div>
          <label>ชื่อลูกค้า</label>
          <input class="field" type="text" name="customer_name" placeholder="เช่น คุณสมชาย" />
        </div>
        <div>
          <label>เบอร์โทร</label>
          <input class="field" type="tel" name="customer_phone" placeholder="088-555-9955" />
        </div>
      </div>
      <div class="row">
        <div>
          <label>รายละเอียดเพิ่มเติม</label>
          <input class="field" type="text" name="customer_address" placeholder="เช่น ที่อยู่, โครงการ, ชื่อหมู่บ้าน" />
        </div>
      </div>
    </div>
    <input type="hidden" name="payload" id="payload" />
    <div id="rooms"></div>
    <div class="actions">
      <details class="summary-details">
        <summary>สรุปวัสดุ</summary>
        <div class="summary-popup">
          <div class="summary-item"><div class="summary-label">ผ้าทึบ</div><div class="summary-value price" id="grandFabric">0 หลา</div></div>
          <div class="summary-item"><div class="summary-label">ผ้าโปร่ง</div><div class="summary-value price" id="grandSheerFabric">0 หลา</div></div>
          <div class="summary-item"><div class="summary-label">รางทึบ</div><div class="summary-value price" id="grandOpaqueTrack">0 ม.</div></div>
          <div class="summary-item"><div class="summary-label">รางโปร่ง</div><div class="summary-value price" id="grandSheerTrack">0 ม.</div></div>
        </div>
      </details>
      <button type="button" class="btn" id="copyJsonBtn">คัดลอก JSON</button>
      <button type="button" class="btn btn-primary" id="copyTextBtn">คัดลอกข้อความ</button>
      <button type="submit" class="btn btn-primary" id="submitBtn">ส่งไปคำนวณ</button>
    </div>
  </form>

  <!-- Sticky footer -->
  <footer class="sticky-footer">
    <div class="summary-item"><div class="summary-label">ราคารวม</div><div class="summary-value price" id="grandTotal">0</div></div>
    <div class="summary-item"><div class="summary-label">จำนวนจุด</div><div class="summary-value" id="setCount">0</div></div>
    <div class="summary-item"><div class="summary-label">ผ้าม่าน(ชุด)</div><div class="summary-value" id="setCountSets">0</div></div>
    <div class="summary-item"><div class="summary-label">ตกแต่งเพิ่ม</div><div class="summary-value" id="setCountDeco">0</div></div>
  </footer>

  <div id="toast-container" class="toast-container"></div>
  <iframe name="hiddenFrame" class="hidden"></iframe>

  <!-- Floating Action Button -->
  <button type="button" class="fab" id="addRoomHeaderBtn">＋</button>

  <!-- Confirmation Modal -->
  <div id="confirmationModal" class="modal-overlay">
    <div class="modal">
      <h3 class="modal-title" id="modalTitle">ยืนยัน</h3>
      <p class="modal-body" id="modalBody">คุณแน่ใจหรือไม่?</p>
      <div class="modal-actions">
        <button type="button" class="btn" id="modalCancel">ยกเลิก</button>
        <button type="button" class="btn btn-danger" id="modalConfirm">ยืนยัน</button>
      </div>
    </div>
  </div>

  <!-- Import Modal -->
  <div id="importModal" class="modal-overlay">
    <div class="modal">
      <h3 class="modal-title">นำเข้าข้อมูล</h3>
      <p class="modal-body">วางข้อมูล JSON ที่ต้องการนำเข้า</p>
      <textarea id="importJsonArea" class="field" rows="10"></textarea>
      <div class="modal-actions">
        <button type="button" class="btn" id="importCancel">ยกเลิก</button>
        <button type="button" class="btn btn-primary" id="importConfirm">นำเข้า</button>
      </div>
    </div>
  </div>

  <!-- Templates -->
  <template id="roomTpl">
    <details class="card room" data-room open>
      <summary class="room-head">
        <input class="field" type="text" name="room_name" placeholder="ห้อง 01" required />
        <span class="small" data-room-brief><span class="num">จุด 0</span> • <span class="num">ชุด 0</span> • <span class="num price">0</span> บ.</span>
        <button type="button" class="icon-btn btn-danger" data-act="del-room" title="ลบห้อง">✕</button>
      </summary>
      <div>
        <div class="row two-col">
          <div>
            <label class="required">ราคาผ้า (ทึบ)</label>
            <select class="field" name="room_price_per_m" required><option value="" hidden>เลือก</option></select>
          </div>
          <div>
            <label class="required">สไตล์</label>
            <select class="field" name="room_style" required>
              <option value="" hidden>เลือก</option>
              <option>ลอน</option><option>ตาไก่</option><option>จีบ</option>
            </select>
          </div>
        </div>
      </div>
      <div data-sets></div>
      <div data-decorations></div>
      <div data-wallpapers></div>
      <div class="room-actions">
        <button type="button" class="btn btn-primary outline" data-act="add-set">+ จุดผ้าม่าน</button>
        <button type="button" class="btn btn-secondary outline" data-act="add-deco">+ ตกแต่ง</button>
        <button type="button" class="btn btn-info outline" data-act="add-wallpaper">+ วอลเปเปอร์</button>
      </div>
    </details>
  </template>

  <template id="setTpl">
    <div class="card set" data-set>
      <div class="row two-col">
        <div>
          <label>ความกว้าง (ม.)</label>
          <input class="field" type="number" step="0.01" name="set_width" />
        </div>
        <div>
          <label>ความสูง (ม.)</label>
          <input class="field" type="number" step="0.01" name="set_height" />
        </div>
      </div>
      <button type="button" class="btn btn-danger outline" data-act="del-set">ลบจุด</button>
    </div>
  </template>

  <template id="decoTpl">
    <div class="card deco" data-deco>
      <div class="row two-col">
        <div>
          <label>รายการ</label>
          <input class="field" type="text" name="deco_name" placeholder="เช่น ม่านพับ" />
        </div>
        <div>
          <label>ราคา</label>
          <input class="field" type="number" step="0.01" name="deco_price" />
        </div>
      </div>
      <button type="button" class="btn btn-danger outline" data-act="del-deco">ลบตกแต่ง</button>
    </div>
  </template>

  <template id="wallTpl">
    <div class="card wall" data-wall>
      <div class="row two-col">
        <div>
          <label>ผนัง</label>
          <input class="field" type="text" name="wall_name" placeholder="เช่น ผนังซ้าย" />
        </div>
        <div>
          <label>พื้นที่ (ตร.ม.)</label>
          <input class="field" type="number" step="0.01" name="wall_area" />
        </div>
      </div>
      <button type="button" class="btn btn-danger outline" data-act="del-wall">ลบผนัง</button>
    </div>
  </template>

  <template id="wallpaperTpl">
    <div class="card wallpaper" data-wallpaper>
      <div class="row two-col">
        <div>
          <label>ชนิดวอลเปเปอร์</label>
          <input class="field" type="text" name="wallpaper_type" placeholder="เช่น ลายไม้" />
        </div>
        <div>
          <label>ราคา</label>
          <input class="field" type="number" step="0.01" name="wallpaper_price" />
        </div>
      </div>
      <button type="button" class="btn btn-danger outline" data-act="del-wallpaper">ลบวอลเปเปอร์</button>
    </div>
  </template>

  <script src="script01.js"></script>
</body>
</html>
