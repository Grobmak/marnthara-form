<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Marnthara Input (M3)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header class="m3-app-bar">
        <div class="m3-menu-container">
            <button class="m3-button-icon" id="menuBtn">
                <span class="material-symbols-outlined">menu</span>
            </button>
            <div class="m3-menu" id="menuDropdown">
                <button type="button" class="m3-menu-item" id="importBtn">
                    <span class="material-symbols-outlined">file_upload</span> Import (JSON)
                </button>
                <button type="button" class="m3-menu-item" id="exportBtn">
                    <span class="material-symbols-outlined">file_download</span> Export (JSON)
                </button>
                <button type="button" class="m3-menu-item" id="clearBtn">
                    <span class="material-symbols-outlined">delete</span> ล้างข้อมูล
                </button>
                <button type="button" class="m3-menu-item" id="aboutBtn">
                    <span class="material-symbols-outlined">info</span> เกี่ยวกับ
                </button>
            </div>
        </div>
        <div class="m3-logo">Marnthara Input</div>
    </header>

    <main class="m3-main-container">
        <form id="orderForm">
            <section class="m3-section">
                <div class="m3-text-field outlined">
                    <input name="customer_name" type="text" placeholder=" " required />
                    <label>ชื่อลูกค้า</label>
                </div>
                <div class="m3-text-field outlined">
                    <input name="customer_address" type="text" placeholder=" " />
                    <label>ที่อยู่</label>
                </div>
                <div class="m3-text-field outlined">
                    <input name="customer_phone" type="tel" placeholder=" " />
                    <label>เบอร์โทรศัพท์</label>
                </div>
            </section>
            <section class="m3-section" id="roomsContainer" data-rooms-container>
            </section>
            <section class="m3-section m3-card" id="summarySection">
                <div class="m3-card-header">
                    <span class="m3-label">สรุป</span>
                    <button type="button" class="m3-button-icon" id="summaryBtn" title="รายละเอียด">
                        <span class="material-symbols-outlined">expand_less</span>
                    </button>
                </div>
                <div class="m3-dialog" id="summaryPopup">
                    <div class="m3-dialog-header">
                        <h2 class="m3-dialog-title">รายละเอียด</h2>
                        <button type="button" class="m3-button-icon" id="closeSummaryBtn">
                            <span class="material-symbols-outlined">close</span>
                        </button>
                    </div>
                    <div class="m3-dialog-content">
                        <pre id="summaryCode"></pre>
                    </div>
                </div>
                <div class="m3-card-content">
                    <div class="item-summary total-summary">
                        รวมทั้งหมด: <span class="price">0</span> บ.
                    </div>
                </div>
            </section>
            <div class="m3-bottom-app-bar">
                <button type="submit" class="m3-button-filled">
                    <span class="material-symbols-outlined">send</span>ส่งข้อมูล
                </button>
            </div>
            <input type="hidden" name="payload" />
        </form>
        <div id="toast-container"></div>
    </main>

    <template id="roomTpl">
        <div class="room m3-card" data-room-id>
            <div class="m3-card-header">
                <div class="m3-text-field">
                    <input name="room_name" type="text" placeholder=" " required />
                    <label>ชื่อห้อง</label>
                </div>
                <button type="button" class="m3-button-icon" data-act="del-room" title="ลบห้อง">
                    <span class="material-symbols-outlined">delete_forever</span>
                </button>
            </div>
            <div class="m3-card-content">
                <div class="item-selector">
                    <label class="m3-label">ประเภท</label>
                    <div class="m3-select-container">
                        <select name="item_type" required>
                            <option value="">-- เลือก --</option>
                            <option value="curtain">ผ้าม่าน</option>
                            <option value="wallpaper">วอลล์เปเปอร์</option>
                        </select>
                    </div>
                </div>
                <div class="curtain-section" style="display: none;" data-type-section="curtain">
                    <div class="m3-text-field outlined">
                        <input name="curtain_price_yard" type="text" inputmode="numeric" required placeholder=" " />
                        <label>ราคาต่อหลา</label>
                    </div>
                    <div class="m3-text-field outlined">
                        <input name="curtain_width_m" type="number" step="0.01" min="0" required placeholder=" " />
                        <label>ความกว้าง (ม.)</label>
                    </div>
                    <div class="m3-text-field outlined">
                        <input name="curtain_height_m" type="number" step="0.01" min="0" required placeholder=" " />
                        <label>ความสูง (ม.)</label>
                    </div>
                    <div class="m3-text-field outlined">
                        <input name="curtain_fold_x" type="number" step="0.1" min="1.0" value="2.5" placeholder=" " />
                        <label>จีบ/ลอน (x เท่า)</label>
                    </div>
                    <div class="item-selector" style="margin-top: 12px;">
                        <label class="m3-label">รูปแบบ</label>
                        <div class="m3-select-container">
                            <select name="curtain_style" required>
                                <option value="จีบ">จีบ</option>
                                <option value="ลอน">ลอน</option>
                            </select>
                        </div>
                    </div>
                    <div class="item-summary" data-curtain-summary>
                        ราคา: <span class="price">0</span> บ. • เนื้อผ้า: <span class="price">0.00</span> หลา
                    </div>
                </div>
                <div class="wallpaper-section" style="display: none;" data-type-section="wallpaper">
                    <div class="m3-text-field outlined">
                        <input name="wallpaper_height_m" type="number" step="0.01" min="0" required placeholder=" " />
                        <label>ความสูงผนัง (ม.)</label>
                    </div>
                    <div class="m3-text-field outlined">
                        <input name="wallpaper_price_roll" type="text" inputmode="numeric" required placeholder=" " />
                        <label>ราคาต่อม้วน</label>
                    </div>
                </div>
                <div class="walls-section">
                    <label class="m3-label">ความกว้างผนัง (ใส่ทีละด้าน)</label>
                    <div data-walls-container></div>
                    <button type="button" class="m3-button-text" data-act="add-wall" style="margin-top: 8px;">
                        <span class="material-symbols-outlined">add</span>เพิ่มผนัง
                    </button>
                </div>
                <div class="item-summary" data-wallpaper-summary>
                    ราคา: <span class="price">0</span> บ. • พื้นที่: <span class="price">0.00</span> ตร.ม. • ใช้ <span class="price">0</span> ม้วน
                </div>
            </div>
        </div>
    </template>

    <template id="wallTpl">
        <div class="wall-input-row">
            <div class="m3-text-field outlined">
                <input name="wall_width_m" type="number" step="0.01" min="0" placeholder=" " required />
                <label>ความกว้าง (ม.)</label>
            </div>
            <button type="button" class="m3-button-icon" data-act="del-wall" title="ลบผนัง">
                <span class="material-symbols-outlined">delete</span>
            </button>
        </div>
    </template>

    <script src="script.js"></script>
</body>
</html>