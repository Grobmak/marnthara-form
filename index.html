<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Marnthara Input (Pro)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>

    <header class="top-app-bar">
        <h1>Marnthara</h1>
        <div class="menu-container">
            <button class="btn-icon" id="menuBtn"><span class="material-symbols-outlined">more_vert</span></button>
            <div class="menu-dropdown" id="menuDropdown">
                <button type="button" class="menu-item" id="lockBtn"><span class="material-symbols-outlined">lock</span><span class="lock-text">ล็อค</span></button>
                <div class="menu-divider"></div>
                <button type="button" class="menu-item" id="copyJsonBtn"><span class="material-symbols-outlined">content_copy</span>คัดลอก JSON</button>
                <button type="button" class="menu-item" id="importBtn"><span class="material-symbols-outlined">upload_file</span>Import (JSON)</button>
                <button type="button" class="menu-item" id="exportBtn"><span class="material-symbols-outlined">download</span>Export (JSON)</button>
                <div class="menu-divider"></div>
                <button type="button" class="menu-item danger" id="clearAllBtn"><span class="material-symbols-outlined">delete_sweep</span>ล้างทั้งหมด</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <form id="orderForm" method="post" target="hiddenFrame">
            <div class="md-card">
                <div class="input-row">
                    <div class="md-text-field">
                        <input id="customer_name" type="text" name="customer_name" placeholder=" " />
                        <label for="customer_name">ชื่อลูกค้า</label>
                    </div>
                    <div class="md-text-field">
                        <input id="customer_phone" type="tel" name="customer_phone" placeholder=" " />
                        <label for="customer_phone">เบอร์โทร</label>
                    </div>
                </div>
                <div class="md-text-field">
                    <input id="customer_address" type="text" name="customer_address" placeholder=" " />
                    <label for="customer_address">รายละเอียดเพิ่มเติม (ที่อยู่, โครงการ)</label>
                </div>
            </div>
            <input type="hidden" name="payload" id="payload" />
            <div id="rooms"></div>
        </form>
    </main>

    <div class="fab-container">
        <button class="fab" id="addRoomFab" title="เพิ่มห้องใหม่">
            <span class="material-symbols-outlined">add</span>
        </button>
    </div>

    <div class="modal-scrim" id="clearAllModal">
        <div class="modal-container">
            <h2 class="modal-title">ล้างข้อมูลทั้งหมด?</h2>
            <p>การกระทำนี้จะลบข้อมูลทั้งหมดที่บันทึกไว้ รวมถึงห้องและรายการต่างๆ คุณแน่ใจหรือไม่?</p>
            <div class="modal-actions">
                <button type="button" class="btn-text" data-action="cancel">ยกเลิก</button>
                <button type="button" class="btn-filled danger" data-action="confirm">ล้างข้อมูล</button>
            </div>
        </div>
    </div>

    <div class="modal-scrim" id="importModal">
        <div class="modal-container modal-import-json">
            <h2 class="modal-title">Import JSON</h2>
            <p>วาง JSON ที่ต้องการ Import ลงในช่องด้านล่าง</p>
            <textarea id="importJsonArea" rows="10"></textarea>
            <div class="modal-actions">
                <button type="button" class="btn-text" data-action="cancel">ยกเลิก</button>
                <button type="button" class="btn-filled" data-action="import">Import</button>
            </div>
        </div>
    </div>

    <div class="bottom-sheet-scrim" id="summarySheet">
        <div class="bottom-sheet-container">
            <div class="sheet-handle"></div>
            <div class="sheet-header">
                <h2 class="sheet-title">สรุปราคา</h2>
            </div>
            <div class="sheet-content">
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-label">ผ้าม่าน</div>
                        <div class="summary-value" data-summary="fabric">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">ผ้าโปร่ง</div>
                        <div class="summary-value" data-summary="sheer">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">ม่านม้วน</div>
                        <div class="summary-value" data-summary="roller">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">วอลเปเปอร์</div>
                        <div class="summary-value" data-summary="wallpaper">0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">รวม</div>
                        <div class="summary-value" data-summary="total">0</div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-filled" data-action="close">ปิด</button>
            </div>
        </div>
    </div>

    <iframe name="hiddenFrame" style="display:none;"></iframe>
    <div id="toast-container" class="toast-container"></div>

    <template id="roomTpl">
        <details class="md-card" data-room-index="">
            <summary>
                <span class="material-symbols-outlined summary-icon">expand_less</span>
                <div class="summary-content">
                    <label class="input-label small">ชื่อห้อง</label>
                    <p class="room-name">ห้องที่ 1</p>
                </div>
                <div class="summary-actions">
                    <button type="button" class="btn-icon small" data-act="add-item" title="เพิ่มรายการ">
                        <span class="material-symbols-outlined">add</span>
                    </button>
                    <button type="button" class="btn-icon small" data-act="del-room" title="ลบห้อง">
                        <span class="material-symbols-outlined danger">delete</span>
                    </button>
                </div>
            </summary>
            <div class="card-content">
                <div class="room-content"></div>
                <button type="button" class="btn-text" data-act="add-item"><span class="material-symbols-outlined">add</span>เพิ่มรายการ</button>
            </div>
        </details>
    </template>
    <template id="itemTpl">
        <div class="tab-container" data-item-container data-item-index="">
            <div class="tab active" data-tab="fabric">ม่าน</div>
            <div class="tab" data-tab="roller">ม่านม้วน</div>
            <div class="tab" data-tab="wallpaper">วอลเปเปอร์</div>
        </div>
        <div data-tab-content-container>
            <div class="tab-content active" data-tab-content="fabric">
                <div class="item-actions">
                    <button type="button" class="btn-icon small" data-act="clear-fabric" title="ล้าง"><span class="material-symbols-outlined">backspace</span></button>
                    <button type="button" class="btn-icon small danger" data-act="del-item" title="ลบ"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="input-row">
                    <div class="md-text-field">
                        <input name="fabric_style" type="text" placeholder=" " required />
                        <label>สไตล์*</label>
                    </div>
                    <div class="md-text-field">
                        <input name="fabric_width_m" type="number" step="0.01" min="0" required placeholder=" "/>
                        <label>กว้าง (ม.)*</label>
                    </div>
                </div>
                <div class="input-row">
                    <div class="md-text-field">
                        <input name="fabric_height_m" type="number" step="0.01" min="0" required placeholder=" "/>
                        <label>สูง (ม.)*</label>
                    </div>
                    <div class="md-text-field">
                        <input name="fabric_price_yard" type="text" inputmode="numeric" required placeholder=" " />
                        <label>ราคาต่อหลา*</label>
                    </div>
                </div>
                <div class="input-row-spacer"></div>
                <div class="item-summary" data-fabric-summary>ราคา: <span class="price">0</span> • ผ้า: <span class="price">0.00</span> หลา • ค่าราง: <span class="price">0</span></div>
            </div>
            <div class="tab-content" data-tab-content="roller">
                <div class="item-actions">
                    <button type="button" class="btn-icon small" data-act="clear-roller" title="ล้าง"><span class="material-symbols-outlined">backspace</span></button>
                    <button type="button" class="btn-icon small danger" data-act="del-roller" title="ลบ"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="input-row">
                    <div class="md-text-field">
                        <input name="roller_width_m" type="number" step="0.01" min="0" required placeholder=" "/>
                        <label>กว้าง (ม.)*</label>
                    </div>
                    <div class="md-text-field">
                        <input name="roller_height_m" type="number" step="0.01" min="0" required placeholder=" "/>
                        <label>สูง (ม.)*</label>
                    </div>
                </div>
                <div class="md-text-field">
                    <input name="roller_price_sqm" type="text" inputmode="numeric" required placeholder=" " />
                    <label>ราคาต่อ ตร.ม.*</label>
                </div>
                <div class="item-summary" data-roller-summary>ราคา: <span class="price">0</span> • พื้นที่: <span class="price">0.00</span> ตร.ม.</div>
            </div>
            <div class="tab-content" data-tab-content="wallpaper">
                <div class="item-actions">
                    <button type="button" class="btn-icon small" data-act="clear-wallpaper" title="ล้าง"><span class="material-symbols-outlined">backspace</span></button>
                    <button type="button" class="btn-icon small danger" data-act="del-wallpaper" title="ลบ"><span class="material-symbols-outlined">close</span></button>
                </div>
                <div class="input-row">
                    <div class="md-text-field">
                        <input name="wallpaper_height_m" type="number" step="0.01" min="0" required placeholder=" "/>
                        <label>ความสูงห้อง (ม.)*</label>
                    </div>
                    <div class="md-text-field">
                        <input name="wallpaper_price_roll" type="text" inputmode="numeric" required placeholder=" " />
                        <label>ราคาต่อม้วน*</label>
                    </div>
                </div>
                <div class="walls-section">
                    <label class="input-label">ความกว้างผนัง (ใส่ทีละด้าน)</label>
                    <div data-walls-container></div>
                    <button type="button" class="btn-text" data-act="add-wall"><span class="material-symbols-outlined">add</span>เพิ่มผนัง</button>
                </div>
                <div class="item-summary" data-wallpaper-summary>ราคา: <span class="price">0</span> • พื้นที่: <span class="price">0.00</span> ตร.ม. • ใช้ <span class="price">0</span> ม้วน</div>
            </div>
        </div>
    </template>
    <template id="wallTpl"><div class="wall-input-row"><div class="md-text-field"><input name="wall_width_m" type="number" step="0.01" min="0" placeholder=" " required /><label>กว้าง (ม.)*</label></div><button type="button" class="btn-icon small danger" data-act="del-wall"><span class="material-symbols-outlined">close</span></button></div></template>
</body>
<script src="script.js"></script>
</html>