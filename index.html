<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marnthara Calculator</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" />
</head>
<body>
    <div class="glass-background"></div>
    <div class="container">
        <header class="app-header">
            <h1 class="page-title">Marnthara Calculator</h1>
            <div class="header-actions">
                <button class="btn btn-icon is-primary material-button" id="addRoomHeaderBtn" data-act="add-room">
                    <span class="material-symbols-outlined">add_circle</span>
                </button>
                <div class="dropdown-wrapper">
                    <button class="btn btn-icon material-button" id="menuBtn">
                        <span class="material-symbols-outlined">more_vert</span>
                    </button>
                    <div class="menu-dropdown glass-card" id="menuDropdown">
                        <button id="importBtn" data-act="import"><span class="material-symbols-outlined">upload</span>นำเข้า</button>
                        <button id="exportBtn" data-act="export"><span class="material-symbols-outlined">download</span>ส่งออก</button>
                        <button id="copyJsonBtn" data-act="copy-json"><span class="material-symbols-outlined">code</span>คัดลอก JSON</button>
                        <button id="copyTextBtn" data-act="copy-text"><span class="material-symbols-outlined">content_copy</span>คัดลอกข้อความ</button>
                        <button id="lockBtn" data-act="lock"><span class="material-symbols-outlined">lock_open</span><span class="lock-text">ล็อคฟอร์ม</span></button>
                        <button id="clearAllBtn" data-act="clear-all"><span class="material-symbols-outlined">delete</span>ล้างข้อมูลทั้งหมด</button>
                    </div>
                </div>
            </div>
        </header>

        <form id="orderForm">
            <input type="hidden" name="payload" id="payload">

            <div class="card glass-card" id="customerInfo">
                <div class="header">
                    <h2>ข้อมูลลูกค้า</h2>
                </div>
                <div class="form-group">
                    <label for="customer_name">ชื่อลูกค้า</label>
                    <input type="text" id="customer_name" name="customer_name">
                </div>
                <div class="form-group">
                    <label for="customer_phone">เบอร์โทรศัพท์</label>
                    <input type="text" id="customer_phone" name="customer_phone">
                </div>
                <div class="form-group">
                    <label for="customer_address">ที่อยู่ / รายละเอียด</label>
                    <textarea id="customer_address" name="customer_address" rows="3"></textarea>
                </div>
            </div>

            <div id="rooms">
                </div>

            <div class="card summary-card glass-card">
                <div class="summary-item">
                    <div class="summary-label">ยอดรวมทั้งหมด</div>
                    <div class="summary-value summary-price" id="grandTotal">0 บ.</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">จำนวน</div>
                    <div class="summary-value"><span id="setCountSets">0</span> จุดผ้าม่าน + <span id="setCountDeco">0</span> จุดอื่นๆ</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">ผ้าทึบ</div>
                    <div class="summary-value" id="grandFabric">0.00 หลา</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">ผ้าโปร่ง</div>
                    <div class="summary-value" id="grandSheerFabric">0.00 หลา</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">รางทึบ</div>
                    <div class="summary-value" id="grandOpaqueTrack">0.00 ม.</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">รางโปร่ง</div>
                    <div class="summary-value" id="grandSheerTrack">0.00 ม.</div>
                </div>
            </div>

            <div class="button-row" style="margin-top: 2rem;">
                <button type="submit" class="btn material-button" id="submitBtn">
                    <span class="material-symbols-outlined">send</span>ส่งข้อมูล
                </button>
            </div>
        </form>

        <footer class="footer">
            <p>Version: <span id="appVersion"></span></p>
            <p>&copy; 2025 Marnthara. All rights reserved.</p>
        </footer>
    </div>

    <div class="modal-backdrop" id="confirmationModal">
        <div class="modal-content glass-card">
            <h2 id="modalTitle"></h2>
            <p id="modalBody"></p>
            <div class="modal-buttons">
                <button class="btn btn-outline material-button" id="modalCancel">ยกเลิก</button>
                <button class="btn material-button" id="modalConfirm">ยืนยัน</button>
            </div>
        </div>
    </div>
    <div class="modal-backdrop" id="copyOptionsModal">
        <div class="modal-content glass-card">
            <h2>คัดลอกรายละเอียด</h2>
            <p>เลือกส่วนที่ต้องการคัดลอก:</p>
            <div class="form-check">
                <input type="checkbox" id="copyCustomerInfo" checked>
                <label for="copyCustomerInfo">ข้อมูลลูกค้า</label>
            </div>
            <div class="form-check">
                <input type="checkbox" id="copyRoomDetails" checked>
                <label for="copyRoomDetails">รายละเอียดแต่ละห้อง</label>
            </div>
            <div class="form-check">
                <input type="checkbox" id="copySummary" checked>
                <label for="copySummary">สรุปยอดรวม</label>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-outline material-button" id="copyOptionsCancel">ยกเลิก</button>
                <button class="btn material-button" id="copyOptionsConfirm">คัดลอก</button>
            </div>
        </div>
    </div>
    <div class="modal-backdrop" id="importModal">
        <div class="modal-content glass-card">
            <h2>นำเข้าข้อมูล</h2>
            <p>วางข้อมูล JSON ที่ต้องการนำเข้า:</p>
            <textarea id="importJsonArea" rows="10"></textarea>
            <div class="modal-buttons">
                <button class="btn btn-outline material-button" id="importCancel">ยกเลิก</button>
                <button class="btn material-button" id="importConfirm">นำเข้า</button>
            </div>
        </div>
    </div>

    <template id="roomTpl">
        <div class="card glass-card room-card" data-room data-index="1">
            <div class="room-card-header">
                <h2 class="room-title">
                    <input type="text" name="room_name" class="room-name-input" placeholder="ห้อง 01">
                </h2>
                <div class="room-brief" data-room-brief><span class="num">0 จุด</span> • ราคา <span class="num price">0 บ.</span></div>
                <div class="menu-wrapper">
                    <button type="button" class="btn-icon material-button" data-act="menu-room"><span class="material-symbols-outlined">more_vert</span></button>
                    <div class="menu-dropdown glass-card">
                        <button type="button" data-act="toggle-suspend-room"><span class="material-symbols-outlined">toggle_on</span><span data-suspend-text>ระงับ</span></button>
                        <button type="button" data-act="clear-room"><span class="material-symbols-outlined">delete</span>ล้างข้อมูลห้อง</button>
                        <button type="button" class="is-danger" data-act="del-room"><span class="material-symbols-outlined">delete_forever</span>ลบห้องนี้</button>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ราคาผ้าต่อเมตร</label>
                    <select name="room_price_per_m" required></select>
                </div>
                <div class="form-group">
                    <label>สไตล์</label>
                    <select name="room_style">
                        <option value="">เลือก</option>
                        <option value="ลอน">ลอน</option>
                        <option value="ตาไก่">ตาไก่</option>
                        <option value="จีบ">จีบ</option>
                    </select>
                </div>
            </div>
            <div data-sets></div>
            <div data-decorations></div>
            <div data-wallpapers></div>
            <div class="item-actions">
                <button type="button" class="btn material-button add-btn" data-act="add-set"><span class="material-symbols-outlined">add</span>เพิ่มจุดผ้าม่าน</button>
                <button type="button" class="btn material-button add-btn" data-act="add-deco"><span class="material-symbols-outlined">add</span>เพิ่มของตกแต่ง</button>
                <button type="button" class="btn material-button add-btn" data-act="add-wallpaper"><span class="material-symbols-outlined">add</span>เพิ่มวอลเปเปอร์</button>
            </div>
        </div>
    </template>

    <template id="setTpl">
        <div class="card glass-card item-card set-card" data-set>
            <div class="item-card-header">
                <h3 class="item-title-wrapper">จุดที่ <span class="item-title" data-item-title></span></h3>
                <div class="menu-wrapper">
                    <button type="button" class="btn-icon material-button" data-act="menu-item"><span class="material-symbols-outlined">more_vert</span></button>
                    <div class="menu-dropdown glass-card">
                        <button type="button" data-act="toggle-suspend"><span class="material-symbols-outlined">toggle_on</span><span data-suspend-text>ระงับ</span></button>
                        <button type="button" data-act="clear-set"><span class="material-symbols-outlined">delete</span>ล้างข้อมูล</button>
                        <button type="button" class="is-danger" data-act="del-set"><span class="material-symbols-outlined">delete_forever</span>ลบรายการนี้</button>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ความกว้าง (ม.)</label>
                    <input type="number" name="width_m" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>ความสูง (ม.)</label>
                    <input type="number" name="height_m" step="0.01" min="0">
                </div>
            </div>
            <div class="form-row three-col">
                <div class="form-group">
                    <label>รูปแบบผ้า</label>
                    <select name="fabric_variant">
                        <option value="ทึบ" selected>ผ้าทึบ</option>
                        <option value="โปร่ง">ผ้าโปร่ง</option>
                        <option value="ทึบ&โปร่ง">ทึบ + โปร่ง</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ประเภทราง</label>
                    <select name="open_type">
                        <option value="">เลือก</option>
                        <option value="แยกกลาง">แยกกลาง</option>
                        <option value="เปิดข้าง">เปิดข้าง</option>
                    </select>
                </div>
                <div class="form-group" data-sheer-wrap>
                    <label>ราคาผ้าโปร่ง/ม.</label>
                    <select name="sheer_price_per_m"></select>
                </div>
            </div>
            <div class="item-summary" data-set-summary></div>
        </div>
    </template>

    <template id="decoTpl">
        <div class="card glass-card item-card deco-card" data-deco-item>
            <div class="item-card-header">
                <h3 class="item-title-wrapper">รายการตกแต่งที่ <span class="item-title" data-item-title></span></h3>
                <div class="menu-wrapper">
                    <button type="button" class="btn-icon material-button" data-act="menu-item"><span class="material-symbols-outlined">more_vert</span></button>
                    <div class="menu-dropdown glass-card">
                        <button type="button" data-act="toggle-suspend"><span class="material-symbols-outlined">toggle_on</span><span data-suspend-text>ระงับ</span></button>
                        <button type="button" data-act="clear-deco"><span class="material-symbols-outlined">delete</span>ล้างข้อมูล</button>
                        <button type="button" class="is-danger" data-act="del-deco"><span class="material-symbols-outlined">delete_forever</span>ลบรายการนี้</button>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ประเภทของตกแต่ง</label>
                    <input type="text" name="deco_type" placeholder="เช่น ผ้าโปร่ง, หัวเสา">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ความกว้าง (ม.)</label>
                    <input type="number" name="deco_width_m" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>ความสูง (ม.)</label>
                    <input type="number" name="deco_height_m" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>ราคาต่อ ตร.หลา</label>
                    <input type="number" name="deco_price_sqyd" step="0.01" min="0">
                </div>
            </div>
            <div class="item-summary" data-deco-summary></div>
        </div>
    </template>

    <template id="wallpaperTpl">
        <div class="card glass-card item-card wallpaper-card" data-wallpaper-item>
            <div class="item-card-header">
                <h3 class="item-title-wrapper">วอลเปเปอร์ที่ <span class="item-title" data-item-title></span></h3>
                <div class="menu-wrapper">
                    <button type="button" class="btn-icon material-button" data-act="menu-item"><span class="material-symbols-outlined">more_vert</span></button>
                    <div class="menu-dropdown glass-card">
                        <button type="button" data-act="toggle-suspend"><span class="material-symbols-outlined">toggle_on</span><span data-suspend-text>ระงับ</span></button>
                        <button type="button" data-act="clear-wallpaper"><span class="material-symbols-outlined">delete</span>ล้างข้อมูล</button>
                        <button type="button" class="is-danger" data-act="del-wallpaper"><span class="material-symbols-outlined">delete_forever</span>ลบรายการนี้</button>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ความสูง (ม.)</label>
                    <input type="number" name="wallpaper_height_m" step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>ราคาต่อม้วน</label>
                    <input type="number" name="wallpaper_price_roll" step="0.01" min="0">
                </div>
            </div>
            <div class="form-group">
                <label>ความกว้างแต่ละผนัง (ม.)</label>
                <div data-walls-container></div>
                <button type="button" class="btn material-button add-btn" data-act="add-wall"><span class="material-symbols-outlined">add</span>เพิ่มผนัง</button>
            </div>
            <div class="item-summary" data-wallpaper-summary></div>
        </div>
    </template>

    <template id="wallTpl">
        <div class="wall-input-row">
            <input type="number" name="wall_width_m" step="0.01" min="0">
            <button type="button" class="btn-icon material-button is-danger" data-act="del-wall"><span class="material-symbols-outlined">close</span></button>
        </div>
    </template>

    <div id="toast-container"></div>
    <script src="script.js"></script>
</body>
</html>