<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Marnthara Input (v4)</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<body>
    <div class="header">
        <div class="menu-container">
            <button class="btn btn-icon" id="menuBtn"><span class="material-symbols-outlined">menu</span></button>
            <div class="menu-dropdown" id="menuDropdown">
                <button type="button" class="btn btn-block" id="importBtn"><span class="material-symbols-outlined">upload_file</span> Import(JSON)</button>
                <button type="button" class="btn btn-block" id="exportBtn"><span class="material-symbols-outlined">download</span> Export(JSON)</button>
            </div>
        </div>
        <div class="logo">
            <img src="https://storage.googleapis.com/gpay-marnthara/marnthara-logo-text.png" alt="Marnthara Curtains" />
        </div>
        <div class="actions">
            <button class="btn btn-icon" id="copyTextBtn"><span class="material-symbols-outlined">share</span></button>
            <button class="btn btn-icon" id="lockBtn"><span class="material-symbols-outlined lock-icon">lock_open</span><span class="lock-text">ล็อค</span></button>
        </div>
    </div>
    
    <div class="container main-content">
        <div class="card">
            <h2>ข้อมูลลูกค้า</h2>
            <div class="row two-col">
                <div><label>ชื่อลูกค้า</label><input class="field" name="customer_name" type="text" placeholder="ชื่อลูกค้า" /></div>
                <div><label>เบอร์โทร</label><input class="field" name="customer_phone" type="text" inputmode="tel" placeholder="เบอร์โทร" /></div>
            </div>
            <div><label>รายละเอียดที่อยู่</label><input class="field" name="customer_address" type="text" placeholder="บ้านเลขที่, ถนน, ซอย, ฯลฯ" /></div>
        </div>

        <form id="orderForm">
            <div id="rooms"></div>
            <button type="button" class="btn btn-block btn-info add-room" id="addRoomHeaderBtn">
                <span class="material-symbols-outlined">add</span> เพิ่มห้องใหม่
            </button>
            <div class="card summary-card">
                <h3>สรุปยอด</h3>
                <div class="summary-item">
                    <span>ราคารวม</span>
                    <span id="grandTotal" class="price">0</span> บ.
                </div>
                <div class="summary-item small-summary">
                    <span>จำนวนจุด</span>
                    <span id="setCount" class="price">0</span> จุด
                </div>
                <div class="summary-item small-summary">
                    <span>ผ้าม่าน</span>
                    <span id="setCountSets" class="price">0</span> ชุด
                </div>
                <div class="summary-item small-summary">
                    <span>งานตกแต่ง/วอลล์</span>
                    <span id="setCountDeco" class="price">0</span> ชุด
                </div>
                <div class="summary-item small-summary">
                    <span>ผ้าทึบที่ใช้</span>
                    <span id="grandFabric" class="price">0.00</span>
                </div>
                <div class="summary-item small-summary">
                    <span>ผ้าโปร่งที่ใช้</span>
                    <span id="grandSheerFabric" class="price">0.00</span>
                </div>
                <div class="summary-item small-summary">
                    <span>รางทึบที่ใช้</span>
                    <span id="grandOpaqueTrack" class="price">0.00</span>
                </div>
                <div class="summary-item small-summary">
                    <span>รางโปร่งที่ใช้</span>
                    <span id="grandSheerTrack" class="price">0.00</span>
                </div>
            </div>
            <input type="hidden" name="payload" id="payload" />
            <button type="submit" class="btn btn-primary btn-block submit-btn">
                <span class="material-symbols-outlined">send</span> ส่งข้อมูล
            </button>
            <button type="button" class="btn btn-secondary btn-block" id="copyJsonBtn">
                <span class="material-symbols-outlined">content_copy</span> คัดลอก JSON
            </button>
            <button type="button" class="btn btn-danger-outline btn-block" id="clearAllBtn">
                <span class="material-symbols-outlined">delete_forever</span> ล้างข้อมูลทั้งหมด
            </button>
        </form>
    </div>

    <div id="toast-container"></div>
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <h4 id="modalTitle"></h4>
            <p id="modalBody"></p>
            <div class="modal-actions">
                <button id="modalCancel" class="btn btn-outline">ยกเลิก</button>
                <button id="modalConfirm" class="btn btn-danger">ยืนยัน</button>
            </div>
        </div>
    </div>
    
    <div id="copyOptionsModal" class="modal">
        <div class="modal-content">
            <h4>เลือกข้อมูลที่ต้องการคัดลอก</h4>
            <div class="checkbox-group">
                <label class="checkbox-container">
                    <input type="checkbox" id="copyCustomerInfo" checked> ข้อมูลลูกค้า
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container">
                    <input type="checkbox" id="copyRoomDetails" checked> รายละเอียดงาน
                    <span class="checkmark"></span>
                </label>
                <label class="checkbox-container">
                    <input type="checkbox" id="copySummary" checked> สรุปยอด
                    <span class="checkmark"></span>
                </label>
            </div>
            <div class="modal-actions">
                <button id="copyOptionsCancel" class="btn btn-outline">ยกเลิก</button>
                <button id="copyOptionsConfirm" class="btn btn-primary">ยืนยัน</button>
            </div>
        </div>
    </div>

    <div id="importModal" class="modal">
        <div class="modal-content">
            <h4>วางข้อมูล JSON ที่นี่</h4>
            <textarea id="importJsonArea" rows="10" placeholder="วางข้อมูล JSON ที่คุณส่งออกมา..."></textarea>
            <div class="modal-actions">
                <button id="importCancel" class="btn btn-outline">ยกเลิก</button>
                <button id="importConfirm" class="btn btn-primary">นำเข้า</button>
            </div>
        </div>
    </div>

    <template id="roomTpl">
        <div class="card room-card" data-room data-suspendable>
            <details open>
                <summary>
                    <h3>ห้องที่ 1: ยังไม่มีชื่อ</h3>
                    <div class="summary-actions">
                        <div class="menu-container room-menu-container">
                            <button type="button" class="btn btn-icon btn-xs room-menu-btn">
                                <span class="material-symbols-outlined">more_vert</span>
                            </button>
                            <div class="menu-dropdown room-menu-dropdown">
                                <button type="button" class="btn btn-block" data-act="toggle-room-suspend">
                                    <span class="material-symbols-outlined">pause</span> พักงานห้อง
                                </button>
                                <button type="button" class="btn btn-block" data-act="clear-room">
                                    <span class="material-symbols-outlined">refresh</span> ล้างข้อมูลห้อง
                                </button>
                                <button type="button" class="btn btn-block" data-act="del-room">
                                    <span class="material-symbols-outlined">delete</span> ลบห้อง
                                </button>
                            </div>
                        </div>
                    </div>
                </summary>
                <div class="room-content">
                    <div class="row two-col">
                        <div><label>ชื่อห้อง</label><input class="field" name="room_name" type="text" placeholder="เช่น ห้องนอนใหญ่, ห้องรับแขก" /></div>
                        <div><label>รูปแบบ</label>
                            <select class="field" name="room_style">
                                <option value="จีบ">จีบ</option>
                                <option value="ตาไก่">ตาไก่</option>
                                <option value="ลอน">ลอน</option>
                            </select>
                        </div>
                    </div>
                    <div><label>ราคาผ้าม่าน (บ./ม.)</label>
                        <select class="field" name="room_price_per_m">
                            <option value="" hidden>เลือก</option>
                        </select>
                    </div>
                    
                    <div class="add-item-section">
                        <h4>รายการเพิ่ม</h4>
                        <div class="row three-col">
                            <button type="button" class="btn btn-block btn-outline btn-info" data-act="add-set">
                                <span class="material-symbols-outlined">format_indent_increase</span> เพิ่มผ้าม่าน
                            </button>
                            <button type="button" class="btn btn-block btn-outline btn-info" data-act="add-deco">
                                <span class="material-symbols-outlined">vertical_align_center</span> เพิ่มตกแต่ง
                            </button>
                            <button type="button" class="btn btn-block btn-outline btn-info" data-act="add-wallpaper">
                                <span class="material-symbols-outlined">wallpaper</span> เพิ่มวอลเปเปอร์
                            </button>
                        </div>
                    </div>
                    <div data-sets></div>
                    <div data-decorations></div>
                    <div data-wallpapers></div>
                </div>
                <div class="room-summary">
                    <div data-room-total>
                        <span>ยอดรวมห้องนี้</span>
                        <span class="price">0</span> บ.
                    </div>
                    <div class="small" data-room-fabric>
                        <span>ผ้าทึบรวม</span>
                        <span class="price">0.00</span>
                    </div>
                    <div class="small" data-room-sheer-fabric>
                        <span>ผ้าโปร่งรวม</span>
                        <span class="price">0.00</span>
                    </div>
                </div>
            </details>
        </div>
    </template>

    <template id="setTpl">
        <div class="card card-inner" data-set data-suspendable>
            <div class="card-header">
                <span class="set-title">จุดที่ 1</span>
                <div class="menu-container set-menu-container">
                    <button type="button" class="btn btn-icon btn-xs set-menu-btn">
                        <span class="material-symbols-outlined">more_vert</span>
                    </button>
                    <div class="menu-dropdown set-menu-dropdown">
                        <button type="button" class="btn btn-block" data-act="toggle-set-suspend">
                            <span class="material-symbols-outlined">pause</span> พักงานรายการ
                        </button>
                        <button type="button" class="btn btn-block" data-act="del-set">
                            <span class="material-symbols-outlined">delete</span> ลบรายการ
                        </button>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row two-col">
                    <div><label>ความกว้าง (ม.)</label><input class="field" name="width_m" type="number" step="0.01" min="0" required /></div>
                    <div><label>ความสูง (ม.)</label><input class="field" name="height_m" type="number" step="0.01" min="0" required /></div>
                </div>
                <div><label>ชนิดผ้า</label>
                    <select class="field" name="fabric_variant">
                        <option value="ทึบ">ทึบ</option>
                        <option value="โปร่ง">โปร่ง</option>
                        <option value="ทึบ/โปร่ง">ทึบ/โปร่ง</option>
                    </select>
                </div>
                <div><label>รูปแบบเปิด-ปิด</label>
                    <select class="field" name="open_type">
                        <option value="แยกกลาง">แยกกลาง</option>
                        <option value="เปิดข้าง">เปิดข้าง</option>
                    </select>
                </div>
                <div data-sheer-wrap>
                    <label>ราคาผ้าโปร่ง (บ./ม.)</label>
                    <select class="field" name="sheer_price_per_m">
                        <option value="" hidden>เลือก</option>
                    </select>
                </div>
            </div>
            <div class="card-footer">
                <div class="small">ใช้ผ้าทึบ: <span data-set-opaque-yardage>0.00</span> หลา (<span data-set-opaque-track>0.00</span> ม.)</div>
                <div class="small">ใช้ผ้าโปร่ง: <span data-set-sheer-yardage>0.00</span> หลา (<span data-set-sheer-track>0.00</span> ม.)</div>
                <div class="total-row" data-set-total>
                    <span>รวม</span>
                    <span class="price">0</span> บ.
                </div>
            </div>
        </div>
    </template>

    <template id="decoTpl">
        <div class="card card-inner" data-deco-item data-suspendable>
            <div class="card-header">
                <span class="deco-title">รายการตกแต่งที่ 1</span>
                <div class="menu-container deco-menu-container">
                    <button type="button" class="btn btn-icon btn-xs deco-menu-btn">
                        <span class="material-symbols-outlined">more_vert</span>
                    </button>
                    <div class="menu-dropdown deco-menu-dropdown">
                        <button type="button" class="btn btn-block" data-act="toggle-deco-suspend">
                            <span class="material-symbols-outlined">pause</span> พักงานรายการ
                        </button>
                        <button type="button" class="btn btn-block" data-act="del-deco">
                            <span class="material-symbols-outlined">delete</span> ลบรายการ
                        </button>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div><label>ชนิด</label><input class="field" name="deco_type" type="text" placeholder="เช่น มู่ลี่, ฉากกั้น, ฯลฯ" required /></div>
                <div class="row two-col">
                    <div><label>ความกว้าง (ม.)</label><input class="field" name="deco_width_m" type="number" step="0.01" min="0" required /></div>
                    <div><label>ความสูง (ม.)</label><input class="field" name="deco_height_m" type="number" step="0.01" min="0" required /></div>
                </div>
                <div><label>ราคา (บ./ตร.หลา)</label><input class="field" name="deco_price_sqyd" type="text" inputmode="numeric" required /></div>
            </div>
            <div class="card-footer">
                <div class="small">พื้นที่: <span data-deco-area>0.00</span> ตร.ม.</div>
                <div class="total-row" data-deco-total>
                    <span>รวม</span>
                    <span class="price">0</span> บ.
                </div>
            </div>
        </div>
    </template>
    
    <template id="wallpaperTpl">
        <div class="card card-inner" data-wallpaper-item data-suspendable>
            <div class="card-header">
                <span class="wallpaper-title">วอลเปเปอร์ที่ 1</span>
                <div class="menu-container wallpaper-menu-container">
                    <button type="button" class="btn btn-icon btn-xs wallpaper-menu-btn">
                        <span class="material-symbols-outlined">more_vert</span>
                    </button>
                    <div class="menu-dropdown wallpaper-menu-dropdown">
                        <button type="button" class="btn btn-block" data-act="toggle-wallpaper-suspend">
                            <span class="material-symbols-outlined">pause</span> พักงานรายการ
                        </button>
                        <button type="button" class="btn btn-block" data-act="del-wallpaper">
                            <span class="material-symbols-outlined">delete</span> ลบรายการ
                        </button>
                    </div>
                </div>
            </div>
            <div class="row two-col">
                <div><label>ความสูงห้อง (ม.)</label><input class="field" name="wallpaper_height_m" type="number" step="0.01" min="0" required /></div>
                <div><label>ราคาต่อม้วน</label><input class="field" name="wallpaper_price_roll" type="text" inputmode="numeric" required /></div>
            </div>
            <div class="walls-section">
                <label>ความกว้างผนัง (ใส่ทีละด้าน)</label>
                <div data-walls-container></div>
                <button type="button" class="btn btn-xs btn-info outline" data-act="add-wall" style="margin-top: 8px;">+ เพิ่มผนัง</button>
            </div>
            <div class="small" style="margin-top: 12px; border-top: 1px solid var(--line); padding-top: 8px;" data-wallpaper-summary>
                ราคา: <span class="price">0</span> บ. • พื้นที่: <span class="price">0.00</span> ตร.ม. • ใช้ <span class="price">0</span> ม้วน
            </div>
        </div>
    </template>

    <template id="wallTpl">
        <div class="wall-input-row">
            <input class="field" name="wall_width_m" type="number" step="0.01" min="0" placeholder="ความกว้าง (ม.)" required />
            <button type="button" class="btn btn-icon btn-danger btn-xs" data-act="del-wall">
                <span class="material-symbols-outlined">delete</span>
            </button>
        </div>
    </template>

    <script src="script.js"></script>
</body>
</html>